<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Tutorial</title>
<link rel="stylesheet" href="../../../../../doc/src/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="../index.html" title="Boost.Local 0.1.1">
<link rel="up" href="../index.html" title="Boost.Local 0.1.1">
<link rel="prev" href="Getting.html" title="Getting Started">
<link rel="next" href="Advanced.html" title="Advanced Topics">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../boost.png"></td>
<td align="center"><a href="../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="Getting.html"><img src="../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="Advanced.html"><img src="../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="boost_local.Tutorial"></a><a class="link" href="Tutorial.html" title="Tutorial">Tutorial</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="Tutorial.html#boost_local.Tutorial.local_functions">Local Functions</a></span></dt>
<dt><span class="section"><a href="Tutorial.html#boost_local.Tutorial.Empty_Parameters">Empty Parameters</a></span></dt>
<dt><span class="section"><a href="Tutorial.html#boost_local.Tutorial.default_parameters">Default Parameters</a></span></dt>
<dt><span class="section"><a href="Tutorial.html#boost_local.Tutorial.Binding">Binding</a></span></dt>
<dt><span class="section"><a href="Tutorial.html#boost_local.Tutorial.local_blocks">Local Blocks</a></span></dt>
<dt><span class="section"><a href="Tutorial.html#boost_local.Tutorial.local_exits">Local Exits</a></span></dt>
<dt><span class="section"><a href="Tutorial.html#boost_local.Tutorial.templates">Templates</a></span></dt>
</dl></div>
<p>
      This section illustrates basic usage of local functions, local blocks, and
      local exits.
    </p>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_local.Tutorial.local_functions"></a><a class="link" href="Tutorial.html#boost_local.Tutorial.local_functions" title="Local Functions">Local Functions</a>
</h3></div></div></div>
<p>
        Local functions are defined using the following macros (see the <a href="../reference.html" target="_top">Reference</a>
        section) from within a declarative context (this is a limitation with respect
        to <a href="http://en.wikipedia.org/wiki/C%2B%2B0x#Lambda_functions_and_expressions" target="_top">C++0x
        lambda</a> functions which can instead be declared within expressions):
      </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="special">...</span>
<span class="special">{</span> <span class="comment">// Some declarative context.
</span>    <span class="special">...</span>
    <span class="emphasis"><em>result-type</em></span> <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a></code><span class="special">(</span><span class="emphasis"><em>parameters</em></span><span class="special">)</span> <span class="special">{</span>
        <span class="emphasis"><em>body-code</em></span>
    <span class="special">}</span> <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_NAME.html" title="Macro BOOST_LOCAL_FUNCTION_NAME">BOOST_LOCAL_FUNCTION_NAME</a></code><span class="special">(</span><span class="emphasis"><em>name</em></span><span class="special">)</span>
    <span class="special">...</span>
<span class="special">}</span>
</pre>
<p>
        The expansion of this macros declares a functor object with the local function
        name that can be called from the enclosing scope. The usual C++ scope visibility
        rules apply to local functions for which a local function is visible and
        can be called only within the enclosing scope in which it is declared.
      </p>
<p>
        The local function parameters are passed to the <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a></code>
        macro either using the <span class="emphasis"><em>sequencing macro syntax</em></span> (which
        separates the parameters by wrapping them within round parenthesis <code class="computeroutput"><span class="special">()</span></code> and it is supported on all C++ compilers)
        or using the <span class="emphasis"><em>variadic macro syntax</em></span> (which separates
        the parameters using a comma <code class="computeroutput"><span class="special">,</span></code>
        but it is supported only on C99 and later compilers):
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a><span class="special">(</span></code><code class="literal"><span class="emphasis"><em>parameter-type1
                  parameter-name1</em></span></code><code class="computeroutput"><span class="special">,</span></code>
                  <code class="literal"><span class="emphasis"><em>parameter-type2 parameter-name2 ...</em></span></code><code class="computeroutput"><span class="special">)</span></code>
                </p>
              </td>
<td>
                <p>
                  <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a><span class="special">(</span> <span class="special">(</span></code><code class="literal"><span class="emphasis"><em>parameter-type1
                  parameter-name1</em></span></code><code class="computeroutput"><span class="special">)</span>
                  <span class="special">(</span></code><code class="literal"><span class="emphasis"><em>parameter-type2
                  parameter-name2</em></span></code><code class="computeroutput"><span class="special">)</span></code>
                  <code class="literal"><span class="emphasis"><em>...</em></span></code><code class="computeroutput"><span class="special">)</span></code>
                </p>
              </td>
</tr></tbody>
</table></div>
<p>
        The local function body is specified in a code block <code class="computeroutput"><span class="special">{</span>
        <span class="special">...</span> <span class="special">}</span></code>
        using the usual C++ syntax. The body is specified outside any of the macros
        so eventual compiler error messages and line numbers retain their usual meaning.
        <sup>[<a name="id867127" href="#ftn.id867127" class="footnote">3</a>]</sup>
      </p>
<p>
        The macro <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_NAME.html" title="Macro BOOST_LOCAL_FUNCTION_NAME">BOOST_LOCAL_FUNCTION_NAME</a></code>
        is used to end the local function definition and to specify the local function
        name. <sup>[<a name="id867163" href="#ftn.id867163" class="footnote">4</a>]</sup>
      </p>
<p>
        For example, let's program a local function named <code class="computeroutput"><span class="identifier">add</span></code>
        that takes two integer numbers <code class="computeroutput"><span class="identifier">x</span></code>
        and <code class="computeroutput"><span class="identifier">y</span></code>, and adds them together
        -- for simplicity, we will not bind any of the variables in scope just yet
        (binding is explained later in this section):
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">int</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span><span class="keyword">int</span> <span class="identifier">x</span><span class="special">,</span> <span class="keyword">int</span> <span class="identifier">y</span><span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">x</span> <span class="special">+</span> <span class="identifier">y</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>

    <span class="identifier">add</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="number">2</span><span class="special">);</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">int</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span> <span class="special">(</span><span class="keyword">int</span> <span class="identifier">x</span><span class="special">)</span> <span class="special">(</span><span class="keyword">int</span> <span class="identifier">y</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">x</span> <span class="special">+</span> <span class="identifier">y</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>

    <span class="identifier">add</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="number">2</span><span class="special">);</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
</tr></tbody>
</table></div>
<p>
        Note that not all compilers that support variadic macros also support empty
        macro parameters.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_local.Tutorial.Empty_Parameters"></a><a class="link" href="Tutorial.html#boost_local.Tutorial.Empty_Parameters" title="Empty Parameters">Empty Parameters</a>
</h3></div></div></div>
<p>
        C++ allows to specify a function with no parameters using the empty parenthesis
        <code class="computeroutput"><span class="special">()</span></code>. For example, let's program
        a function <code class="computeroutput"><span class="identifier">ten</span></code> which takes
        no parameter and returns the integer number <code class="computeroutput"><span class="number">10</span></code>:
      </p>
<pre class="programlisting"><span class="keyword">int</span> <span class="identifier">ten</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="number">10</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
        The ISO C++ standard does not allow pass empty parameters to a macro so the
        macro <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a></code>
        cannot be invoked with an empty set of parenthesis <code class="computeroutput"><span class="special">()</span></code>
        unless programmers use compiler extensions that support empty macro parameters
        (e.g., C99 and later compilers). However, C++ also allows to specify an empty
        parameter list using the keyword <code class="computeroutput"><span class="keyword">void</span></code>:
      </p>
<pre class="programlisting"><span class="keyword">int</span> <span class="identifier">ten</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="number">10</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
        Therefore, on all C++ compilers the macro <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a></code>
        can be invoked passing one parameter <code class="computeroutput"><span class="special">(</span><span class="keyword">void</span><span class="special">)</span></code> to specify
        an empty parameter list. In addition, on compilers that support variadic
        macros, the macro <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a></code>
        can be invoked passing one parameter <code class="computeroutput"><span class="keyword">void</span></code>
        (without the extra parenthesis). In summary, depending on your compiler support
        for empty macro parameters and variadic macros, this library accepts any
        of the following syntaxes to specify an empty parameter list:
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Empty Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a><span class="special">()</span></code>
                </p>
              </td>
<td>
                <p>
                  <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a><span class="special">(</span><span class="keyword">void</span><span class="special">)</span></code>
                </p>
              </td>
<td>
                <p>
                  <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS">BOOST_LOCAL_FUNCTION_PARAMS</a><span class="special">(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span>
                  <span class="special">)</span></code>
                </p>
              </td>
</tr></tbody>
</table></div>
<p>
        For example, let's program the function <code class="computeroutput"><span class="identifier">ten</span></code>
        as a local function:
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Empty Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">int</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">()</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="number">10</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">ten</span><span class="special">)</span>

    <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="identifier">ten</span><span class="special">()</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">int</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="number">10</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">ten</span><span class="special">)</span>

    <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="identifier">ten</span><span class="special">()</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">int</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="number">10</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">ten</span><span class="special">)</span>

    <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="identifier">ten</span><span class="special">()</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
</tr></tbody>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_local.Tutorial.default_parameters"></a><a class="link" href="Tutorial.html#boost_local.Tutorial.default_parameters" title="Default Parameters">Default Parameters</a>
</h3></div></div></div>
<p>
        This library also allows to specify default values for the local function
        parameters. However, the usual C++ syntax for default parameters that uses
        the assignment symbol <code class="computeroutput"><span class="special">=</span></code> cannot
        be used. <sup>[<a name="id869089" href="#ftn.id869089" class="footnote">5</a>]</sup> The keyword <code class="computeroutput"><span class="keyword">default</span></code>
        is used instead:
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  <code class="literal"><span class="emphasis"><em>parameter-type parameter-name</em></span></code><code class="computeroutput"><span class="special">,</span> <span class="keyword">default</span></code>
                  <code class="literal"><span class="emphasis"><em>parameter-default-value</em></span></code><code class="computeroutput"><span class="special">,</span></code> <code class="literal"><span class="emphasis"><em>...</em></span></code>
                </p>
              </td>
<td>
                <p>
                  <code class="computeroutput"><span class="special">(</span></code><code class="literal"><span class="emphasis"><em>parameter-type
                  parameter-name</em></span></code><code class="computeroutput"><span class="special">)(</span><span class="keyword">default</span></code> <code class="literal"><span class="emphasis"><em>parameter-default-value</em></span></code><code class="computeroutput"><span class="special">)</span></code> <code class="literal"><span class="emphasis"><em>...</em></span></code>
                </p>
              </td>
</tr></tbody>
</table></div>
<p>
        For example, let's assume that the we want to program a local function <code class="computeroutput"><span class="identifier">add</span><span class="special">(</span><span class="identifier">x</span><span class="special">,</span> <span class="identifier">y</span><span class="special">)</span></code>
        similar to the one programmed above but where the second parameter <code class="computeroutput"><span class="identifier">y</span></code> is optional and has a default value of
        <code class="computeroutput"><span class="number">2</span></code>:
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">int</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span><span class="keyword">int</span> <span class="identifier">x</span><span class="special">,</span> <span class="keyword">int</span> <span class="identifier">y</span><span class="special">,</span> <span class="keyword">default</span> <span class="number">2</span><span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">x</span> <span class="special">+</span> <span class="identifier">y</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>

    <span class="identifier">add</span><span class="special">(</span><span class="number">1</span><span class="special">);</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">int</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span> <span class="special">(</span><span class="keyword">int</span> <span class="identifier">x</span><span class="special">)</span> <span class="special">(</span><span class="keyword">int</span> <span class="identifier">y</span><span class="special">)(</span><span class="keyword">default</span> <span class="number">2</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">x</span> <span class="special">+</span> <span class="identifier">y</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>

    <span class="identifier">add</span><span class="special">(</span><span class="number">1</span><span class="special">);</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
</tr></tbody>
</table></div>
<p>
        If this variadic macro syntax seems strange, programmers could define a
        <code class="computeroutput"><span class="identifier">WITH_DEFAULT</span></code> macro similar
        to the following if they think it improves readability:
      </p>
<div class="informaltable"><table class="table">
<colgroup><col></colgroup>
<thead><tr><th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th></tr></thead>
<tbody><tr><td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="preprocessor">#define</span> <span class="identifier">WITH_DEFAULT</span> <span class="special">,</span> <span class="keyword">default</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">int</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span><span class="keyword">int</span> <span class="identifier">x</span><span class="special">,</span> <span class="keyword">int</span> <span class="identifier">y</span> <span class="identifier">WITH_DEFAULT</span> <span class="number">2</span><span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">x</span> <span class="special">+</span> <span class="identifier">y</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>

    <span class="identifier">add</span><span class="special">(</span><span class="number">1</span><span class="special">);</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td></tr></tbody>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_local.Tutorial.Binding"></a><a class="link" href="Tutorial.html#boost_local.Tutorial.Binding" title="Binding">Binding</a>
</h3></div></div></div>
<p>
        Variables in scope (local variables, enclosing function parameters, member
        variables, the object <code class="computeroutput"><span class="keyword">this</span></code>,
        etc) can be bound to a local function declaration. The types of bound variables
        are automatically deduced by this library using <a href="http://www.boost.org/doc/libs/release/doc/html/typeof.html" target="_top">Boost.Typeof</a>.
        <sup>[<a name="id870313" href="#ftn.id870313" class="footnote">6</a>]</sup>
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../../../doc/src/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
          User defined <span class="bold"><strong>types need to be manually registered</strong></span>
          as usual when using <a href="http://www.boost.org/doc/libs/release/doc/html/typeof.html" target="_top">Boost.Typeof</a>
          (see <a href="http://www.boost.org/doc/libs/release/doc/html/typeof.html" target="_top">Boost.Typeof</a>
          documentation and the Local Exit example from the <a class="link" href="Examples.html" title="Appendix: Examples">Examples</a>
          section).
        </p></td></tr>
</table></div>
<p>
        This library introduces the new "keyword" <code class="computeroutput"><span class="identifier">bind</span></code>
        <sup>[<a name="id870408" href="#ftn.id870408" class="footnote">7</a>]</sup> which is used in place of the parameter type to specify the name
        of a variable in scope to bind. The variable can be bound by value:
      </p>
<pre class="programlisting"><span class="identifier">bind</span> <span class="emphasis"><em>variable-name</em></span> <span class="comment">// Bind by value.
</span></pre>
<p>
        Or by reference if the variable name is prefixed by <code class="computeroutput"><span class="special">&amp;</span></code>:
      </p>
<pre class="programlisting"><span class="identifier">bind</span><span class="special">&amp;</span> <span class="emphasis"><em>variable-name</em></span> <span class="comment">// Bind by reference.
</span></pre>
<p>
        Furthermore, the "keyword" <code class="computeroutput"><span class="identifier">bind</span></code>
        can be prefixed by <code class="computeroutput"><span class="keyword">const</span></code> to
        bind the variable by constant value:
      </p>
<pre class="programlisting"><span class="keyword">const</span> <span class="identifier">bind</span> <span class="emphasis"><em>variable-name</em></span> <span class="comment">// Bind by constant value.
</span></pre>
<p>
        Or by constant reference:
      </p>
<pre class="programlisting"><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="emphasis"><em>variable-name</em></span> <span class="comment">// Bind by constant value.
</span></pre>
<p>
        If a variable is bound by value, then a copy of the variable value is taken
        at the point of the local function declaration. If a variable is bound by
        reference instead, the variable will refer to the value it has at the point
        of the local function call. Furthermore, it is the programmers' responsibility
        to ensure that variables bound by reference survive the scope of declaration
        of the local function otherwise the bound references will be invalid causing
        run-time errors (in other words, the usual care in using C++ references must
        be used for variables bound by reference).
      </p>
<p>
        The type of bound variables is automatically deduced and it is the exact
        same type used to declare such variables in the enclosing scope. Therefore,
        if a bound variable was declared constant using the <code class="computeroutput"><span class="keyword">const</span></code>
        qualifier then it will be bound by constant value or reference and if a bound
        variable was not declared constant then it will not be bound as constant
        unless constant binding is forced using <code class="computeroutput"><span class="keyword">const</span>
        <span class="identifier">bind</span> <span class="special">...</span></code>
        (note that binding by constant reference is not supported by <a href="http://en.wikipedia.org/wiki/C%2B%2B0x#Lambda_functions_and_expressions" target="_top">C++0x
        lambda</a> functions). <sup>[<a name="id870663" href="#ftn.id870663" class="footnote">8</a>]</sup> Programmers might want to bind variables of complex types by
        (constant) reference instead than by value to avoid expensive copy operations
        when these variables are automatically passed to the local function (as usual
        with C++ function parameter passing).
      </p>
<p>
        For example, let's program a local function <code class="computeroutput"><span class="identifier">add</span></code>
        similar to the one in the example from the <a class="link" href="../index.html#boost_local.Introduction" title="Introduction">Introduction</a>
        section. We bind the local variable <code class="computeroutput"><span class="identifier">factor</span></code>
        by constant value, the local variable <code class="computeroutput"><span class="identifier">sum</span></code>
        by (non-constant) reference, and program the body to perform the summation:
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">double</span> <span class="identifier">sum</span> <span class="special">=</span> <span class="number">0.0</span><span class="special">;</span>
    <span class="keyword">int</span> <span class="identifier">factor</span> <span class="special">=</span> <span class="number">10</span><span class="special">;</span>

    <span class="keyword">void</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span><span class="keyword">double</span> <span class="identifier">num</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">bind</span> <span class="identifier">factor</span><span class="special">,</span>
            <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">{</span>
        <span class="identifier">sum</span> <span class="special">+=</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="identifier">num</span><span class="special">;</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Summed: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">sum</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>

    <span class="identifier">add</span><span class="special">(</span><span class="number">100.0</span><span class="special">);</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">double</span> <span class="identifier">sum</span> <span class="special">=</span> <span class="number">0.0</span><span class="special">;</span>
    <span class="keyword">int</span> <span class="identifier">factor</span> <span class="special">=</span> <span class="number">10</span><span class="special">;</span>

    <span class="keyword">void</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span> <span class="special">(</span><span class="keyword">double</span> <span class="identifier">num</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span> <span class="identifier">factor</span><span class="special">)</span>
            <span class="special">(</span><span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="identifier">sum</span> <span class="special">+=</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="identifier">num</span><span class="special">;</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Summed: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">sum</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>

    <span class="identifier">add</span><span class="special">(</span><span class="number">100.0</span><span class="special">);</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
</tr></tbody>
</table></div>
<a name="boost_local.Tutorial.Binding.binding_the_object__code__phrase_role__keyword__this__phrase___code_"></a><h6>
<a name="id871651"></a>
        <a class="link" href="Tutorial.html#boost_local.Tutorial.Binding.binding_the_object__code__phrase_role__keyword__this__phrase___code_">Binding
        the Object <code class="computeroutput"><span class="keyword">this</span></code></a>
      </h6>
<p>
        It is also possible to bind the object <code class="computeroutput"><span class="keyword">this</span></code>
        when it is in scope (e.g., from an enclosing member function). This is done
        by using <code class="computeroutput"><span class="keyword">this</span></code> as the name of
        the variable to bind and by using the special symbol <code class="computeroutput"><span class="identifier">this_</span></code>
        (instead of <code class="computeroutput"><span class="keyword">this</span></code>) to access
        the object within the local function body.
      </p>
<p>
        The object <code class="computeroutput"><span class="keyword">this</span></code> can be bound
        by value:
      </p>
<pre class="programlisting"><span class="identifier">bind</span> <span class="keyword">this</span> <span class="comment">// Bind the object `this` by value.
</span></pre>
<p>
        In this case the local function will be able to modify the object when the
        enclosing scope is not a constant member, or it will not be able to modify
        the object when the enclosing scope is a constant member. Otherwise, the
        object <code class="computeroutput"><span class="keyword">this</span></code> can be bound by
        constant value:
      </p>
<pre class="programlisting"><span class="keyword">const</span> <span class="identifier">bind</span> <span class="keyword">this</span> <span class="comment">// Bind the object `this` by constant value.
</span></pre>
<p>
        In this case the local function will never be able to modify the object (regardless
        of whether the enclosing scope is a constant member or not).
      </p>
<p>
        Note that the object <code class="computeroutput"><span class="keyword">this</span></code> can
        never be bound by reference because C++ does not allow to obtain a reference
        to <code class="computeroutput"><span class="keyword">this</span></code> (the library will generate
        a compile-time error if programmers try to use <code class="computeroutput"><span class="identifier">bind</span><span class="special">&amp;</span> <span class="keyword">this</span></code>
        or <code class="computeroutput"><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="keyword">this</span></code>).
        Note that <code class="computeroutput"><span class="keyword">this</span></code> is a pointer
        so the object is not copied even if it is bound by value (it is not possible
        to bind <code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code>
        because <code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code>
        is an expression and not a valid name of a variable in scope).
      </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../../../../../doc/src/images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top">
<p>
          When the object <code class="computeroutput"><span class="keyword">this</span></code> is bound
          to a local function, the local function <span class="bold"><strong>body must
          use the special symbol</strong></span> <code class="computeroutput"><span class="identifier">this_</span></code>
          (instead of <code class="computeroutput"><span class="keyword">this</span></code>) to access
          the bound object. <sup>[<a name="id871970" href="#ftn.id871970" class="footnote">9</a>]</sup>
        </p>
<p>
          Unfortunately, mistakenly using <code class="computeroutput"><span class="keyword">this</span></code>
          within the local function body instead of <code class="computeroutput"><span class="identifier">this_</span></code>
          will not necessarily generate a compile-time error. <sup>[<a name="id872064" href="#ftn.id872064" class="footnote">10</a>]</sup> Programmers are responsible to make sure that <code class="computeroutput"><span class="keyword">this</span></code> is never used within a local function
          body which should only use the special symbol <code class="computeroutput"><span class="identifier">this_</span></code>.
        </p>
</td></tr>
</table></div>
<p>
        For example, let's rewrite a local function <code class="computeroutput"><span class="identifier">add</span></code>
        similar to the one in the example from the <a class="link" href="../index.html#boost_local.Introduction" title="Introduction">Introduction</a>
        section but using a member function to illustrate how to bind the object
        <code class="computeroutput"><span class="keyword">this</span></code>:
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">vector</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">algorithm</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">class</span> <span class="identifier">adder</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="identifier">adder</span><span class="special">():</span> <span class="identifier">sum_</span><span class="special">(</span><span class="number">0.0</span><span class="special">)</span> <span class="special">{}</span>

    <span class="keyword">double</span> <span class="identifier">sum</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;&amp;</span> <span class="identifier">nums</span><span class="special">,</span> <span class="keyword">const</span> <span class="keyword">int</span><span class="special">&amp;</span> <span class="identifier">factor</span> <span class="special">=</span> <span class="number">10</span><span class="special">)</span> <span class="special">{</span>
        <span class="keyword">void</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span><span class="keyword">double</span> <span class="identifier">num</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">bind</span> <span class="identifier">factor</span><span class="special">,</span>
                <span class="identifier">bind</span> <span class="keyword">this</span><span class="special">)</span> <span class="special">{</span>
            <span class="identifier">this_</span><span class="special">-&gt;</span><span class="identifier">sum_</span> <span class="special">+=</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="identifier">num</span><span class="special">;</span> <span class="comment">// Use `this_` instead of `this`.
</span>            <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Summed: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">this_</span><span class="special">-&gt;</span><span class="identifier">sum_</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
        <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>

        <span class="identifier">std</span><span class="special">::</span><span class="identifier">for_each</span><span class="special">(</span><span class="identifier">nums</span><span class="special">.</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">nums</span><span class="special">.</span><span class="identifier">end</span><span class="special">(),</span> <span class="identifier">add</span><span class="special">);</span>
        <span class="keyword">return</span> <span class="identifier">sum_</span><span class="special">;</span>
    <span class="special">}</span>

<span class="keyword">private</span><span class="special">:</span>
    <span class="keyword">double</span> <span class="identifier">sum_</span><span class="special">;</span>
<span class="special">};</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;</span> <span class="identifier">v</span><span class="special">(</span><span class="number">3</span><span class="special">);</span>
    <span class="identifier">v</span><span class="special">[</span><span class="number">0</span><span class="special">]</span> <span class="special">=</span> <span class="number">100.0</span><span class="special">;</span> <span class="identifier">v</span><span class="special">[</span><span class="number">1</span><span class="special">]</span> <span class="special">=</span> <span class="number">90.5</span><span class="special">;</span> <span class="identifier">v</span><span class="special">[</span><span class="number">2</span><span class="special">]</span> <span class="special">=</span> <span class="number">7.0</span><span class="special">;</span>

    <span class="identifier">adder</span> <span class="identifier">a</span><span class="special">;</span>
    <span class="comment">// sum = 10 * 100.0 + 10 * 90.5 + 10 * 7.0 = 1975.0
</span>    <span class="identifier">assert</span><span class="special">(</span><span class="identifier">a</span><span class="special">.</span><span class="identifier">sum</span><span class="special">(</span><span class="identifier">v</span><span class="special">)</span> <span class="special">==</span> <span class="number">1975.0</span><span class="special">);</span>

    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">vector</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">algorithm</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">class</span> <span class="identifier">adder</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="identifier">adder</span><span class="special">():</span> <span class="identifier">sum_</span><span class="special">(</span><span class="number">0.0</span><span class="special">)</span> <span class="special">{}</span>

    <span class="keyword">double</span> <span class="identifier">sum</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;&amp;</span> <span class="identifier">nums</span><span class="special">,</span> <span class="keyword">const</span> <span class="keyword">int</span><span class="special">&amp;</span> <span class="identifier">factor</span> <span class="special">=</span> <span class="number">10</span><span class="special">)</span> <span class="special">{</span>
        <span class="keyword">void</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span> <span class="special">(</span><span class="keyword">double</span> <span class="identifier">num</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span> <span class="identifier">factor</span><span class="special">)</span>
                <span class="special">(</span><span class="identifier">bind</span> <span class="keyword">this</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
            <span class="identifier">this_</span><span class="special">-&gt;</span><span class="identifier">sum_</span> <span class="special">+=</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="identifier">num</span><span class="special">;</span> <span class="comment">// Use `this_` instead of `this`.
</span>            <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Summed: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">this_</span><span class="special">-&gt;</span><span class="identifier">sum_</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
        <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>

        <span class="identifier">std</span><span class="special">::</span><span class="identifier">for_each</span><span class="special">(</span><span class="identifier">nums</span><span class="special">.</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">nums</span><span class="special">.</span><span class="identifier">end</span><span class="special">(),</span> <span class="identifier">add</span><span class="special">);</span>
        <span class="keyword">return</span> <span class="identifier">sum_</span><span class="special">;</span>
    <span class="special">}</span>

<span class="keyword">private</span><span class="special">:</span>
    <span class="keyword">double</span> <span class="identifier">sum_</span><span class="special">;</span>
<span class="special">};</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;</span> <span class="identifier">v</span><span class="special">(</span><span class="number">3</span><span class="special">);</span>
    <span class="identifier">v</span><span class="special">[</span><span class="number">0</span><span class="special">]</span> <span class="special">=</span> <span class="number">100.0</span><span class="special">;</span> <span class="identifier">v</span><span class="special">[</span><span class="number">1</span><span class="special">]</span> <span class="special">=</span> <span class="number">90.5</span><span class="special">;</span> <span class="identifier">v</span><span class="special">[</span><span class="number">2</span><span class="special">]</span> <span class="special">=</span> <span class="number">7.0</span><span class="special">;</span>

    <span class="identifier">adder</span> <span class="identifier">a</span><span class="special">;</span>
    <span class="comment">// sum = 10 * 100.0 + 10 * 90.5 + 10 * 7.0 = 1975.0
</span>    <span class="identifier">assert</span><span class="special">(</span><span class="identifier">a</span><span class="special">.</span><span class="identifier">sum</span><span class="special">(</span><span class="identifier">v</span><span class="special">)</span> <span class="special">==</span> <span class="number">1975.0</span><span class="special">);</span>

    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
</tr></tbody>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_local.Tutorial.local_blocks"></a><a class="link" href="Tutorial.html#boost_local.Tutorial.local_blocks" title="Local Blocks">Local Blocks</a>
</h3></div></div></div>
<p>
        Local blocks are defined using the following macros within a declarative
        context (see the <a href="../reference.html" target="_top">Reference</a> section):
      </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">block</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="special">...</span>
<span class="special">{</span> <span class="comment">// Some declarative context.
</span>    <span class="special">...</span>
    <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_BLOCK.html" title="Macro BOOST_LOCAL_BLOCK">BOOST_LOCAL_BLOCK</a></code><span class="special">(</span><span class="emphasis"><em>bindings</em></span><span class="special">)</span> <span class="special">{</span>
        <span class="emphasis"><em>body-code</em></span>
    <span class="special">}</span> <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_BLOCK_END.html" title="Macro BOOST_LOCAL_BLOCK_END">BOOST_LOCAL_BLOCK_END</a></code>
    <span class="special">...</span>
<span class="special">}</span>
</pre>
<p>
        These macros expand to code that executes the body instructions "in
        place" where the block is defined.
      </p>
<p>
        Only bound variables specified bu <code class="literal"><span class="emphasis"><em>bindings</em></span></code>
        are accessible from within the local block body. Following the same syntax
        used for local functions, <code class="literal"><span class="emphasis"><em>bindings</em></span></code>
        can either be empty (using <code class="computeroutput"><span class="special">(</span><span class="keyword">void</span><span class="special">)</span></code>, <code class="computeroutput"><span class="keyword">void</span></code>, or an empty macro parameter depending
        on your compiler extensions, see <a class="link" href="Tutorial.html#boost_local.Tutorial.Empty_Parameters" title="Empty Parameters">Empty
        Parameters</a>), or they can list the variables to bind using the "keyword"
        <code class="computeroutput"><span class="identifier">bind</span></code> in place of the parameter
        type, using <code class="computeroutput"><span class="keyword">const</span> <span class="identifier">bind</span></code>
        for constant binding, prefixing the bound variable name with <code class="computeroutput"><span class="special">&amp;</span></code> to bind by reference, and using <code class="computeroutput"><span class="keyword">this</span></code> to bind the object in scope (see <a class="link" href="Tutorial.html#boost_local.Tutorial.Binding" title="Binding">Binding</a>).
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../../../doc/src/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
          A <code class="computeroutput"><span class="keyword">return</span><span class="special">;</span></code>
          instruction from within a local block jumps to the end of the local block
          body and <span class="bold"><strong>it does not return the enclosing function</strong></span>.
          <sup>[<a name="id874515" href="#ftn.id874515" class="footnote">11</a>]</sup>
        </p></td></tr>
</table></div>
<p>
        For example, let's program a local block similar to the one in the example
        from the <a class="link" href="../index.html#boost_local.Introduction" title="Introduction">Introduction</a> section:
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">block</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">double</span> <span class="identifier">sum</span> <span class="special">=</span> <span class="number">1975.0</span><span class="special">;</span>

    <span class="identifier">BOOST_LOCAL_BLOCK</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">{</span>
        <span class="identifier">assert</span><span class="special">(</span><span class="identifier">sum</span> <span class="special">==</span> <span class="number">1975.0</span><span class="special">);</span> <span class="comment">// OK: Complier error if `==` confused with `=`.
</span>        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Asserted summation: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">sum</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>

        <span class="keyword">return</span><span class="special">;</span> <span class="comment">// Return this local block (and not the enclosing scope).
</span>        <span class="identifier">assert</span><span class="special">(</span><span class="keyword">false</span><span class="special">);</span> <span class="comment">// OK: Never executed.
</span>    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_BLOCK_END</span>

    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">block</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">double</span> <span class="identifier">sum</span> <span class="special">=</span> <span class="number">1975.0</span><span class="special">;</span>

    <span class="identifier">BOOST_LOCAL_BLOCK</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="identifier">assert</span><span class="special">(</span><span class="identifier">sum</span> <span class="special">==</span> <span class="number">1975.0</span><span class="special">);</span> <span class="comment">// OK: Complier error if `==` confused with `=`.
</span>        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Asserted summation: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">sum</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>

        <span class="keyword">return</span><span class="special">;</span> <span class="comment">// Return this local block (and not the enclosing scope).
</span>        <span class="identifier">assert</span><span class="special">(</span><span class="keyword">false</span><span class="special">);</span> <span class="comment">// OK: Never executed.
</span>    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_BLOCK_END</span>

    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
</tr></tbody>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_local.Tutorial.local_exits"></a><a class="link" href="Tutorial.html#boost_local.Tutorial.local_exits" title="Local Exits">Local Exits</a>
</h3></div></div></div>
<p>
        Local exits are defined using the following macros within a declarative context
        (see the <a href="../reference.html" target="_top">Reference</a> section):
      </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">exit</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="special">...</span>
<span class="special">{</span> <span class="comment">// Some declarative context.
</span>    <span class="special">...</span>
    <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_EXIT.html" title="Macro BOOST_LOCAL_EXIT">BOOST_LOCAL_EXIT</a></code><span class="special">(</span><span class="emphasis"><em>bindings</em></span><span class="special">)</span> <span class="special">{</span>
        <span class="emphasis"><em>body-code</em></span>
    <span class="special">}</span> <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_EXIT_END.html" title="Macro BOOST_LOCAL_EXIT_END">BOOST_LOCAL_EXIT_END</a></code>
    <span class="special">...</span>
<span class="special">}</span>
</pre>
<p>
        These macros expand to code that executes the body instructions when the
        enclosing scope is exited (i.e., at the very end of the enclosing scope).
        If multiple local exits are declared within the same scope, their bodies
        will be executed in the reverse order in which they have been declared. The
        execution of the local exit code can be guaranteed only if the program does
        not terminate because of an uncaught exception. <sup>[<a name="id875720" href="#ftn.id875720" class="footnote">12</a>]</sup>
      </p>
<p>
        Only bound variables specified by <code class="literal"><span class="emphasis"><em>bindings</em></span></code>
        are accessible from within the local exit body. Following the same syntax
        used for local functions, <code class="literal"><span class="emphasis"><em>bindings</em></span></code>
        can either be empty (using <code class="computeroutput"><span class="special">(</span><span class="keyword">void</span><span class="special">)</span></code>, <code class="computeroutput"><span class="keyword">void</span></code>, or an empty macro parameter depending
        on your compiler extensions, see <a class="link" href="Tutorial.html#boost_local.Tutorial.Empty_Parameters" title="Empty Parameters">Empty
        Parameters</a>), or they can list the variables to bind using the "keyword"
        <code class="computeroutput"><span class="identifier">bind</span></code> in place of the parameter
        type, using <code class="computeroutput"><span class="keyword">const</span> <span class="identifier">bind</span></code>
        for constant binding, prefixing the bound variable name with <code class="computeroutput"><span class="special">&amp;</span></code> to bind by reference, and using <code class="computeroutput"><span class="keyword">this</span></code> to bind the object in scope (see <a class="link" href="Tutorial.html#boost_local.Tutorial.Binding" title="Binding">Binding</a>).
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../../../doc/src/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
          A <code class="computeroutput"><span class="keyword">return</span><span class="special">;</span></code>
          instruction from within a local exit jumps to the end of the local exit
          body and <span class="bold"><strong>it does not return the enclosing function</strong></span>.
        </p></td></tr>
</table></div>
<p>
        For example, let's program a local exit similar to the one in the example
        from the <a class="link" href="../index.html#boost_local.Introduction" title="Introduction">Introduction</a> section:
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">exit</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="identifier">size_t</span> <span class="identifier">size</span> <span class="special">=</span> <span class="number">2</span><span class="special">;</span>
    <span class="keyword">double</span><span class="special">*</span> <span class="identifier">nums</span> <span class="special">=</span> <span class="keyword">new</span> <span class="keyword">double</span><span class="special">[</span><span class="identifier">size</span><span class="special">];</span>
    
    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">size</span><span class="special">,</span> <span class="identifier">bind</span> <span class="identifier">nums</span><span class="special">)</span> <span class="special">{</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">size</span> <span class="special">&amp;&amp;</span> <span class="identifier">nums</span><span class="special">)</span> <span class="keyword">delete</span><span class="special">[]</span> <span class="identifier">nums</span><span class="special">;</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Freed array: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">nums</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>

        <span class="keyword">return</span><span class="special">;</span> <span class="comment">// Return this local exit (and not the enclosing scope).
</span>        <span class="identifier">assert</span><span class="special">(</span><span class="keyword">false</span><span class="special">);</span> <span class="comment">// OK: Never executed.
</span>    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>

    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">exit</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="identifier">size_t</span> <span class="identifier">size</span> <span class="special">=</span> <span class="number">2</span><span class="special">;</span>
    <span class="keyword">double</span><span class="special">*</span> <span class="identifier">nums</span> <span class="special">=</span> <span class="keyword">new</span> <span class="keyword">double</span><span class="special">[</span><span class="identifier">size</span><span class="special">];</span>
    
    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">size</span><span class="special">)</span> <span class="special">(</span><span class="identifier">bind</span> <span class="identifier">nums</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">size</span> <span class="special">&amp;&amp;</span> <span class="identifier">nums</span><span class="special">)</span> <span class="keyword">delete</span><span class="special">[]</span> <span class="identifier">nums</span><span class="special">;</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Freed array: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">nums</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>

        <span class="keyword">return</span><span class="special">;</span> <span class="comment">// Return this local exit (and not the enclosing scope).
</span>        <span class="identifier">assert</span><span class="special">(</span><span class="keyword">false</span><span class="special">);</span> <span class="comment">// OK: Never executed.
</span>    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>

    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
</tr></tbody>
</table></div>
<p>
        Local exits are very similar to the <span class="emphasis"><em>scope exits</em></span> provided
        by <a href="http://www.boost.org/doc/libs/release/libs/scope_exit/doc/html/index.html" target="_top">Boost.ScopeExit</a>
        with the addition that they also support constant binding and binding of
        the object <code class="computeroutput"><span class="keyword">this</span></code>. <sup>[<a name="id876971" href="#ftn.id876971" class="footnote">13</a>]</sup>
      </p>
<a name="boost_local.Tutorial.local_exits.d_s_scope_guards"></a><h6>
<a name="id877198"></a>
        <a class="link" href="Tutorial.html#boost_local.Tutorial.local_exits.d_s_scope_guards">D's Scope
        Guards</a>
      </h6>
<p>
        Local exits are very similar to the <a href="http://www.digitalmars.com/d/2.0/statement.html" target="_top">scope
        exit</a> statements provided by the D programming language. Local exits
        can be used also to emulate D's <a href="http://www.digitalmars.com/d/2.0/statement.html" target="_top">scope
        success</a> and <a href="http://www.digitalmars.com/d/2.0/statement.html" target="_top">scope
        failure</a> statements using a local variable that is set when an error
        occurs. For example, using error codes:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">exit</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">f</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">int</span> <span class="identifier">error</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span> <span class="comment">// No error to start with.
</span>
    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span> <span class="comment">// Same as D's `scope(exit)`.
</span>        <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"exit"</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>

    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">error</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span> <span class="comment">// Sane as D's `scope(success)`.
</span>        <span class="keyword">if</span> <span class="special">(!</span><span class="identifier">error</span><span class="special">)</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"success"</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>
    
    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">error</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span> <span class="comment">// Same as D's `scope(failure)`.
</span>        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">error</span><span class="special">)</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"failure"</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>
    
    <span class="keyword">return</span> <span class="identifier">error</span> <span class="special">=</span> <span class="special">-</span><span class="number">1</span><span class="special">;</span> <span class="comment">// Must set error.
</span><span class="special">}</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">f</span><span class="special">();</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
        Or similarly but using exceptions:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">exit</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">stdexcept</span><span class="special">&gt;</span>

<span class="keyword">void</span> <span class="identifier">f</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">bool</span> <span class="identifier">error</span> <span class="special">=</span> <span class="keyword">false</span><span class="special">;</span> <span class="comment">// No error to start with.
</span>
    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span> <span class="comment">// Same as D's `scope(exit)`.
</span>        <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"exit"</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>

    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">error</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span> <span class="comment">// Same as D's `scope(success)`.
</span>        <span class="keyword">if</span> <span class="special">(!</span><span class="identifier">error</span><span class="special">)</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"success"</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>
    
    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">error</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span> <span class="comment">// Same as D's `scope(failure)`.
</span>        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">error</span><span class="special">)</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"failure"</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>
    
    <span class="identifier">error</span> <span class="special">=</span> <span class="keyword">true</span><span class="special">;</span> <span class="keyword">throw</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">runtime_error</span><span class="special">(</span><span class="string">"some error"</span><span class="special">);</span> <span class="comment">// Must set error.
</span><span class="special">}</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="comment">// Program cannot terminate with uncaught exception (otherwise local exit
</span>    <span class="comment">// code is not guaranteed to be executed).
</span>    <span class="keyword">try</span> <span class="special">{</span>
        <span class="identifier">f</span><span class="special">();</span>
        <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
    <span class="special">}</span> <span class="keyword">catch</span><span class="special">(...)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="special">-</span><span class="number">1</span><span class="special">;</span>
    <span class="special">}</span>
<span class="special">}</span>
</pre>
<p>
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_local.Tutorial.templates"></a><a class="link" href="Tutorial.html#boost_local.Tutorial.templates" title="Templates">Templates</a>
</h3></div></div></div>
<p>
        When local functions, local blocks, and local exits are programmed within
        templates, they need to be declared using the following special macros ending
        with the <code class="computeroutput"><span class="identifier">TPL</span></code> postfix (see
        the <a href="../reference.html" target="_top">Reference</a> section): <sup>[<a name="id878746" href="#ftn.id878746" class="footnote">14</a>]</sup>
      </p>
<pre class="programlisting"><code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_PARAMS_TPL.html" title="Macro BOOST_LOCAL_FUNCTION_PARAMS_TPL">BOOST_LOCAL_FUNCTION_PARAMS_TPL</a></code><span class="special">(</span><span class="emphasis"><em>parameters</em></span><span class="special">)</span>
<code class="computeroutput"><a class="link" href="../BOOST_LOCAL_BLOCK_TPL.html" title="Macro BOOST_LOCAL_BLOCK_TPL">BOOST_LOCAL_BLOCK_TPL</a></code><span class="special">(</span><span class="emphasis"><em>bindings</em></span><span class="special">)</span>
<code class="computeroutput"><a class="link" href="../BOOST_LOCAL_EXIT_TPL.html" title="Macro BOOST_LOCAL_EXIT_TPL">BOOST_LOCAL_EXIT_TPL</a></code><span class="special">(</span><span class="emphasis"><em>bindings</em></span><span class="special">)</span>
</pre>
<p>
        These macros have the exact same API as their equivalent macros without the
        <code class="computeroutput"><span class="identifier">TPL</span></code> postfix that we have
        seen so far.
      </p>
<p>
        For example, let's rewrite a local function, a local exit, and a local block
        similar to the ones from the <a class="link" href="../index.html#boost_local.Introduction" title="Introduction">Introduction</a>
        section but wrapped within a template:
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Variadic Macro Syntax (C99 and later compilers)
                </p>
              </th>
<th>
                <p>
                  Sequencing Macro Syntax (all C++ compilers)
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">block</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">exit</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">algorithm</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">T</span> <span class="identifier">total</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">y</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">z</span><span class="special">)</span> <span class="special">{</span>
    <span class="identifier">T</span> <span class="identifier">sum</span> <span class="special">=</span> <span class="identifier">T</span><span class="special">();</span>
    <span class="keyword">int</span> <span class="identifier">factor</span> <span class="special">=</span> <span class="number">10</span><span class="special">;</span>

    <span class="comment">// Use `..._TPL()` macros within templates.
</span>    <span class="keyword">void</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS_TPL</span><span class="special">(</span><span class="identifier">T</span> <span class="identifier">num</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">bind</span> <span class="identifier">factor</span><span class="special">,</span>
            <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">{</span>
        <span class="identifier">sum</span> <span class="special">+=</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="identifier">num</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>
    <span class="identifier">add</span><span class="special">(</span><span class="identifier">x</span><span class="special">);</span>

    <span class="identifier">size_t</span> <span class="identifier">size</span> <span class="special">=</span> <span class="number">2</span><span class="special">;</span>
    <span class="identifier">T</span><span class="special">*</span> <span class="identifier">nums</span> <span class="special">=</span> <span class="keyword">new</span> <span class="identifier">T</span><span class="special">[</span><span class="identifier">size</span><span class="special">];</span>
    <span class="identifier">BOOST_LOCAL_EXIT_TPL</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">size</span><span class="special">,</span> <span class="identifier">bind</span> <span class="identifier">nums</span><span class="special">)</span> <span class="special">{</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">size</span> <span class="special">&amp;&amp;</span> <span class="identifier">nums</span><span class="special">)</span> <span class="keyword">delete</span><span class="special">[]</span> <span class="identifier">nums</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>

    <span class="identifier">nums</span><span class="special">[</span><span class="number">0</span><span class="special">]</span> <span class="special">=</span> <span class="identifier">y</span><span class="special">;</span> <span class="identifier">nums</span><span class="special">[</span><span class="number">1</span><span class="special">]</span> <span class="special">=</span> <span class="identifier">z</span><span class="special">;</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">for_each</span><span class="special">(</span><span class="identifier">nums</span><span class="special">,</span> <span class="identifier">nums</span> <span class="special">+</span> <span class="identifier">size</span><span class="special">,</span> <span class="identifier">add</span><span class="special">);</span>

    <span class="identifier">BOOST_LOCAL_BLOCK_TPL</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span> <span class="special">&amp;</span><span class="identifier">sum</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">factor</span><span class="special">,</span>
            <span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">y</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">z</span><span class="special">)</span> <span class="special">{</span>
        <span class="identifier">assert</span><span class="special">(</span><span class="identifier">sum</span> <span class="special">==</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="special">(</span><span class="identifier">x</span> <span class="special">+</span> <span class="identifier">y</span> <span class="special">+</span> <span class="identifier">z</span><span class="special">));</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_BLOCK_END</span>

    <span class="keyword">return</span> <span class="identifier">sum</span><span class="special">;</span>
<span class="special">}</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="identifier">total</span><span class="special">(</span><span class="number">100.0</span><span class="special">,</span> <span class="number">90.5</span><span class="special">,</span> <span class="number">7.0</span><span class="special">);</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">block</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">exit</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">algorithm</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">T</span> <span class="identifier">total</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">y</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">z</span><span class="special">)</span> <span class="special">{</span>
    <span class="identifier">T</span> <span class="identifier">sum</span> <span class="special">=</span> <span class="identifier">T</span><span class="special">();</span>
    <span class="keyword">int</span> <span class="identifier">factor</span> <span class="special">=</span> <span class="number">10</span><span class="special">;</span>

    <span class="comment">// Use `..._TPL()` macros within templates.
</span>    <span class="identifier">T</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS_TPL</span><span class="special">(</span> <span class="special">(</span><span class="identifier">T</span> <span class="identifier">num</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span> <span class="identifier">factor</span><span class="special">)</span>
            <span class="special">(</span><span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">sum</span> <span class="special">+=</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="identifier">num</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>
    <span class="identifier">add</span><span class="special">(</span><span class="identifier">x</span><span class="special">);</span>

    <span class="identifier">size_t</span> <span class="identifier">size</span> <span class="special">=</span> <span class="number">2</span><span class="special">;</span>
    <span class="identifier">T</span><span class="special">*</span> <span class="identifier">nums</span> <span class="special">=</span> <span class="keyword">new</span> <span class="identifier">T</span><span class="special">[</span><span class="identifier">size</span><span class="special">];</span>
    <span class="identifier">BOOST_LOCAL_EXIT_TPL</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">size</span><span class="special">)</span> <span class="special">(</span><span class="identifier">bind</span> <span class="identifier">nums</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">size</span> <span class="special">&amp;&amp;</span> <span class="identifier">nums</span><span class="special">)</span> <span class="keyword">delete</span><span class="special">[]</span> <span class="identifier">nums</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>

    <span class="identifier">nums</span><span class="special">[</span><span class="number">0</span><span class="special">]</span> <span class="special">=</span> <span class="identifier">y</span><span class="special">;</span> <span class="identifier">nums</span><span class="special">[</span><span class="number">1</span><span class="special">]</span> <span class="special">=</span> <span class="identifier">z</span><span class="special">;</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">for_each</span><span class="special">(</span><span class="identifier">nums</span><span class="special">,</span> <span class="identifier">nums</span> <span class="special">+</span> <span class="identifier">size</span><span class="special">,</span> <span class="identifier">add</span><span class="special">);</span>

    <span class="identifier">BOOST_LOCAL_BLOCK_TPL</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span> <span class="special">&amp;</span><span class="identifier">sum</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">factor</span><span class="special">)</span>
            <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">y</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">z</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="identifier">assert</span><span class="special">(</span><span class="identifier">sum</span> <span class="special">==</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="special">(</span><span class="identifier">x</span> <span class="special">+</span> <span class="identifier">y</span> <span class="special">+</span> <span class="identifier">z</span><span class="special">));</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_BLOCK_END</span>

    <span class="keyword">return</span> <span class="identifier">sum</span><span class="special">;</span>
<span class="special">}</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="identifier">total</span><span class="special">(</span><span class="number">100.0</span><span class="special">,</span> <span class="number">90.5</span><span class="special">,</span> <span class="number">7.0</span><span class="special">);</span>
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
</tr></tbody>
</table></div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div class="footnote"><p><sup>[<a id="ftn.id867127" href="#id867127" class="para">3</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> If the local function body
          were instead passed as a macro parameter, it would be expanded on a single
          line of code (because macros always expand as a single line of code). Therefore,
          eventual compiler error line numbers would all have the same value and
          would no longer be useful to pinpoint the error.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id867163" href="#id867163" class="para">4</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> The local function name must
          be passed to the macro <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_NAME.html" title="Macro BOOST_LOCAL_FUNCTION_NAME">BOOST_LOCAL_FUNCTION_NAME</a></code>
          ending the function definition so this macro can declare a local variable
          with the local function name to hold the local functor object.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id869089" href="#id869089" class="para">5</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> The assignment symbol <code class="computeroutput"><span class="special">=</span></code> cannot be used to specify default parameter
          values because default values are not part of the parameter type so they
          cannot be handled using template metaprogamming. Default parameter values
          need to be separated from the rest of the parameter declaration using the
          preprocessor. Specifically, this library needs to use preprocessor mataprogramming
          to remove default values when constructing the local function type and
          it counts the number of default values to provide the correct set of call
          operators for the local functor object.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id870313" href="#id870313" class="para">6</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> By binding a variable in scope,
          the local function declaration is specifying that such a variable should
          be accessible within the local function body regardless of its type. Semantically,
          this binding should be seen as an "extension" of the scope of
          the bound variable from the enclosing scope to the scope of the local function
          body. Contrary to the semantics of a function parameter passing, in-scope
          variable binding does not depend on the variable type but just on the variable
          name: "The variable in scope named <span class="emphasis"><em>x</em></span> should be
          accessible within the local function named <span class="emphasis"><em>l</em></span>".
          This is especially useful for maintenance so if a bound variable type is
          changed, the local function declaration does not have to change.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id870408" href="#id870408" class="para">7</a>] </sup>
          The token <code class="computeroutput"><span class="identifier">bind</span></code> is not a
          real keyword of the C++ language. This library parses <code class="computeroutput"><span class="identifier">bind</span></code>
          during macro expansion using preprocessor metaprogramming. Therefore,
          <code class="computeroutput"><span class="identifier">bind</span></code> can be considered
          a new "keyword" only at the preprocessor metaprogramming level
          within the syntax defined by the macros of this library -- thus it is referred
          to as a "keyword" only within quotes.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id870663" href="#id870663" class="para">8</a>] </sup>
          An historical note: Constant binding of variables in scope was the main
          use case that originally motivated the authors in developing this library.
          The authors needed to locally create a chuck of code to assert some correctness
          conditions while these assertions were not supposed to modify any of the
          variables they were using (see the <a href="http://sourceforge.net/projects/contractpp" target="_top">Contract++</a>
          library). This was achieved by binding by constant reference the variables
          needed by the assertions and then by programming the local function body
          to check the assertions (or more conveniently by using <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_BLOCK.html" title="Macro BOOST_LOCAL_BLOCK">BOOST_LOCAL_BLOCK</a></code>). This way
          if any of the assertions mistakenly changes a bound variable (for example
          confusing the operator <code class="computeroutput"><span class="special">==</span></code>
          with <code class="computeroutput"><span class="special">=</span></code>), the compiler correctly
          generates an error because the bound variable is of <code class="computeroutput"><span class="keyword">const</span></code>
          type within the local function body.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id871970" href="#id871970" class="para">9</a>] </sup>
            <span class="bold"><strong>Rationale.</strong></span> This limitation comes from
            the fact that <code class="computeroutput"><span class="keyword">this</span></code> is a
            reserved C++ keyword so it cannot be used as the name of the internal
            parameter passing the bound object to the local function body. It would
            be possible to use <code class="computeroutput"><span class="keyword">this</span></code>
            (instead of <code class="computeroutput"><span class="identifier">this_</span></code>) within
            the local function body either at the expenses of copying the bound object
            (which would introduce run-time overhead and also the stringent requirement
            that the bound object must have a deep copy constructor) or by relying
            on an <a href="http://groups.google.com/group/comp.lang.c++.moderated/browse_thread/thread/d3a86f27277f713b" target="_top">undefined
            behaviour of <code class="computeroutput"><span class="keyword">static_cast</span></code></a>
            (which might not work on all platforms at the cost of portability).
          </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id872064" href="#id872064" class="para">10</a>] </sup>
            <span class="bold"><strong>Rationale.</strong></span> The local function body cannot
            be a static member function of the local functor object in order to support
            recursion (because the local function name is specified by the <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_FUNCTION_NAME.html" title="Macro BOOST_LOCAL_FUNCTION_NAME">BOOST_LOCAL_FUNCTION_NAME</a></code>
            macro only after the body so it must be make available via a functor
            member variable named after the local function and local classes cannot
            have static member variables in C++) and nesting (because the argument
            binding variable must be declared as a member function so it is visible
            in a local function nested within another local function body). Therefore,
            from within the local function body the variable <code class="computeroutput"><span class="keyword">this</span></code>
            is visible but it refers to the local functor object and not to the bound
            object.
          </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id874515" href="#id874515" class="para">11</a>] </sup>
            <span class="bold"><strong>Rationale.</strong></span> Programmers might expect
            <code class="computeroutput"><span class="keyword">return</span><span class="special">;</span></code>
            to exit the enclosing function instead of the local block (or local exit),
            especially if the enclosing function has a <code class="computeroutput"><span class="keyword">void</span></code>
            result type. However, using <code class="computeroutput"><span class="keyword">return</span><span class="special">;</span></code> to exit local blocks (and local exits)
            seemed to follow a natural syntax and also it is the same syntax already
            provided by <a href="http://www.boost.org/doc/libs/release/libs/scope_exit/doc/html/index.html" target="_top">Boost.ScopeExit</a>
            (in fact, <code class="computeroutput"><span class="keyword">return</span><span class="special">;</span></code>
            is used by <a href="http://www.boost.org/doc/libs/release/libs/scope_exit/doc/html/index.html" target="_top">Boost.ScopeExit</a>
            to exit the local scope and not to exit the enclosing scope). If programmers
            were to find this use of <code class="computeroutput"><span class="keyword">return</span><span class="special">;</span></code> confusing, this library API could be
            changed to forbid the use of <code class="computeroutput"><span class="keyword">return</span></code>
            from within local blocks (and local exits) generating a compile-time
            error, and to use a different instruction (e.g., <code class="computeroutput"><span class="keyword">break</span><span class="special">;</span></code> or a special macro instruction like
            <code class="computeroutput"><span class="identifier">BOOST_LOCAL_RETURN</span><span class="special">;</span></code>)
            to exit local blocks (and local exits).
          </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id875720" href="#id875720" class="para">12</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> This library (as well as <a href="http://www.boost.org/doc/libs/release/libs/scope_exit/doc/html/index.html" target="_top">Boost.ScopeExit</a>)
          uses the destructor of a local variable to automatically execute the local
          exit code upon exit of the enclosing scope. However, in C++ it is no possible
          to (portably) ensure the execution of the destructor of all objects if
          the main program terminates because of an uncaught exception. (This is
          different from the D programming language which executes the scope exit
          code even if the main program terminates because of an uncaught exception.)
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id876971" href="#id876971" class="para">13</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> This library could be merged
          together with <a href="http://www.boost.org/doc/libs/release/libs/scope_exit/doc/html/index.html" target="_top">Boost.ScopeExit</a>
          into a new library named Boost.Scope (from the meaning of the word "<a href="http://en.wikipedia.org/wiki/Scope_(programming)" target="_top">scope</a>"
          in computer programming). This would be justified by the fact that <code class="computeroutput"><a class="link" href="../BOOST_LOCAL_EXIT.html" title="Macro BOOST_LOCAL_EXIT">BOOST_LOCAL_EXIT</a></code> simply extends
          the functionality already provided by <code class="computeroutput"><span class="identifier">BOOST_SCOPE_EXIT</span></code>.
          The headers will be <code class="computeroutput"><span class="string">"boost/scope/function.hpp"</span></code>,
          <code class="computeroutput"><span class="string">"boost/scope/block.hpp"</span></code>,
          and <code class="computeroutput"><span class="string">"boost/scope/exit.hpp"</span></code>
          (for backward compatibility with <a href="http://www.boost.org/doc/libs/release/libs/scope_exit/doc/html/index.html" target="_top">Boost.ScopeExit</a>,
          the header <code class="computeroutput"><span class="string">"boost/scope_exit.hpp"</span></code>
          could also be kept and it would be equivalent to including <code class="computeroutput"><span class="string">"boost/scope/exit.hpp"</span></code>). However,
          the new <code class="computeroutput"><span class="identifier">BOOST_SCOPE_EXIT</span></code>
          macro will not be backward compatible with the current <a href="http://www.boost.org/doc/libs/release/libs/scope_exit/doc/html/index.html" target="_top">Boost.ScopeExit</a>
          macro because it will require to prefix the bound variable with <code class="computeroutput"><span class="identifier">bind</span></code> or <code class="computeroutput"><span class="keyword">const</span>
          <span class="identifier">bind</span></code> (in order to differentiate
          from constant and non-constant binding). Local blocks would be named "scope
          blocks" and they would be provided by the <code class="computeroutput"><span class="identifier">BOOST_SCOPE_BLOCK</span><span class="special">...</span></code> macros (the "scope block"
          names seem reasonably expressive). However, local functions would have
          to be named "scope functions" and they would be provided by the
          <code class="computeroutput"><span class="identifier">BOOST_SCOPE_FUNCTION</span><span class="special">...</span></code>
          macros. These names might not expressive enough because local functions
          are not known under the name of "scope functions" -- they are
          indeed known by either the name of "local functions" or by the
          name of "<a href="http://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html" target="_top">nested
          functions</a>".
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id878746" href="#id878746" class="para">14</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> Within templates, this library
          needs to use <code class="computeroutput"><span class="keyword">typename</span></code> to explicitly
          indicate that some expressions evaluate to a type. Because C++ does not
          allow this use of <code class="computeroutput"><span class="keyword">typename</span></code>
          outside templates, the special <code class="computeroutput"><span class="identifier">TPL</span></code>
          macros are used to indicate that the enclosing scope is a template so this
          library can safety use <code class="computeroutput"><span class="keyword">typename</span></code>
          to resolve expression type ambiguities.
        </p></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2009 -2011 Lorenzo Caminiti<p>
        Use, modification, and distribution is subject to the Boost Software License,
        Version 1.0 (see accompanying file LICENSE_1_0.txt or a copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>).
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="Getting.html"><img src="../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="Advanced.html"><img src="../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
