<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Boost.Local 0.1.1</title>
<link rel="stylesheet" href="../../../../doc/src/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="index.html" title="Boost.Local 0.1.1">
<link rel="next" href="boost_local/Getting_Started.html" title="Getting Started">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../boost.png"></td>
<td align="center"><a href="../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav"><a accesskey="n" href="boost_local/Getting_Started.html"><img src="../../../../doc/src/images/next.png" alt="Next"></a></div>
<div class="preface">
<div class="titlepage"><div>
<div><h2 class="title">
<a name="boost_local"></a>Boost.Local 0.1.1 </h2></div>
<div><div class="authorgroup"><div class="author"><h3 class="author">
<span class="firstname">Lorenzo</span> <span class="surname">Caminiti (lorcaminiti@gmail.com)</span>
</h3></div></div></div>
<div><p class="copyright">Copyright &#169; 2009 -2011 Lorenzo Caminiti</p></div>
<div><div class="legalnotice">
<a name="id810406"></a><p>
        Use, modification, and distribution is subject to the Boost Software License,
        Version 1.0 (see accompanying file LICENSE_1_0.txt or a copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>).
      </p>
</div></div>
</div></div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="section"><a href="index.html#boost_local.Introduction">Introduction</a></span></dt>
<dt><span class="section"><a href="boost_local/Getting_Started.html">Getting Started</a></span></dt>
<dt><span class="section"><a href="boost_local/Tutorial.html">Tutorial</a></span></dt>
<dt><span class="section"><a href="boost_local/Advanced_Topics.html">Advanced Topics</a></span></dt>
<dt><span class="section"><a href="reference.html">Reference</a></span></dt>
<dt><span class="section"><a href="boost_local/Examples.html">Appendix: Examples</a></span></dt>
<dt><span class="section"><a href="boost_local/Alternatives.html">Appendix: Alternatives</a></span></dt>
<dt><span class="section"><a href="boost_local/Implementation.html">Appendix: Implementation</a></span></dt>
<dt><span class="section"><a href="boost_local/Release_Notes.html">Release Notes</a></span></dt>
<dt><span class="section"><a href="boost_local/Bibliography.html">Bibliography</a></span></dt>
<dt><span class="section"><a href="boost_local/Acknowledgments.html">Acknowledgments</a></span></dt>
</dl>
</div>
<p>
    The Boost Local library implements local functions, local blocks, and local exits
    for the C++ programming language.
  </p>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="boost_local.Introduction"></a><a class="link" href="index.html#boost_local.Introduction" title="Introduction">Introduction</a>
</h2></div></div></div>
<p>
      <span class="emphasis"><em>Local functions</em></span> are a form of <span class="emphasis"><em>information hiding</em></span>
      and are useful for dividing procedural tasks into subtasks which are only meaningful
      locally, avoiding cluttering other parts of the program with functions, variables,
      etc unrelated to those parts. Local functions therefore complement other structuring
      possibilities such as namespaces and classes. Local functions are a feature
      of many programming languages, notably <a href="http://en.wikipedia.org/wiki/Nested_function#An_example" target="_top">Pascal</a>
      and <a href="http://en.wikipedia.org/wiki/Nesting_(computing)#In_programming" target="_top">Ada</a>,
      yet lacking from C++ (see also <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2511.html" target="_top">[N2511]</a>).
      This library supports the following features for local functions (see the
      <a class="link" href="boost_local/Alternatives.html" title="Appendix: Alternatives">Alternatives</a> section for a
      comparison between this library and the features offered by other C++ libraries
      and constructs):
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          Local functions can access, or better <a href="http://en.wikipedia.org/wiki/Name_binding" target="_top"><span class="emphasis"><em>bind</em></span></a>,
          any of the variables from the enclosing scope. Furthermore, local functions
          defined within a member function can bind the enclosing object <code class="computeroutput"><span class="keyword">this</span></code>.
        </li>
<li class="listitem">
          The local function body is programmed using the usual C++ syntax (as a
          consequence, compiler error messages and line numbers retain their usual
          meaning).
        </li>
<li class="listitem">
          Local functions can be passed as template parameters (so they can be conveniently
          passed to STL algorithms, etc).
        </li>
<li class="listitem">
          However, local functions must be defined within a declarative context (e.g.,
          at a point in the code where local variables can be declared) thus they
          cannot be defined within an expression.
        </li>
</ul></div>
<p>
      In addition to local functions, this library also supports the following features:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          <span class="emphasis"><em>Local blocks</em></span> which define blocks of code that bind
          variables from the enclosing scope. Local blocks allow programmers to bind
          variables as constants (<span class="emphasis"><em>constant binding</em></span>) so to prevent
          local chunks of code from modifying selected variables.
        </li>
<li class="listitem">
          <span class="emphasis"><em>Local exits</em></span> which define blocks of code that are executed
          when the enclosing scope is exited (again with support for constant binding
          and binding of the object <code class="computeroutput"><span class="keyword">this</span></code>).
        </li>
</ul></div>
<a name="boost_local.Introduction.two_syntaxes"></a><h6>
<a name="id810200"></a>
      <a class="link" href="index.html#boost_local.Introduction.two_syntaxes">Two Syntaxes</a>
    </h6>
<p>
      This library uses macros to declare the local functions, local blocks, and
      local exits. The library macros support two different syntaxes:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          The <span class="emphasis"><em>sequencing macro syntax</em></span> is fully compliant with
          the ISO C++ standard and supported on all C++ compilers. This syntax requires
          to wrap the local function parameters and bound variables between round
          parenthesis <code class="computeroutput"><span class="special">()</span></code>.
        </li>
<li class="listitem">
          The <span class="emphasis"><em>variadic macro synstax</em></span> is available only on C++
          compilers that support <a href="http://en.wikipedia.org/wiki/Variadic_macro" target="_top">variadic
          macros</a>. <sup>[<a name="id852604" href="#ftn.id852604" class="footnote">1</a>]</sup> This syntax allow to use commas <code class="computeroutput"><span class="special">,</span></code>
          to separate macro parameters therefore resembling the usual C++ syntax
          for function parameter declaration.
        </li>
</ul></div>
<p>
      The same library macros accept both syntaxes on compilers that support variadic
      macros and only the sequencing macro syntax on compilers that do not support
      variadic macros. The use of the variadic macro syntax might lead to more readable
      code however it should only be used when programmers know that their code will
      be compiled with variadic macros support to avoid portability issues. Most
      of the examples presented in this documentation provide a side-by-side comparison
      of both syntaxes.
    </p>
<a name="boost_local.Introduction.an_example"></a><h6>
<a name="id852666"></a>
      <a class="link" href="index.html#boost_local.Introduction.an_example">An Example</a>
    </h6>
<p>
      In the following example, a local function is passed to the STL <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">for_each</span></code>
      algorithm to add together the values of an array (variables in scope are bound
      to the local function by both constant value and non-constant reference). A
      local exit is used to automatically release the array's memory when the enclosing
      function exits. A local block is used to assert the correct final value of
      the summation in a constant-correct context (therefore preventing the assertion
      from mistakenly changing any of the variables in scope). See the <a class="link" href="boost_local/Tutorial.html" title="Tutorial">Tutorial</a>
      section for more details.
    </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
              <p>
                Notes
              </p>
            </th>
<th>
              <p>
                Variadic Macro Syntax (C99 and later compilers)
              </p>
            </th>
<th>
              <p>
                Sequencing Macro Syntax (all C++ compilers)
              </p>
            </th>
</tr></thead>
<tbody><tr>
<td>
              <p>
                
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"> <span class="number">1.</span>
 
 
 
 
 
 
 
 
 
 
 
 <span class="number">2.</span>
 <span class="number">3.</span>
 <span class="number">4.</span>
 
 <span class="number">5.</span>
 <span class="number">6.</span>
 
 
 
 <span class="number">7.</span>
 <span class="number">8.</span>
 
 <span class="number">9.</span>
 
 
<span class="number">10.</span>
 
<span class="number">11.</span>
<span class="number">12.</span>
 
<span class="number">13.</span>
 
 
 
</pre>
<p>
              </p>
            </td>
<td>
              <p>
                
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">block</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">exit</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">algorithm</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">double</span> <span class="identifier">sum</span> <span class="special">=</span> <span class="number">0.0</span><span class="special">;</span>
    <span class="keyword">int</span> <span class="identifier">factor</span> <span class="special">=</span> <span class="number">10</span><span class="special">;</span>

    <span class="keyword">void</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span><span class="keyword">double</span> <span class="identifier">num</span><span class="special">,</span>
            <span class="keyword">const</span> <span class="identifier">bind</span> <span class="identifier">factor</span><span class="special">,</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">{</span>
        <span class="identifier">sum</span> <span class="special">+=</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="identifier">num</span><span class="special">;</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Summed: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">sum</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>
    <span class="identifier">add</span><span class="special">(</span><span class="number">100.0</span><span class="special">);</span>

    <span class="identifier">size_t</span> <span class="identifier">size</span> <span class="special">=</span> <span class="number">2</span><span class="special">;</span>
    <span class="keyword">double</span><span class="special">*</span> <span class="identifier">nums</span> <span class="special">=</span> <span class="keyword">new</span> <span class="keyword">double</span><span class="special">[</span><span class="identifier">size</span><span class="special">];</span>
    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">size</span><span class="special">,</span> <span class="identifier">bind</span> <span class="identifier">nums</span><span class="special">)</span> <span class="special">{</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">size</span> <span class="special">&amp;&amp;</span> <span class="identifier">nums</span><span class="special">)</span> <span class="keyword">delete</span><span class="special">[]</span> <span class="identifier">nums</span><span class="special">;</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Freed array: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">nums</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>

    <span class="identifier">nums</span><span class="special">[</span><span class="number">0</span><span class="special">]</span> <span class="special">=</span> <span class="number">90.5</span><span class="special">;</span> <span class="identifier">nums</span><span class="special">[</span><span class="number">1</span><span class="special">]</span> <span class="special">=</span> <span class="number">7.0</span><span class="special">;</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">for_each</span><span class="special">(</span><span class="identifier">nums</span><span class="special">,</span> <span class="identifier">nums</span> <span class="special">+</span> <span class="identifier">size</span><span class="special">,</span> <span class="identifier">add</span><span class="special">);</span> <span class="comment">// `add` as template parameter
</span>
    <span class="identifier">BOOST_LOCAL_BLOCK</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">{</span>
        <span class="identifier">assert</span><span class="special">(</span><span class="identifier">sum</span> <span class="special">==</span> <span class="number">1975.0</span><span class="special">);</span> <span class="comment">// so far `sum` is 10*100+10*90.5+10*7=1975
</span>        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Asserted summation: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">sum</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_BLOCK_END</span>
    
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
              </p>
            </td>
<td>
              <p>
                
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">function</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">block</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">local</span><span class="special">/</span><span class="identifier">exit</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">algorithm</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cassert</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">double</span> <span class="identifier">sum</span> <span class="special">=</span> <span class="number">0.0</span><span class="special">;</span>
    <span class="keyword">int</span> <span class="identifier">factor</span> <span class="special">=</span> <span class="number">10</span><span class="special">;</span>

    <span class="keyword">void</span> <span class="identifier">BOOST_LOCAL_FUNCTION_PARAMS</span><span class="special">(</span> <span class="special">(</span><span class="keyword">double</span> <span class="identifier">num</span><span class="special">)</span>
            <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span> <span class="identifier">factor</span><span class="special">)</span> <span class="special">(</span><span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="identifier">sum</span> <span class="special">+=</span> <span class="identifier">factor</span> <span class="special">*</span> <span class="identifier">num</span><span class="special">;</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Summed: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">sum</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_FUNCTION_NAME</span><span class="special">(</span><span class="identifier">add</span><span class="special">)</span>
    <span class="identifier">add</span><span class="special">(</span><span class="number">100.0</span><span class="special">);</span>

    <span class="identifier">size_t</span> <span class="identifier">size</span> <span class="special">=</span> <span class="number">2</span><span class="special">;</span>
    <span class="keyword">double</span><span class="special">*</span> <span class="identifier">nums</span> <span class="special">=</span> <span class="keyword">new</span> <span class="keyword">double</span><span class="special">[</span><span class="identifier">size</span><span class="special">];</span>
    <span class="identifier">BOOST_LOCAL_EXIT</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">size</span><span class="special">)</span> <span class="special">(</span><span class="identifier">bind</span> <span class="identifier">nums</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">size</span> <span class="special">&amp;&amp;</span> <span class="identifier">nums</span><span class="special">)</span> <span class="keyword">delete</span><span class="special">[]</span> <span class="identifier">nums</span><span class="special">;</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Freed array: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">nums</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_EXIT_END</span>

    <span class="identifier">nums</span><span class="special">[</span><span class="number">0</span><span class="special">]</span> <span class="special">=</span> <span class="number">90.5</span><span class="special">;</span> <span class="identifier">nums</span><span class="special">[</span><span class="number">1</span><span class="special">]</span> <span class="special">=</span> <span class="number">7.0</span><span class="special">;</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">for_each</span><span class="special">(</span><span class="identifier">nums</span><span class="special">,</span> <span class="identifier">nums</span> <span class="special">+</span> <span class="identifier">size</span><span class="special">,</span> <span class="identifier">add</span><span class="special">);</span> <span class="comment">// `add` as template parameter
</span>
    <span class="identifier">BOOST_LOCAL_BLOCK</span><span class="special">(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">bind</span><span class="special">&amp;</span> <span class="identifier">sum</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="identifier">assert</span><span class="special">(</span><span class="identifier">sum</span> <span class="special">==</span> <span class="number">1975.0</span><span class="special">);</span> <span class="comment">// so far `sum` is 10*100+10*90.5+10*7=1975
</span>        <span class="identifier">std</span><span class="special">::</span><span class="identifier">clog</span> <span class="special">&lt;&lt;</span> <span class="string">"Asserted summation: "</span> <span class="special">&lt;&lt;</span> <span class="identifier">sum</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">}</span> <span class="identifier">BOOST_LOCAL_BLOCK_END</span>
    
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
              </p>
            </td>
</tr></tbody>
</table></div>
<p>
      Notes:
    </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
          Include the header files for this library local functions, local blocks,
          and local exits.
        </li>
<li class="listitem">
          The <span class="bold"><strong>local function</strong></span> parameter macro takes
          a <a href="http://www.boost.org/doc/libs/release/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
          sequence of tokens listing each parameter type and name wrapped within
          round parenthesis <code class="literal">(<span class="emphasis"><em>parameter-type parameter-name</em></span>)<span class="emphasis"><em>...</em></span></code>
          (default parameter values can also be specified using a special syntax,
          see the <a class="link" href="boost_local/Tutorial.html" title="Tutorial">Tutorial</a> section).
          On C99 and later preprocessors which support variadic macros, the same
          parameter macro also allows to specify the parameters separated by commas
          instead that wrapped within parenthesis <code class="literal"><span class="emphasis"><em>parameter-type
          parameter-name</em></span>,<span class="emphasis"><em>...</em></span></code> so to support
          a syntax similar to the usual C++ syntax for function parameter lists.
          The local function result type is specified just before the parameter macro.
        </li>
<li class="listitem">
          This library macros introduce the special "keyword" <code class="computeroutput"><span class="identifier">bind</span></code> which can be used instead of the
          parameter type to bind variables in scope. Variables can be bound by value,
          by reference, by constant value, and by constant reference. In addition,
          the object <code class="computeroutput"><span class="keyword">this</span></code> can be bound
          (but never by reference) from within a non-static member function (see
          the <a class="link" href="boost_local/Tutorial.html" title="Tutorial">Tutorial</a> section). For
          example, the variable <code class="computeroutput"><span class="identifier">factor</span></code>
          is bound by constant value so it cannot be mistakenly modified by the local
          function body. The variable <code class="computeroutput"><span class="identifier">sum</span></code>
          is instead bound by non-constant reference because the local function needs
          to change its value to report the summation result to the enclosing scope.
        </li>
<li class="listitem">
          The local function body is programmed outside the macros with the usual
          C++ syntax. Eventual compiler error messages and line numbers retain their
          usual meaning. Exceptions specifications can be programmed outside the
          macro and just before the body code block <code class="computeroutput"><span class="special">{...}</span></code>
          as usual. Finally, within the local function body the type of a bound variable
          can be accessed using <code class="literal"><code class="computeroutput"><a class="link" href="BOOST_LOCAL_TYPEOF.html" title="Macro BOOST_LOCAL_TYPEOF">BOOST_LOCAL_TYPEOF</a></code>(<span class="emphasis"><em>variable-name</em></span>)</code>.
          (See the <a class="link" href="boost_local/Tutorial.html" title="Tutorial">Tutorial</a> section.)
        </li>
<li class="listitem">
          The macro ending the local function definition specifies the local function
          name. No semicolon <code class="computeroutput"><span class="special">;</span></code> is required
          after the ending macro.
        </li>
<li class="listitem">
          The local function macros declare a functor object local to the enclosing
          scope named <code class="computeroutput"><span class="identifier">add</span></code>. The functor
          <code class="computeroutput"><span class="identifier">add</span></code> has <code class="computeroutput"><span class="keyword">void</span></code>
          result type, it can be called by specifying one parameter of type <code class="computeroutput"><span class="keyword">double</span></code>, and it has access to the variables
          in scope <code class="computeroutput"><span class="identifier">factor</span></code> (by constant
          value) and <code class="computeroutput"><span class="identifier">sum</span></code> (by reference).
        </li>
<li class="listitem">
          The <span class="bold"><strong>local exit</strong></span> declaration macro only
          specifies the variables in scope to bind (by reference or value and eventually
          as constants). Exceptions specifications can be programmed outside the
          macro and just before the body code block <code class="computeroutput"><span class="special">{...}</span></code>
          as usual (see the <a class="link" href="boost_local/Tutorial.html" title="Tutorial">Tutorial</a>
          section).
        </li>
<li class="listitem">
          The local exit code will be automatically executed when the enclosing scope
          is exited.
        </li>
<li class="listitem">
          Local exits are anonymous so their ending macro takes no argument. No semicolon
          <code class="computeroutput"><span class="special">;</span></code> is required after the ending
          macro.
        </li>
<li class="listitem">
          The local function <code class="computeroutput"><span class="identifier">add</span></code>
          can also be passed as a template parameter (for example, to the STL <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">for_each</span></code> algorithm).
        </li>
<li class="listitem">
          The <span class="bold"><strong>local block</strong></span> declaration macro only
          specifies the variables in scope to bind (by reference or value and eventually
          as constants).
        </li>
<li class="listitem">
          The local block code is executed "in place" where it is programmed
          like a usual C++ block of code <code class="computeroutput"><span class="special">{</span>
          <span class="special">...</span> <span class="special">}</span></code>.
          In this example, the compiler will correctly generate an error if the assignment
          operator <code class="computeroutput"><span class="special">=</span></code> is mistakenly used
          instead of the equality operator <code class="computeroutput"><span class="special">==</span></code>
          because the variable <code class="computeroutput"><span class="identifier">sum</span></code>
          is bound by constant reference so it cannot be modified.
        </li>
<li class="listitem">
          Local blocks are anonymous so their ending macro takes no argument. No
          semicolon <code class="computeroutput"><span class="special">;</span></code> is required after
          the ending macro.
        </li>
</ol></div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div class="footnote"><p><sup>[<a id="ftn.id852604" href="#id852604" class="para">1</a>] </sup>
            Variadic macros were first introduced by the C99 preprocessor (via the
            use of the special macro symbols ellipses <code class="computeroutput"><span class="special">...</span></code>
            and <code class="computeroutput"><span class="identifier">__VA_ARGS__</span></code>). They
            are now supported on essentially all modern C++ compilers (GCC, MVSC,
            etc).
          </p></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"><p><small>Last revised: March 21, 2011 at 00:39:37 GMT</small></p></td>
<td align="right"><div class="copyright-footer"></div></td>
</tr></table>
<hr>
<div class="spirit-nav"><a accesskey="n" href="boost_local/Getting_Started.html"><img src="../../../../doc/src/images/next.png" alt="Next"></a></div>
</body>
</html>
