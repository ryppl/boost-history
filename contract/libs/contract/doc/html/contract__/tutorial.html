<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Tutorial</title>
<link rel="stylesheet" href="../doc/html/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="../index.html" title="Contract++ 0.3.490">
<link rel="up" href="../index.html" title="Contract++ 0.3.490">
<link rel="prev" href="getting_started.html" title="Getting Started">
<link rel="next" href="without_the_macros.html" title="Without the Macros">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr><td valign="top"></td></tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="getting_started.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="without_the_macros.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="contract__.tutorial"></a><a class="link" href="tutorial.html" title="Tutorial">Tutorial</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.contract_programming_overview">Contract
      Programming Overview</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.checking_contracts">Checking Contracts</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.contract_macros">Contract Macros</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.signature_sequence">Signature Sequence</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.function_arguments">Function Arguments</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.inheritance">Inheritance</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.operators">Operators</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.overloaded_functions">Overloaded
      Functions</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.function_templates">Function Templates</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.deferring_the_body">Deferring the
      Body</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.friends">Friends</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.structs_and_unions">Structs and Unions</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.qualifiers">Qualifiers</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.blocks_and_loops">Blocks and Loops</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.exception_specifications">Exception
      Specifications</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.commas_within_macro_parameters">Commas
      Within Macro Parameters</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.a_fully_working_example">A Fully
      Working Example</a></span></dt>
</dl></div>
<p>
      This section gives an overview of Contract Programming and explains how this
      library can be used to write contracts. At the end of the section there is
      a fully working example that can be compiled and executed.
    </p>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.contract_programming_overview"></a><a class="link" href="tutorial.html#contract__.tutorial.contract_programming_overview" title="Contract Programming Overview">Contract
      Programming Overview</a>
</h3></div></div></div>
<p>
        Contract Programming is characterized at least by the following assertion
        mechanisms (see <a class="link" href="bibliography.html" title="Bibliography">[Meyer1997]</a>,
        <a class="link" href="bibliography.html" title="Bibliography">[Ottosen2004]</a>, or <a class="link" href="bibliography.html" title="Bibliography">[Crowl2006]</a>):
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            It is possible to describe <span class="bold"><strong>class invariants</strong></span>.
            These are logical conditions that programmers expect to be true after
            the constructor has been executed successfully, before and after the
            execution of every non-static member function with a contract, and before
            the destructor is executed (e.g., class invariants can define a valid
            state for all objects of a class). It is possible to describe <span class="bold"><strong>static class invariants</strong></span> also which are expected
            to be true before and after the execution of any member function with
            a contract (including static member functions, constructor entry, and
            destructor exit).
          </li>
<li class="listitem">
            It is possible to describe function <span class="bold"><strong>preconditions</strong></span>.
            These are logical conditions that programmers except to be true when
            the function is called (e.g., to check constraints on input function
            arguments).
          </li>
<li class="listitem">
            It is possible to describe function <span class="bold"><strong>postconditions</strong></span>.
            These are logical conditions that programmers expect to be true when
            the function has ended normally (e.g., to check the result and any side
            effect that a function might have).
          </li>
<li class="listitem">
            It is possible to formalize the notion of overriding a virtual member
            function via <span class="bold"><strong>subcontracting</strong></span>. Subcontracting
            can be justified by substitution principles and it consists of the following
            rules that the overriding function must obey:
            <div class="orderedlist"><ol class="orderedlist" type="a">
<li class="listitem">
                  Preconditions cannot be strengthen.
                </li>
<li class="listitem">
                  Postconditions cannot be weaken.
                </li>
<li class="listitem">
                  Class invariants cannot be weaken.
                </li>
</ol></div>
          </li>
<li class="listitem">
            It is possible to describe <span class="bold"><strong>block invariants</strong></span>.
            These are logical conditions that programmes except to be true every
            time the execution reaches the point where the condition is asserted.
            When used within a loop (i.e., a block of code that can be executed in
            iteration), block invariants function like <span class="emphasis"><em>loop invariants</em></span>
            asserting conditions that are excepted to be true for every loop iteration.
          </li>
<li class="listitem">
            It is possible to describe a <span class="bold"><strong>loop variant</strong></span>.
            This a positive integer expression with a value that is expected to decrease
            at every subsequent loop iteration.
          </li>
</ol></div>
<p>
        Based on these definitions of invariants, preconditions, postconditions,
        and subcontracting it is possible to specify the semantics of the invocation
        of a function for which a contract has been specified.
      </p>
<a name="contract__.tutorial.contract_programming_overview.non_member_function_call_semantics"></a><h6>
<a name="contract__.tutorial.contract_programming_overview.non_member_function_call_semantics-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.contract_programming_overview.non_member_function_call_semantics">Non-Member
        Function Call Semantics</a>
      </h6>
<p>
        A non-member function call should execute the following steps:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            Check preconditions.
          </li>
<li class="listitem">
            Execute function body.
          </li>
<li class="listitem">
            Check postconditions.
          </li>
</ol></div>
<a name="contract__.tutorial.contract_programming_overview.member_function_call_semantics"></a><h6>
<a name="contract__.tutorial.contract_programming_overview.member_function_call_semantics-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.contract_programming_overview.member_function_call_semantics">Member
        Function Call Semantics</a>
      </h6>
<p>
        A member function call should execute the following steps:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            Check static class invariants.
          </li>
<li class="listitem">
            Check non-static class invariants <span class="emphasis"><em>AND</em></span>, when subcontracting,
            check the base class invariants (for non-static member functions only
            <sup>[<a name="id866548" href="#ftn.id866548" class="footnote">2</a>]</sup>).
          </li>
<li class="listitem">
            Check preconditions <span class="emphasis"><em>OR</em></span>, when subcontracting, check
            the overridden function preconditions.
          </li>
<li class="listitem">
            Execute function body.
          </li>
<li class="listitem">
            Check static class invariants (even if body throws an exception).
          </li>
<li class="listitem">
            Check non-static class invariants <span class="emphasis"><em>AND</em></span>, when subcontracting,
            check base class invariants (for non-static member functions only plus
            checked even if body throws an exception).
          </li>
<li class="listitem">
            Check postconditions <span class="emphasis"><em>AND</em></span>, when subcontracting, check
            overridden function postconditions (only if body did not throw an exception).
          </li>
</ol></div>
<p>
        Where <span class="emphasis"><em>AND</em></span> and <span class="emphasis"><em>OR</em></span> are the logical
        "and" and "or" operators evaluated in short-circuit (i.e.,
        A <span class="emphasis"><em>AND</em></span> B evaluates B only if A is evaluated to be true,
        A <span class="emphasis"><em>OR</em></span> B evaluates B only if A is evaluated to be false).
      </p>
<p>
        When a member function overrides more than one virtual function due to multiple
        inheritance:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            Class invariants are checked in <span class="emphasis"><em>AND</em></span> with the invariants
            of <span class="emphasis"><em>all</em></span> the base classes (following the inheritance
            order).
          </li>
<li class="listitem">
            Preconditions are checked in <span class="emphasis"><em>OR</em></span> with the preconditions
            of <span class="emphasis"><em>all</em></span> the overridden functions (following the inheritance
            order).
          </li>
<li class="listitem">
            Postconditions are checked in <span class="emphasis"><em>AND</em></span> with the postconditions
            of <span class="emphasis"><em>all</em></span> the overridden functions (following the inheritance
            order).
          </li>
</ul></div>
<a name="contract__.tutorial.contract_programming_overview.constructor_call_semantics"></a><h6>
<a name="contract__.tutorial.contract_programming_overview.constructor_call_semantics-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.contract_programming_overview.constructor_call_semantics">Constructor
        Call Semantics</a>
      </h6>
<p>
        A constructor call should execute the following steps:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            Initialize member variables via the constructor member initialization
            list (if such a list is specified).
          </li>
<li class="listitem">
            Check static class invariants (but not the non-static class invariants).
          </li>
<li class="listitem">
            Check preconditions.
          </li>
<li class="listitem">
            Execute constructor body.
          </li>
<li class="listitem">
            Check static class invariants (even if body throws an exception).
          </li>
<li class="listitem">
            Check class invariants (even if body throws an exception).
          </li>
<li class="listitem">
            Check postconditions (only if body did not throw an exception).
          </li>
</ol></div>
<p>
        Before constructor body execution, there is no object therefore:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            Non-static class invariants do not have to hold true and they are not
            checked at constructor entry.
          </li>
<li class="listitem">
            Preconditions cannot access the object.
          </li>
<li class="listitem">
            Postconditions cannot access the old object value (as it was before body
            execution).
          </li>
</ul></div>
<a name="contract__.tutorial.contract_programming_overview.destructor_call_semantics"></a><h6>
<a name="contract__.tutorial.contract_programming_overview.destructor_call_semantics-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.contract_programming_overview.destructor_call_semantics">Destructor
        Call Semantics</a>
      </h6>
<p>
        A destructor call should execute the following steps:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            Check static class invariants.
          </li>
<li class="listitem">
            Check class invariants.
          </li>
<li class="listitem">
            Execute destructor body.
          </li>
<li class="listitem">
            Check static class invariants (but not the non-static class invariants
            plus checked even if body throws an exception <sup>[<a name="id866910" href="#ftn.id866910" class="footnote">3</a>]</sup>).
          </li>
</ol></div>
<p>
        Note that:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            Destructors have no arguments so they have no preconditions.
          </li>
<li class="listitem">
            After destructor body execution, there is no object anymore (because
            it has been destroyed) so non-static class invariants do not have to
            hold true and they are not checked at destructor exit.
          </li>
<li class="listitem">
            Destructors have no postconditions as there is no function argument and
            after body execution there is no object.
          </li>
</ul></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.checking_contracts"></a><a class="link" href="tutorial.html#contract__.tutorial.checking_contracts" title="Checking Contracts">Checking Contracts</a>
</h3></div></div></div>
<p>
        After programmers specify contracts, this library provides a mechanism to
        automatically check if class invariants, preconditions, postconditions, block
        invariants, and loop variants hold true at run-time or not.
      </p>
<p>
        If a class invariant, precondition, postcondition, block invariant, or loop
        variant asserted via <code class="computeroutput"><a href="../CONTRACT_ASSERT.html" target="_top">CONTRACT_ASSERT</a><span class="special">()</span></code>, <code class="computeroutput"><a href="../CONTRACT_ASSERT_BLOCK_INVARIANT.html" target="_top">CONTRACT_ASSERT_BLOCK_INVARIANT</a><span class="special">()</span></code>, or <code class="computeroutput"><a href="../CONTRACT_ASSERT_LOOP_VARIANT.html" target="_top">CONTRACT_ASSERT_LOOP_VARIANT</a><span class="special">()</span></code> is checked to be false, the library invokes
        the <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/class_invariant_failed.html" target="_top">class_invariant_failed</a><span class="special">()</span></code>, <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/precondition_failed.html" target="_top">precondition_failed</a><span class="special">()</span></code>, <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/postcondition_failed.html" target="_top">postcondition_failed</a><span class="special">()</span></code>, <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/block_invariant_failed.html" target="_top">block_invariant_failed</a><span class="special">()</span></code> (for both block invariant and loop variant
        failures) function respectively. These functions invoke <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">terminate</span><span class="special">()</span></code> by default but programmers can redefine
        them to take a different action using <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/set_class_invariant_failed.html" target="_top">set_class_invariant_failed</a><span class="special">()</span></code>, <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/set_precondition_failed.html" target="_top">set_precondition_failed</a><span class="special">()</span></code>, <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/set_postcondition_failed.html" target="_top">set_postcondition_failed</a><span class="special">()</span></code>, and <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/set_block_invariant_failed.html" target="_top">set_block_invariant_failed</a><span class="special">()</span></code>.
      </p>
<p>
        This mechanism is similarly to the one of C++ <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">set_terminate</span><span class="special">()</span></code> (see <a class="link" href="throw_on_failure.html" title="Annex: Throw on Failure">Throw
        on Failure</a> for an example).
      </p>
<a name="contract__.tutorial.checking_contracts.constant_correctness"></a><h6>
<a name="contract__.tutorial.checking_contracts.constant_correctness-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.checking_contracts.constant_correctness">Constant-Correctness</a>
      </h6>
<p>
        Contracts are only supposed to <span class="emphasis"><em>check</em></span> the object state
        in order to ensure its compliance with the software specifications. Therefore,
        contract checking should not be allowed to modify the object state and exclusively
        "read-only" operations (or <span class="emphasis"><em>queries</em></span>) should
        be used to specify contracts.
      </p>
<p>
        This library enforces <sup>[<a name="id867338" href="#ftn.id867338" class="footnote">4</a>]</sup> this constraint at compile-time using the C++ <code class="computeroutput"><span class="keyword">const</span></code>
        qualifier. Contracts only have access to the object, function arguments,
        and return value via constant references thus only constant members can be
        accessed when checking contracts. Furthermore, pointers are passed as <code class="computeroutput"><span class="keyword">const</span> <span class="identifier">T</span><span class="special">*</span></code> so the pointed object is constants and cannot
        be changed (note that the pointer value itself is not constant, because it
        is not passed as <code class="computeroutput"><span class="keyword">const</span> <span class="identifier">T</span><span class="special">*</span> <span class="keyword">const</span></code>, and
        it could be changed by the contract but such a change will be local to the
        contract function therefore still ensuring the const-correctness of the contract).
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.contract_macros"></a><a class="link" href="tutorial.html#contract__.tutorial.contract_macros" title="Contract Macros">Contract Macros</a>
</h3></div></div></div>
<p>
        The following overview of the contract macros and their usages should be
        enough to understand the working example at the end of this section, most
        of the examples in the <a class="link" href="examples.html" title="Examples">Examples</a>
        annex, and to start writing contracts on your own. Consult the library <a href="../reference.html" target="_top">Reference</a> documentation for more information.
        <sup>[<a name="id867464" href="#ftn.id867464" class="footnote">5</a>]</sup>.
      </p>
<p>
        <span class="bold"><strong><code class="literal"><a href="../CONTRACT_INVARIANT.html" target="_top">CONTRACT_INVARIANT</a>(
        (static)({ ... }) ({ ... }) )</code></strong></span>
      </p>
<p>
        This macro is used to program class invariants. It should appear within a
        private section in the class declaration. It takes one parameter which is
        a <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
        sequence of the following elements:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            <code class="computeroutput"><span class="special">(</span><span class="keyword">static</span><span class="special">)</span> <span class="special">({</span> <span class="special">...</span> <span class="special">})</span></code>:
            The code block <code class="computeroutput"><span class="special">{</span> <span class="special">...</span>
            <span class="special">}</span></code> <sup>[<a name="id867784" href="#ftn.id867784" class="footnote">6</a>]</sup> asserting static class invariants. This is optional and it
            can be omitted.
          </li>
<li class="listitem">
            <code class="computeroutput"><span class="special">({</span> <span class="special">...</span>
            <span class="special">})</span></code>: A secondary code block <code class="computeroutput"><span class="special">{</span> <span class="special">...</span> <span class="special">}</span></code> asserting non-static class invariants.
            This is mandatory but an empty code block <code class="computeroutput"><span class="special">({})</span></code>
            can be specified if there are no class invariants (using <code class="computeroutput"><a href="../CONTRACT_INVARIANT.html" target="_top">CONTRACT_INVARIANT</a><span class="special">()</span></code>
            instead of <code class="computeroutput"><a href="../CONTRACT_INVARIANT.html" target="_top">CONTRACT_INVARIANT</a><span class="special">(</span> <span class="special">({})</span> <span class="special">)</span></code> will generate a preprocessor error).
          </li>
</ul></div>
<p>
        If contract compilation is turned off, this macro expands to nothing (and
        no contract overhead is added). Otherwise, it expands to code that checks
        the class invariants (see <a class="link" href="without_the_macros.html" title="Without the Macros">Without
        the Macros</a> for details).
      </p>
<p>
        <span class="bold"><strong><code class="literal"><a href="../CONTRACT_FUNCTION.html" target="_top">CONTRACT_FUNCTION</a>(
        <span class="emphasis"><em>signature-sequence</em></span> (precondition)({ ... }) (postcondition)(<span class="emphasis"><em>result-name</em></span>)({
        ... }) (body)({ ... }) )</code></strong></span>
      </p>
<p>
        <span class="bold"><strong><code class="literal"><a href="../CONTRACT_CONSTRUCTOR.html" target="_top">CONTRACT_CONSTRUCTOR</a>(
        <span class="emphasis"><em>signature-sequence</em></span> (precondition)({ ... }) (postcondition)({
        ... }) (body)({ ... }) )</code></strong></span>
      </p>
<p>
        These macros are used to program preconditions and postconditions for functions
        (members and non) and constructors respectively. They should appear right
        after the function and constructor declaration, and after the constructor
        members initialization list when such a list is specified. They both take
        the following parameters:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            <span class="emphasis"><em>signature-sequence</em></span>: A <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
            sequence with the function or constructor signature tokens (see subsections
            below).
          </li>
<li class="listitem">
            <code class="computeroutput"><span class="special">(</span><span class="identifier">precondition</span><span class="special">)</span> <span class="special">({</span> <span class="special">...</span> <span class="special">})</span></code>:
            An optional code block <code class="computeroutput"><span class="special">{</span> <span class="special">...</span> <span class="special">}</span></code>
            asserting the preconditions.
          </li>
<li class="listitem">
            <code class="computeroutput"><span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">(</span></code><span class="emphasis"><em>result-name</em></span><code class="computeroutput"><span class="special">)</span> <span class="special">({</span> <span class="special">...</span> <span class="special">})</span></code>:
            An optional code block <code class="computeroutput"><span class="special">{</span> <span class="special">...</span> <span class="special">}</span></code>
            asserting the postconditions. The <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>result-name</em></span><code class="computeroutput"><span class="special">)</span></code> element is only specified for non-void
            functions (so never for constructors) and it names the variable used
            to access the return value within postconditions (e.g., <code class="computeroutput"><span class="identifier">result</span></code>).
          </li>
<li class="listitem">
            <code class="computeroutput"><span class="special">(</span><span class="identifier">body</span><span class="special">)({</span> <span class="special">...</span> <span class="special">})</span></code>: A mandatory code block <code class="computeroutput"><span class="special">{</span> <span class="special">...</span> <span class="special">}</span></code> implementing the function or constructor
            body.
          </li>
</ul></div>
<p>
        If contract compilation is turned off, these macros simply expand to the
        body code block (and no contract overhead is added). Otherwise, they expand
        to code that implements the <a class="link" href="tutorial.html#contract__.tutorial.contract_programming_overview.member_function_call_semantics">Member
        Function Call Semantics</a> and <a class="link" href="tutorial.html#contract__.tutorial.contract_programming_overview.constructor_call_semantics">Constructor
        Call Semantics</a> respectively thus checking class invariants, preconditions,
        and postconditions (see <a class="link" href="without_the_macros.html" title="Without the Macros">Without
        the Macros</a> for details).
      </p>
<p>
        <span class="bold"><strong><code class="literal"><a href="../CONTRACT_DESTRUCTOR.html" target="_top">CONTRACT_DESTRUCTOR</a>(
        <span class="emphasis"><em>signature-sequence</em></span> (body)({ ... }) )</code></strong></span>
      </p>
<p>
        This macro is used to program destructor contracts. It should appear right
        after the destructor declaration. It takes the following parameters:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            <span class="emphasis"><em>signature-sequence</em></span>: The destructor signature tokens
            (see below).
          </li>
<li class="listitem">
            <code class="computeroutput"><span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span> <span class="special">...</span> <span class="special">})</span></code>:
            A mandatory code block <code class="computeroutput"><span class="special">{</span> <span class="special">...</span> <span class="special">}</span></code>
            implementing the destructor body.
          </li>
</ul></div>
<p>
        If contract compilation is turned off, this macro simply expands to the body
        code block (and no contract overhead is added). Otherwise, it expands to
        code that implements the <a class="link" href="tutorial.html#contract__.tutorial.contract_programming_overview.destructor_call_semantics">Destructor
        Call Semantics</a> checking the class invariants (see <a class="link" href="without_the_macros.html" title="Without the Macros">Without
        the Macros</a> for details).
      </p>
<p>
        <span class="bold"><strong><code class="literal"><a href="../CONTRACT_OLDOF.html" target="_top">CONTRACT_OLDOF</a>(
        variable_name )</code></strong></span>
      </p>
<p>
        This macro is used to access the old value for the variable with the specified
        name in postconditions. It takes the following parameter:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
            <code class="computeroutput"><span class="identifier">name</span></code>: The name of the
            variable. As usual, <code class="computeroutput"><span class="keyword">this</span></code>
            can be used as the variable name for the object so <code class="computeroutput"><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)</span></code> is used to access the object old value.
            Otherwise, any of the function argument variable names can be specified.
            The variable type (class or argument type) must be tagged copyable in
            the signature sequence for the variable old value to be available (see
            below). The library generates a compile-time error (containing the text
            <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><span class="identifier">noold</span></code>) if this macro is used on a variable
            name of a type which was not tagged copyable.
          </li></ul></div>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          This library does not support old values for <span class="emphasis"><em>any</em></span> expression
          that can be evaluated in postcondition as supported by Eiffel and required
          <a class="link" href="bibliography.html" title="Bibliography">[Crowl2006]</a> instead. The
          library supports old values for the object and all the function argument
          types, and this is a subset of the old values supported by Eiffel and required
          by <a class="link" href="bibliography.html" title="Bibliography">[Crowl2006]</a>. However,
          the old values supported by the library are usually enough to program the
          postconditions (e.g., all Eiffel examples from <a class="link" href="bibliography.html" title="Bibliography">[Meyer1997]</a>,
          <a class="link" href="bibliography.html" title="Bibliography">[Mitchell2002]</a>, and all
          C++ examples from <a class="link" href="bibliography.html" title="Bibliography">[Crowl2006]</a>
          were successfully programmed using just these old values, see the <a class="link" href="examples.html" title="Examples">Examples</a> section).
        </p></td></tr>
</table></div>
<p>
        The old value variable are only declared locally within postconditions therefore
        they cannot be mistakenly accessed outside the related postcondition code
        block (see <a class="link" href="without_the_macros.html" title="Without the Macros">Without the Macros</a>
        for details).
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
<p>
          If pointer types are tagged copyable, then the pointer value, and <span class="emphasis"><em>not</em></span>
          the pointed value, is copied. Therefore the old pointer value will be available
          in postconditions via <code class="computeroutput"><a href="../CONTRACT_OLDOF.html" target="_top">CONTRACT_OLDOF</a><span class="special">()</span></code> and <span class="emphasis"><em>not</em></span> the old
          pointed value. In other words, as usual, shallow copies are performed for
          pointers (unless the pointed type defines a different copy operation).
          Be careful as this might not be what you intended when using <code class="computeroutput"><a href="../CONTRACT_OLDOF.html" target="_top">CONTRACT_OLDOF</a><span class="special">()</span></code>
          on a pointer <sup>[<a name="id868670" href="#ftn.id868670" class="footnote">7</a>]</sup>.
        </p>
<p>
          The notable exception is the object <code class="computeroutput"><span class="keyword">this</span></code>
          which is passed to the contract functions by pointer but its old value
          is automatically deep copied by the library.
        </p>
</td></tr>
</table></div>
<p>
        <span class="bold"><strong><code class="literal"><a href="../CONTRACT_ASSERT.html" target="_top">CONTRACT_ASSERT</a>(
        boolean_condition )</code></strong></span>
      </p>
<p>
        This macro is used to assert conditions within the class invariant, precondition,
        and postcondition code blocks (see also <a href="../CONTRACT_ASSERT_MSG.html" target="_top">CONTRACT_ASSERT_MSG</a>()).
        It takes the following parameter:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
            <code class="computeroutput"><span class="identifier">boolean_condition</span></code>: The
            boolean condition being asserted.
          </li></ul></div>
<p>
        If contract compilation is turned off, this macro expands to nothing (and
        no contract overhead is added). Otherwise, this macro expands to code that
        triggers the invocation of <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/class_invariant_failed.html" target="_top">class_invariant_failed</a><span class="special">()</span></code>, <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/precondition_failed.html" target="_top">precondition_failed</a><span class="special">()</span></code>, or <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/postcondition_failed.html" target="_top">postcondition_failed</a><span class="special">()</span></code> in case the asserted boolean condition
        is evaluated to be false at run-time from within invariants, preconditions,
        or postconditions respectively (see <a class="link" href="without_the_macros.html" title="Without the Macros">Without
        the Macros</a> for details).
      </p>
<p>
        <span class="bold"><strong><code class="literal"><a href="../CONTRACT_ASSERT_BLOCK_INVARIANT.html" target="_top">CONTRACT_ASSERT_BLOCK_INVARIANT</a>(
        boolean_condition )</code></strong></span>
      </p>
<p>
        This macro is used to assert invariant within a generic code block (see also
        <a href="../CONTRACT_ASSERT_BLOCK_INVARIANT_MSG.html" target="_top">CONTRACT_ASSERT_BLOCK_INVARIANT_MSG</a>()).
        This macro can also be used within loops to assert loop invariants. It takes
        the following parameter:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
            <code class="computeroutput"><span class="identifier">boolean_condition</span></code>: The
            boolean condition being asserted.
          </li></ul></div>
<p>
        If contract compilation is turned off, this macro expands to nothing (and
        no contract overhead is added). Otherwise, this macro expands to code that
        triggers the invocation of <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/block_invariant_failed.html" target="_top">block_invariant_failed</a><span class="special">()</span></code> in case the asserted boolean condition
        is evaluated to be false at run-time (see <a class="link" href="without_the_macros.html" title="Without the Macros">Without
        the Macros</a> for details).
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          This macro is similar to the C <code class="computeroutput"><span class="identifier">assert</span><span class="special">()</span></code> macro as it can be used at any point
          within a block of code. However, in case the asserted condition either
          throws an exception or it is evaluated to be <code class="computeroutput"><span class="keyword">false</span></code>,
          this macro invokes <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/block_invariant_failed.html" target="_top">block_invariant_failed</a><span class="special">()</span></code> instead of calling <code class="computeroutput"><span class="identifier">abort</span><span class="special">()</span></code>.
        </p></td></tr>
</table></div>
<p>
        <span class="bold"><strong><code class="literal"><a href="../CONTRACT_ASSERT_LOOP_VARIANT.html" target="_top">CONTRACT_ASSERT_LOOP_VARIANT</a>(
        integer_expression )</code></strong></span>
      </p>
<p>
        <span class="bold"><strong><code class="literal"><a href="../CONTRACT_INIT_LOOP_VARIANT.html" target="_top">CONTRACT_INIT_LOOP_VARIANT</a></code></strong></span>
      </p>
<p>
        This macro is used to assert loop variants (see also <a href="../CONTRACT_ASSERT_LOOP_VARIANT_MSG.html" target="_top">CONTRACT_ASSERT_LOOP_VARIANT_MSG</a>()).
        It must be used <span class="emphasis"><em>after</em></span> <code class="computeroutput"><a href="../CONTRACT_INIT_LOOP_VARIANT.html" target="_top">CONTRACT_INIT_LOOP_VARIANT</a></code>
        has been called once within the same code block scope (see below).
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
            <code class="computeroutput"><span class="identifier">integer_expression</span></code>: An
            integer expression which is evaluated at each loop iteration as the loop
            variant. It must be always positive (not negative and not zero) and it
            must strictly decrease at each subsequent loop iteration (of <code class="computeroutput"><span class="number">1</span></code> or more).
          </li></ul></div>
<p>
        If contract compilation is turned off, this macro expands to nothing (and
        no contract overhead is added). Otherwise, this macro expands to code that
        triggers the invocation of <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/block_invariant_failed.html" target="_top">block_invariant_failed</a><span class="special">()</span></code> at run-time in case the specified variant
        expression is either not positive or it does not decrease from one loop iteration
        to the next (see <a class="link" href="without_the_macros.html" title="Without the Macros">Without the
        Macros</a> for details).
      </p>
<a name="contract__.tutorial.contract_macros.step_by_step_example"></a><h6>
<a name="contract__.tutorial.contract_macros.step_by_step_example-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.contract_macros.step_by_step_example">Step-by-Step
        Example</a>
      </h6>
<p>
        Let's assume we want to write a <code class="computeroutput"><span class="identifier">myvector</span></code>
        class template that wraps the C++ STL vector template <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span></code>
        adding contracts to it. Here we show, step-by-step, how to program a contract
        for the <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code>
        function.
      </p>
<p>
        <span class="bold"><strong>Step 1)</strong></span> First, we implement <code class="computeroutput"><span class="identifier">myvector</span><span class="special">::</span><span class="identifier">push_back</span><span class="special">()</span></code>
        to call <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">::</span><span class="identifier">push_back</span><span class="special">()</span></code>
        and we can sketch the contract using comments.
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span> <span class="special">{</span>
    <span class="comment">// Invariant: (size() == 0) == empty()</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="comment">// Precondition: size() &lt; max_size()</span>
    <span class="comment">// Postcondition: size() == (oldof size() + 1)</span>
    <span class="keyword">void</span> <span class="identifier">push_back</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span><span class="special">)</span> <span class="special">{</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">element</span><span class="special">);</span> <span class="special">}</span>

    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>        
<span class="special">};</span>
</pre>
<p>
        Where "<code class="computeroutput"><span class="identifier">oldof</span> <span class="identifier">size</span><span class="special">()</span></code>" indicates the value <code class="computeroutput"><span class="identifier">size</span><span class="special">()</span></code>
        has before the <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code> function is executed.
      </p>
<p>
        To keep this example simple, we intentionally did not write the full contract
        but we only wrote one invariant, one precondition, and one postcondition
        (see the STL Vector <a class="link" href="examples.html" title="Examples">Example</a> for
        the complete <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code>
        contract). These contract conditions specify the followings:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            The class invariant asserts that the vector is empty if and only if its
            size is zero.
          </li>
<li class="listitem">
            The precondition asserts that the vector size must be smaller than the
            maximum size when <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code> is called (so there is available space
            to add one extra vector element).
          </li>
<li class="listitem">
            The postcondition asserts that the vector size must increase by 1 after
            <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code>
            has been executed (to reflect the newly added vector element).
          </li>
</ol></div>
<p>
        <span class="bold"><strong>Step 2)</strong></span> The library provides the <code class="computeroutput"><a href="../CONTRACT_FUNCTION.html" target="_top">CONTRACT_FUNCTION</a><span class="special">()</span></code>
        macro to write member function contracts. This macro must be used <span class="emphasis"><em>right
        after</em></span> the <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code> function declaration. The <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code>
        function definition <code class="computeroutput"><span class="special">{</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">();</span> <span class="special">}</span></code> is moved
        within the macro becoming the last element of the <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
        sequence passed as the macro parameter:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span> <span class="special">{</span>
    <span class="comment">// Invariant: (size() == 0) == empty()</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="comment">// Precondition: size() &lt; max_size()</span>
    <span class="comment">// Postcondition: size() == (old size()) + 1</span>
    <span class="keyword">void</span> <span class="identifier">push_back</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span><span class="special">)</span>
    <span class="bold"><strong>CONTRACT_FUNCTION</strong></span><span class="special">(</span> <span class="emphasis"><em>signature-sequence</em></span>
    <span class="emphasis"><em>precondition-sequence</em></span>
    <span class="emphasis"><em>postcondition-sequence</em></span>
    <span class="bold"><strong>(body) ({
        vector_.push_back(element);
    })</strong></span> ) <span class="comment">// No need for ";" after the macro closing parenthesis ")".</span>

    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>        
<span class="special">};</span>
</pre>
<p>
        There is no need for "<code class="computeroutput"><span class="special">;</span></code>"
        after the macro closing parenthesis "<code class="computeroutput"><span class="special">)</span></code>".
      </p>
<p>
        <span class="bold"><strong>Step 3)</strong></span> We now program the postconditions
        using <code class="computeroutput"><a href="../CONTRACT_ASSERT.html" target="_top">CONTRACT_ASSERT</a><span class="special">()</span></code> inside a code block <code class="computeroutput"><span class="special">{</span>
        <span class="special">...</span> <span class="special">}</span></code>
        specifying the <span class="emphasis"><em>postcondition-sequence</em></span> elements:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span> <span class="special">{</span>
    <span class="comment">// Invariant: (size() == 0) == empty()</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="comment">// Precondition: size() &lt; max_size()</span>
    <span class="keyword">void</span> <span class="identifier">push_back</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span><span class="special">)</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="emphasis"><em>signature-sequence</em></span>
    <span class="emphasis"><em>precondition-sequence</em></span>
    <span class="bold"><strong>(postcondition) ({
        CONTRACT_ASSERT( size() == (CONTRACT_OLDOF(this)-&gt;size() + 1) );
    })</strong></span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">element</span><span class="special">);</span>
    <span class="special">})</span> <span class="special">)</span>

    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>        
<span class="special">};</span>
</pre>
<p>
        Note how <code class="computeroutput"><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)</span></code> is used
        to access the old object value as it was before body execution.
      </p>
<p>
        <span class="bold"><strong>Step 4)</strong></span> Similarly, we program the preconditions
        in a code block <code class="computeroutput"><span class="special">{</span> <span class="special">...</span>
        <span class="special">}</span></code> specifying the <span class="emphasis"><em>precondition-sequence</em></span>
        elements:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span> <span class="special">{</span>
    <span class="comment">// Invariant: (size() == 0) == empty()</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">void</span> <span class="identifier">push_back</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span><span class="special">)</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="emphasis"><em>signature-sequence</em></span>
    <span class="bold"><strong>(precondition) ({
        CONTRACT_ASSERT( size() &lt; max_size() );
    })</strong></span>
    <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)-&gt;</span><span class="identifier">size</span><span class="special">()</span> <span class="special">+</span> <span class="number">1</span><span class="special">)</span> <span class="special">);</span>

    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">element</span><span class="special">);</span>
    <span class="special">})</span> <span class="special">)</span>

    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>        
<span class="special">};</span>
</pre>
<p>
        <span class="bold"><strong>Step 5)</strong></span> The <span class="emphasis"><em>signature-sequence</em></span>
        elements are discussed separately (see below) and for now we will leave them
        unresolved.
      </p>
<p>
        <span class="bold"><strong>Step 6)</strong></span> Similarly to what we did with for
        preconditions and postconditions, we program the class invariants in a code
        block <code class="computeroutput"><span class="special">{</span> <span class="special">...</span>
        <span class="special">}</span></code> specifying sequence elements passed
        to the <code class="computeroutput"><a href="../CONTRACT_INVARIANT.html" target="_top">CONTRACT_INVARIANT</a><span class="special">()</span></code> macro:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span> <span class="special">{</span>
    
    <span class="bold"><strong>CONTRACT_INVARIANT( ({
        CONTRACT_ASSERT( (size() == 0) == empty() );
    }) )</strong></span> <span class="comment">// Again, no need for ";" after the macro closing parenthesis ")".</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">void</span> <span class="identifier">push_back</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span><span class="special">)</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="emphasis"><em>signature-sequence</em></span>
    <span class="special">(</span><span class="identifier">precondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">&lt;</span> <span class="identifier">max_size</span><span class="special">()</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)-&gt;</span><span class="identifier">size</span><span class="special">()</span> <span class="special">+</span> <span class="number">1</span><span class="special">)</span> <span class="special">);</span>

    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">element</span><span class="special">);</span>
    <span class="special">})</span> <span class="special">)</span>

    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>        
<span class="special">};</span>
</pre>
<p>
        Again, there is no need for "<code class="computeroutput"><span class="special">;</span></code>"
        after the macro closing parenthesis "<code class="computeroutput"><span class="special">)</span></code>".
      </p>
<p>
        <span class="bold"><strong>Step 7)</strong></span> The same step-by-step process can
        be applied to understand the usage of <code class="computeroutput"><a href="../CONTRACT_CONSTRUCTOR.html" target="_top">CONTRACT_CONSTRUCTOR</a><span class="special">()</span></code> and <code class="computeroutput"><a href="../CONTRACT_DESTRUCTOR.html" target="_top">CONTRACT_DESTRUCTOR</a><span class="special">()</span></code> (see the example at the very end of this
        section).
      </p>
<a name="contract__.tutorial.contract_macros.contract_code_blocks"></a><h6>
<a name="contract__.tutorial.contract_macros.contract_code_blocks-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.contract_macros.contract_code_blocks">Contract
        Code Blocks</a>
      </h6>
<p>
        This library allows for arbitrary constant-correct code within the class
        invariant, precondition, and postcondition code blocks <code class="computeroutput"><span class="special">({</span>
        <span class="special">...</span> <span class="special">})</span></code>.
      </p>
<p>
        In other words, the class invariant, precondition, and postcondition code
        blocks can contain any legal C++ code and they can access any constant class
        member (private, protected, or public). However, writing complex code in
        the contracts will increase the probability of introducing bugs in the contracts
        themselves so it is better to limit the contract code to a simple list of
        assertions with occasional if-statements to guard them. Furthermore, if non-public
        members are used in preconditions then the callers will not be able to fully
        check the preconditions to make sure the contract is satisfied before calling
        the function so it is best to only use public members at least in preconditions
        <sup>[<a name="id871438" href="#ftn.id871438" class="footnote">8</a>]</sup>.
      </p>
<p>
        In addition, this library checks class invariants (as well as preconditions
        and postconditions) only for functions that have a contract. For example,
        if a private member function is allowed to <span class="emphasis"><em>temporarily</em></span>
        brake the class invariants, you can omit the contract for that one private
        function so no invariants (as well as no preconditions and no postconditions)
        will be checked when that function is called. However, it should never be
        the case that public member functions can brake class invariants. It is recommended
        to write contracts for all functions (public and non) with the rare exceptions
        of a private member function that cannot be programmed without allowing for
        it to temporarily brake the class invariants.
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top">
<p>
          <span class="bold"><strong>Recommended Practices</strong></span>
        </p>
<p>
          1. Limit the contract code to a list of assertions with occasional if-statements
          to guard them.
        </p>
<p>
          2. Only access public class members when asserting preconditions.
        </p>
<p>
          3. Write contracts at least for all public member functions (even if they
          have no preconditions and no postconditions) so they check the class invariants.
        </p>
</td></tr>
</table></div>
<p>
        These practices are followed by all the examples of this documentation.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.signature_sequence"></a><a class="link" href="tutorial.html#contract__.tutorial.signature_sequence" title="Signature Sequence">Signature Sequence</a>
</h3></div></div></div>
<p>
        The very first elements of the <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
        sequence passed to the macros <code class="computeroutput"><a href="../CONTRACT_CONSTRUCTOR.html" target="_top">CONTRACT_CONSTRUCTOR</a><span class="special">()</span></code>, <code class="computeroutput"><a href="../CONTRACT_DESTRUCTOR.html" target="_top">CONTRACT_DESTRUCTOR</a><span class="special">()</span></code>, and <code class="computeroutput"><a href="../CONTRACT_FUNCTION.html" target="_top">CONTRACT_FUNCTION</a><span class="special">()</span></code> are the elements of the <span class="emphasis"><em>signature-sequence</em></span>
        <sup>[<a name="id871584" href="#ftn.id871584" class="footnote">9</a>]</sup>. The <span class="emphasis"><em>signature-sequence</em></span> repeats the syntactic
        elements of the function declaration. <sup>[<a name="id871800" href="#ftn.id871800" class="footnote">10</a>]</sup>
      </p>
<p>
        The syntax of <span class="emphasis"><em>signature-sequence</em></span> is somewhat unusual
        (even if it is all legal ISO standard C++). However, there is a convenient
        rule for remembering this syntax:
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top">
<p>
          <span class="bold"><strong>Signature Sequence Mnemonic</strong></span>
        </p>
<p>
          The tokens in the signature sequence appear in the exact same order as
          they appear in the relative function declaration.
        </p>
</td></tr>
</table></div>
<a name="contract__.tutorial.signature_sequence.an_example"></a><h6>
<a name="contract__.tutorial.signature_sequence.an_example-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.signature_sequence.an_example">An Example</a>
      </h6>
<p>
        Let's consider the following example (with respect to the <code class="computeroutput"><span class="identifier">myvector</span></code>
        example above, we have added the base class <code class="computeroutput"><span class="identifier">pushable</span></code>
        to show how to subcontract):
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="bold"><strong>class myvector:</strong></span> <span class="keyword">public</span> <span class="bold"><strong>pushable&lt;T&gt;</strong></span> <span class="special">{</span>
<span class="bold"><strong>public</strong></span><span class="special">:</span>
    <span class="bold"><strong>void push_back(const T&amp; element)</strong></span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="emphasis"><em>signature-sequence</em></span> <span class="special">...</span> <span class="special">)</span>
    <span class="special">...</span>
<span class="special">};</span>
</pre>
<p>
        Applying the mnemonic rule, we read the declaration of <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code> from top to bottom and we find the following
        tokens in the listed order (we have to start all the way up to the top of
        the <code class="computeroutput"><span class="identifier">myvector</span></code> class declaration):
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            The <span class="bold"><strong><code class="literal">class</code></strong></span> keyword
            for <code class="computeroutput"><span class="identifier">myvector</span></code> (this indicates
            that <code class="computeroutput"><span class="identifier">push_back</span></code> is a member
            function).
          </li>
<li class="listitem">
            The <span class="bold"><strong><code class="literal">myvector</code></strong></span> class
            type (this indicates that <code class="computeroutput"><span class="identifier">push_back</span></code>
            is a member function of <code class="computeroutput"><span class="identifier">myvector</span></code>).
          </li>
<li class="listitem">
            The <span class="bold"><strong><code class="literal">pushable&lt;T&gt;</code></strong></span>
            base class which is repeated in <span class="emphasis"><em>signature-sequence</em></span>
            as <code class="computeroutput"><span class="special">(</span><span class="identifier">inherit</span><span class="special">)(</span><span class="identifier">pushable</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;)</span></code> but only when the function is subcontracting
            from the specified base class (because "<code class="computeroutput"><span class="special">:</span></code>"
            is not a valid preprocessor token <code class="computeroutput"><span class="special">(</span><span class="identifier">inherit</span><span class="special">)</span></code>
            is used instead; also the inheritance access level, the <code class="computeroutput"><span class="keyword">public</span></code> keyword in this case, is not relevant
            and it is not repeated in <span class="emphasis"><em>signature-sequence</em></span>).
          </li>
<li class="listitem">
            The <span class="bold"><strong><code class="literal">public</code></strong></span> access
            level of the <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code> member function.
          </li>
<li class="listitem">
            The <span class="bold"><strong><code class="literal">void</code></strong></span> return type.
          </li>
<li class="listitem">
            The <span class="bold"><strong><code class="literal">push_back</code></strong></span> function
            name.
          </li>
<li class="listitem">
            The parenthesis "<span class="bold"><strong><code class="literal">(</code></strong></span>"
            to open the function argument list.
          </li>
<li class="listitem">
            The <span class="bold"><strong><code class="literal">const T&amp;</code></strong></span>
            function argument type.
          </li>
<li class="listitem">
            The <span class="bold"><strong><code class="literal">element</code></strong></span> function
            argument name.
          </li>
<li class="listitem">
            The parenthesis "<span class="bold"><strong><code class="literal">)</code></strong></span>"
            to close the function argument list.
          </li>
</ol></div>
<p>
        Wrapping all these tokens within parenthesis <code class="computeroutput"><span class="special">()</span></code>
        and listing them in the exact order as they appear in the function declaration,
        we obtain the <span class="emphasis"><em>signature-sequence</em></span> elements for this example.
        The parenthesis <code class="computeroutput"><span class="special">()</span></code> around the
        tokens are mandatory because they are the ones actually creating the <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
        sequence. New lines and spaces do not matter within preprocessor sequences.
      </p>
<pre class="programlisting"><span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="special">(</span><span class="identifier">copyable</span><span class="special">)(</span><span class="identifier">myvector</span><span class="special">)</span> <span class="special">(</span><span class="identifier">inherit</span><span class="special">)(</span><span class="identifier">vector_interface</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;)</span>
<span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">(</span><span class="identifier">push_back</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)(</span><span class="identifier">element</span><span class="special">)</span> <span class="special">)</span>
</pre>
<p>
        The <code class="computeroutput"><span class="identifier">myvector</span></code> class type is
        preceded by <code class="computeroutput"><span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span></code> because, for this example, we wanted to
        access the old object value <code class="computeroutput"><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)</span></code>
        (as the object was before the function body execution) in the postconditions.
        Also any function argument type can be tagged copyable if the old value of
        the related argument is needed in the postconditions. In this example, <code class="computeroutput"><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)(</span><span class="identifier">element</span><span class="special">)</span></code> could have been tagged copyable and specified
        in <span class="emphasis"><em>signature-sequence</em></span> as <code class="computeroutput"><span class="special">(</span><span class="identifier">copyable</span><span class="special">)(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)(</span><span class="identifier">element</span><span class="special">)</span></code> if the old value of the argument <code class="computeroutput"><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="identifier">element</span><span class="special">)</span></code>
        (as the argument was before the body execution) was needed in the postconditions.
      </p>
<p>
        Completing the example presented in the previous section, with the addition
        of subcontracting <code class="computeroutput"><span class="identifier">myvector</span><span class="special">::</span><span class="identifier">push_back</span><span class="special">()</span></code> from <code class="computeroutput"><span class="identifier">pushable</span><span class="special">::</span><span class="identifier">push_back</span><span class="special">()</span></code>, we have:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span><span class="special">:</span> <span class="keyword">public</span> <span class="identifier">pushable</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="special">{</span>
    
    <span class="identifier">CONTRACT_INVARIANT</span><span class="special">(</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="special">(</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span><span class="special">)</span> <span class="special">==</span> <span class="identifier">empty</span><span class="special">()</span> <span class="special">);</span>
    <span class="special">})</span> <span class="special">)</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">void</span> <span class="identifier">push_back</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span><span class="special">)</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="bold"><strong>(class) (copyable)(myvector)
            (inherit)(pushable&lt;T&gt;)
            (public) (void) (push_back)( (const T&amp;)(element) )</strong></span>
    <span class="special">(</span><span class="identifier">precondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">&lt;</span> <span class="identifier">max_size</span><span class="special">()</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)-&gt;</span><span class="identifier">size</span><span class="special">()</span> <span class="special">+</span> <span class="number">1</span><span class="special">)</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">element</span><span class="special">);</span>
    <span class="special">})</span> <span class="special">)</span>

    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>        
<span class="special">};</span>
</pre>
<p>
        This is a fully working example assuming that:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            <code class="computeroutput"><span class="identifier">pushable</span><span class="special">::</span><span class="identifier">push_back</span><span class="special">()</span></code>
            also has a contract specified using this library since it is used for
            subcontracting (this library allows to specify contracts also for pure
            virtual functions, see below).
          </li>
<li class="listitem">
            <code class="computeroutput"><span class="identifier">myvector</span></code> has an accessible
            constant-correct <sup>[<a name="id873455" href="#ftn.id873455" class="footnote">11</a>]</sup> copy constructor since it was tagged <code class="computeroutput"><span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span></code>
            (see <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/copy.html" target="_top">copy</a></code>):
          </li>
</ol></div>
<pre class="programlisting"><span class="comment">// Must be accessible and construct from a const&amp; parameter.</span>
<span class="identifier">myvector</span><span class="special">::</span><span class="identifier">myvector</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&amp;</span> <span class="identifier">source</span><span class="special">)</span> <span class="special">{</span> <span class="special">...</span> <span class="special">}</span>
</pre>
<p>
        If either one of these conditions is not true, this library will generate
        a compile-time errors when attempting to compile the code above.
      </p>
<a name="contract__.tutorial.signature_sequence.full_syntax"></a><h6>
<a name="contract__.tutorial.signature_sequence.full_syntax-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.signature_sequence.full_syntax">Full Syntax</a>
      </h6>
<p>
        Generalizing this example to include <span class="emphasis"><em>all</em></span> possible syntactic
        elements that can be found in a C++ function declaration, we obtain the full
        syntax for <span class="emphasis"><em>signature-sequence</em></span>.
      </p>
<p>
        <span class="bold"><strong><span class="emphasis"><em>signature-sequence</em></span> syntax for
        <code class="computeroutput"><a href="../CONTRACT_FUNCTION.html" target="_top">CONTRACT_FUNCTION</a><span class="special">()</span></code>:</strong></span>
      </p>
<p>
        For member functions:
      </p>
<pre class="programlisting"><span class="emphasis"><em>{</em></span><span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> <span class="special">(</span><span class="keyword">struct</span><span class="special">)</span><span class="emphasis"><em>}</em></span> /[/<span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span>/]/<span class="special">(</span><span class="emphasis"><em>class-type</em></span><span class="special">)</span> <span class="emphasis"><em>{</em></span><span class="special">(</span><span class="identifier">inherit</span><span class="special">)(</span><span class="emphasis"><em>base-class-type</em></span><span class="special">)</span><span class="emphasis"><em>}*</em></span>
<span class="emphasis"><em>{</em></span><span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> <span class="special">(</span><span class="keyword">protected</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> <span class="special">(</span><span class="keyword">private</span><span class="special">)</span><span class="emphasis"><em>}</em></span>
/[/<span class="special">(</span><span class="keyword">template</span><span class="special">)(</span> <span class="emphasis"><em>{</em></span><span class="special">(</span><span class="emphasis"><em>function-template-parameter-type</em></span><span class="special">)(</span><span class="emphasis"><em>function-template-parameter-name</em></span><span class="special">)</span><span class="emphasis"><em>}+</em></span> <span class="special">)</span>/]/
/[/<span class="special">(</span><span class="keyword">inline</span><span class="special">)</span>/]/ /[/<span class="special">(</span><span class="keyword">static</span><span class="special">)</span>/]/ /[/<span class="special">(</span><span class="keyword">virtual</span><span class="special">)</span>/]/
<span class="special">(</span><span class="emphasis"><em>result-type</em></span><span class="special">)</span> <span class="special">(</span><span class="emphasis"><em>function-name</em></span><span class="special">)(</span> <span class="emphasis"><em>{</em></span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> /{[/<span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span>/]/<span class="special">(</span><span class="emphasis"><em>argument-type</em></span><span class="special">)(</span><span class="emphasis"><em>argument-name</em></span><span class="special">)</span><span class="emphasis"><em>}+}</em></span> <span class="special">)</span>
/[/<span class="special">(</span><span class="keyword">const</span><span class="special">)</span>/]/ /[/<span class="special">(</span><span class="keyword">volatile</span><span class="special">)</span>/]/
</pre>
<p>
        For non-member functions:
      </p>
<pre class="programlisting">/[[/<span class="special">(</span><span class="keyword">export</span><span class="special">)</span>/]/ <span class="special">(</span><span class="keyword">template</span><span class="special">)(</span> <span class="emphasis"><em>{</em></span><span class="special">(</span><span class="emphasis"><em>function-template-parameter-type</em></span><span class="special">)(</span><span class="emphasis"><em>function-template-parameter-name</em></span><span class="special">)</span><span class="emphasis"><em>}+</em></span> <span class="special">)</span>/]/
/[/<span class="special">(</span><span class="keyword">inline</span><span class="special">)</span>/]/ /[/<span class="special">(</span><span class="keyword">extern</span> /[extern-string]/<span class="special">)</span>/]/
<span class="special">(</span><span class="emphasis"><em>result-type</em></span><span class="special">)</span> <span class="special">(</span><span class="emphasis"><em>function-name</em></span><span class="special">)(</span> <span class="emphasis"><em>{</em></span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> /{[/<span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span>/]/<span class="special">(</span><span class="emphasis"><em>argument-type</em></span><span class="special">)(</span><span class="emphasis"><em>argument-name</em></span><span class="special">)</span><span class="emphasis"><em>}+}</em></span> <span class="special">)</span>
</pre>
<p>
        Note that <code class="computeroutput"><span class="special">(</span><span class="keyword">static</span><span class="special">)</span></code> is used as usual for static member function
        but it cannot be specified for non-member functions because its use for non-members
        was deprecated from C to C++.
      </p>
<p>
        We have used the following conventions in writing the <span class="emphasis"><em>signature-sequence</em></span>
        syntax:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            // indicates an optional item.
          </li>
<li class="listitem">
            <code class="literal">item</code><span class="emphasis"><em>*</em></span> indicates an item repeated
            zero of more times.
          </li>
<li class="listitem">
            <code class="literal">item</code><span class="emphasis"><em>+</em></span> indicates an item repeated
            one of more times.
          </li>
<li class="listitem">
            <span class="emphasis"><em>{</em></span><code class="literal">item1 </code> <span class="emphasis"><em>operation
            </em></span> <code class="literal">item2 </code> <span class="emphasis"><em>operation ...}</em></span>
            indicates the item resulting after evaluating the expression within the
            curly parenthesis.
          </li>
<li class="listitem">
            <code class="literal">item1</code> <span class="emphasis"><em>| </em></span> <code class="literal">item2</code>
            indicates that one of the two items, but not both, must be specified.
          </li>
</ul></div>
<p>
        For example:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            // indicates that <code class="computeroutput"><span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span></code> is optional (it will only be specified
            for variables with old values in postconditions).
          </li>
<li class="listitem">
            <span class="emphasis"><em>{</em></span><code class="computeroutput"><span class="special">(</span><span class="identifier">inherit</span><span class="special">)(</span></code><span class="emphasis"><em>base-class-type</em></span><code class="computeroutput"><span class="special">)</span></code><span class="emphasis"><em>}*</em></span> indicates that
            <code class="computeroutput"><span class="special">(</span><span class="identifier">inherit</span><span class="special">)(</span></code><span class="emphasis"><em>base-class-type</em></span><code class="computeroutput"><span class="special">)</span></code> can be repeated zero or more times (it
            can be omitted, it will only be specified when subcontracting, and when
            specified it can be repeated multiple times to support subcontracting
            from multiple base classes in case of multiple inheritance).
          </li>
<li class="listitem">
            /{/<code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>argument-type</em></span><code class="computeroutput"><span class="special">)(</span></code>argument-name<code class="computeroutput"><span class="special">)</span></code><span class="emphasis"><em>}+</em></span>
            indicates that the function arguments (when specified instead of <code class="computeroutput"><span class="special">(</span><span class="keyword">void</span><span class="special">)</span></code>) must be repeated one or more times
            (together with their optional <code class="computeroutput"><span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span></code>
            tag).
          </li>
<li class="listitem">
            // indicates that the access level is optional but when specified it
            must be either <code class="computeroutput"><span class="special">(</span><span class="keyword">public</span><span class="special">)</span></code>, <code class="computeroutput"><span class="special">(</span><span class="keyword">protected</span><span class="special">)</span></code>,
            or <code class="computeroutput"><span class="special">(</span><span class="keyword">private</span><span class="special">)</span></code>.
          </li>
</ul></div>
<p>
        The syntaxes of <span class="emphasis"><em>signature-sequence</em></span> used by <code class="computeroutput"><a href="../CONTRACT_CONSTRUCTOR.html" target="_top">CONTRACT_CONSTRUCTOR</a><span class="special">()</span></code>
        and <code class="computeroutput"><a href="../CONTRACT_DESTRUCTOR.html" target="_top">CONTRACT_DESTRUCTOR</a><span class="special">()</span></code> are somewhat different because C++ uses
        different syntactic elements for constructor and destructor declarations
        than for member functions (constructors cannot be virtual, destructors cannot
        have function arguments, etc). However, the syntax for these <span class="emphasis"><em>signature-sequences</em></span>
        are still obtained applying the basic rule of listing the constructor and
        destructor signature tokens in the exact same order as they appear in the
        constructor and destructor declarations.
      </p>
<p>
        <span class="bold"><strong><span class="emphasis"><em>signature-sequence</em></span> syntax for
        <code class="computeroutput"><a href="../CONTRACT_CONSTRUCTOR.html" target="_top">CONTRACT_CONSTRUCTOR</a><span class="special">()</span></code>:</strong></span>
      </p>
<pre class="programlisting"><span class="emphasis"><em>{</em></span><span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> <span class="special">(</span><span class="keyword">struct</span><span class="special">)</span><span class="emphasis"><em>}</em></span> <span class="special">(</span><span class="emphasis"><em>class-type</em></span><span class="special">)</span>
<span class="emphasis"><em>{</em></span><span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> <span class="special">(</span><span class="keyword">protected</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> <span class="special">(</span><span class="keyword">private</span><span class="special">)</span><span class="emphasis"><em>}</em></span>
/[/<span class="special">(</span><span class="keyword">template</span><span class="special">)(</span> <span class="emphasis"><em>{</em></span><span class="special">(</span><span class="emphasis"><em>function-template-parameter-type</em></span><span class="special">)(</span><span class="emphasis"><em>function-template-parameter-name</em></span><span class="special">)</span><span class="emphasis"><em>}+</em></span> <span class="special">)</span>/]/
/[/<span class="special">(</span><span class="keyword">explicit</span><span class="special">)</span>/]/ /[/<span class="special">(</span><span class="keyword">inline</span><span class="special">)</span>/]/
<span class="special">(</span><span class="emphasis"><em>class-name</em></span><span class="special">)(</span> <span class="emphasis"><em>{</em></span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> /{[/<span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span>/]/<span class="special">(</span><span class="emphasis"><em>argument-type</em></span><span class="special">)(</span><span class="emphasis"><em>argument-name</em></span><span class="special">)</span><span class="emphasis"><em>}+}</em></span> <span class="special">)</span>
</pre>
<p>
        As usual, <span class="emphasis"><em>class-name</em></span> is used as the <span class="emphasis"><em>function-name</em></span>
        for constructors and there is no <span class="emphasis"><em>result-type</em></span>. Furthermore,
        the library does not currently error if <code class="computeroutput"><span class="special">(</span><span class="keyword">explicit</span><span class="special">)</span></code>
        is not specified in <span class="emphasis"><em>signature-sequence</em></span> even if the contracted
        constructor is <code class="computeroutput"><span class="keyword">explicit</span></code>. <sup>[<a name="id875102" href="#ftn.id875102" class="footnote">12</a>]</sup>
      </p>
<p>
        <span class="bold"><strong><span class="emphasis"><em>signature-sequence</em></span> syntax for
        <code class="computeroutput"><a href="../CONTRACT_DESTRUCTOR.html" target="_top">CONTRACT_DESTRUCTOR</a><span class="special">()</span></code>:</strong></span>
      </p>
<pre class="programlisting"><span class="emphasis"><em>{</em></span><span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> <span class="special">(</span><span class="keyword">struct</span><span class="special">)</span><span class="emphasis"><em>}</em></span> <span class="special">(</span><span class="emphasis"><em>class-type</em></span><span class="special">)</span>
<span class="emphasis"><em>{</em></span><span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> <span class="special">(</span><span class="keyword">protected</span><span class="special">)</span> <span class="emphasis"><em>|</em></span> <span class="special">(</span><span class="keyword">private</span><span class="special">)</span><span class="emphasis"><em>}</em></span>
/[/<span class="special">(</span><span class="keyword">inline</span><span class="special">)</span>/]/ /[/<span class="special">(</span><span class="keyword">virtual</span><span class="special">)</span>/]/
<span class="special">(</span><span class="emphasis"><em>class-name</em></span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span>
</pre>
<p>
        Note that <span class="emphasis"><em>class-name</em></span> and <span class="emphasis"><em>not</em></span> <code class="computeroutput"><span class="special">~</span></code><span class="emphasis"><em>class-name</em></span> is used as
        <span class="emphasis"><em>function-name</em></span> for destructors (<code class="computeroutput"><span class="string">"~"</span></code>
        cannot be used because it is not a valid preprocessor token). Furthermore,
        as usual destructors have no <span class="emphasis"><em>result-type</em></span> and no function
        arguments (the argument list is always specified <code class="computeroutput"><span class="special">(</span><span class="keyword">void</span><span class="special">)</span></code>).
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top">
<p>
          <span class="bold"><strong>Not in Signature Sequence</strong></span>
        </p>
<p>
          Eventual function argument default values and the keywords <code class="computeroutput"><span class="keyword">friend</span></code>, <code class="computeroutput"><span class="keyword">throw</span></code>
          (for exception specifications), <code class="computeroutput"><span class="keyword">auto</span></code>,
          <code class="computeroutput"><span class="keyword">register</span></code>, <code class="computeroutput"><span class="keyword">union</span></code>
          are <span class="bold"><strong>not</strong></span> repeated in the <span class="emphasis"><em>signature-sequence</em></span>
          (the library will generate compile-time errors otherwise). However, these
          features are still supported for the contracted function as discussed in
          the rest of this section (with the exception of <code class="computeroutput"><span class="keyword">union</span></code>
          for which contracts are not supported by this library).
        </p>
</td></tr>
</table></div>
<a name="contract__.tutorial.signature_sequence.syntax_errors"></a><h6>
<a name="contract__.tutorial.signature_sequence.syntax_errors-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.signature_sequence.syntax_errors">Syntax
        Errors</a>
      </h6>
<p>
        The usual C++ syntax constraints apply. For example, <code class="computeroutput"><span class="special">(</span><span class="keyword">static</span><span class="special">)</span></code> cannot
        be specified together with <code class="computeroutput"><span class="special">(</span><span class="keyword">virtual</span><span class="special">)</span></code>.
      </p>
<p>
        Furthermore, the tokens must be specified in the order listed above even
        if the C++ syntax allows for different ordering. For example, <code class="computeroutput"><span class="special">(</span><span class="keyword">const</span><span class="special">)</span>
        <span class="special">(</span><span class="keyword">volatile</span><span class="special">)</span></code> must be specified in this order, and not
        as <code class="computeroutput"><span class="special">(</span><span class="keyword">volatile</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span><span class="special">)</span></code>, even if C++ accepts both of orderings.
        Fixing one specific ordering does not alter the semantics of the code. <sup>[<a name="id875716" href="#ftn.id875716" class="footnote">13</a>]</sup>
      </p>
<p>
        The library will generate compile-time errors if <span class="emphasis"><em>signature-sequence</em></span>
        contains tokens combinations which are not valid respect to the C++ syntax.
      </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top">
<p>
          <span class="bold"><strong>Cryptic Preprocessing Errors</strong></span>
        </p>
<p>
          There is only a limited amount of compile-time error checking which this
          library can do on <span class="emphasis"><em>signature-sequence</em></span>. In some cases,
          and depending on the compiler used, an error in programming the <span class="emphasis"><em>signature-sequence</em></span>
          syntax will result in cryptic compiler errors.
        </p>
<p>
          These compiler errors might involve library internal templates and macros
          as well as <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
          internal macros (<code class="computeroutput"><span class="identifier">BOOST_PP_</span><span class="special">...</span></code>). Furthermore, the error line number
          will only refer to the first line of code at which the contract macro appears
          (because new lines within macro parameters are removed by the preprocessor).
        </p>
<p>
          The best way to resolve these errors is usually to inspect the <span class="emphasis"><em>signature-sequence</em></span>
          by eye instead of trying to make sense of the compiler error messages.
          Also, try to compile with contracts turned off to make sure that the errors
          are actually in the contract code. Rarely, it might be useful to look at
          the code generated by the contract macro expansion after preprocessing
          using your compiler related options ("-E -P" on GCC, "/EP"
          on Microsoft Visual C++, etc).
        </p>
<p>
          While the C++ preprocessor imposes limits on the amount of error checking
          that can be performed on <span class="emphasis"><em>signature-sequence</em></span>, the current
          library implementation does <span class="emphasis"><em>not</em></span> implement the best
          possible preprocessor error detection and reporting strategy. This is an
          area of improvement for the library that is currently being worked on.
        </p>
<p>
          <span class="underline">Please report on the library <a href="http://sourceforge.net/projects/dbcpp/forums/forum/920163" target="_top">help
          website</a> the criptic preprocessing errors you experience in order
          to facilitate this process.</span>
        </p>
</td></tr>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.function_arguments"></a><a class="link" href="tutorial.html#contract__.tutorial.function_arguments" title="Function Arguments">Function Arguments</a>
</h3></div></div></div>
<p>
        Note that within <span class="emphasis"><em>signature-sequence</em></span>, multiple function
        arguments (as well as function template parameters) are <span class="emphasis"><em>not</em></span>
        separated by commas (you can use a space or a new line instead):
      </p>
<pre class="programlisting"><span class="special">(</span><span class="emphasis"><em>function-name</em></span><span class="special">)(</span> <span class="special">(</span><span class="emphasis"><em>argument-type1</em></span><span class="special">)(</span><span class="emphasis"><em>argument-name1</em></span><span class="special">)</span>
        <span class="comment">/* no comma (a space or new line can be used instead) */</span>
        <span class="special">(</span><span class="emphasis"><em>argument-type2</em></span><span class="special">)(</span><span class="emphasis"><em>arguments-name2</em></span><span class="special">)</span>
        <span class="comment">/* no comma (a space or new line can be used instead) */</span>
        <span class="special">(</span><span class="emphasis"><em>argument-type3</em></span><span class="special">)(</span><span class="emphasis"><em>argument-name3</em></span><span class="special">)</span> <span class="emphasis"><em>...</em></span> <span class="special">)</span>
</pre>
<a name="contract__.tutorial.function_arguments.no_argument"></a><h6>
<a name="contract__.tutorial.function_arguments.no_argument-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.function_arguments.no_argument">No Argument</a>
      </h6>
<p>
        If the function has no arguments, the argument list must be specified <code class="computeroutput"><span class="keyword">void</span></code>:
      </p>
<pre class="programlisting"><span class="special">(</span><span class="emphasis"><em>function-name</em></span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span>
</pre>
<p>
        Note that <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)(</span> <span class="special">)</span></code> <span class="bold"><strong>cannot</strong></span> be used instead and it will generate a (cryptic)
        compile-time error.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
<p>
          An empty function argument list cannot be represented simply by empty parenthesis
          <code class="computeroutput"><span class="special">()</span></code> as in <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)()</span></code> because the C++ standard does not allow
          to specify empty preprocessor sequence elements like <code class="computeroutput"><span class="special">()</span></code>
          thus <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span></code> must
          be used instead. Note that the C++ standard allows to use <code class="computeroutput"><span class="keyword">void</span></code> to specify a function with no arguments
          <span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">(</span><span class="keyword">void</span><span class="special">)</span></code> (this
          is the syntax used in all the examples of this documentations to be consistent
          with the relative <span class="emphasis"><em>signature-sequence</em></span> syntax requirement).
        </p>
<p>
          The C99 standard instead allows for empty preprocessor sequence elements
          <code class="computeroutput"><span class="special">()</span></code> (because it allows for
          empty macro parameters, see <a class="link" href="bibliography.html" title="Bibliography">[Nelson2004]</a>
          and <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
          for details). C99 also defines deprecated the use of <code class="computeroutput"><span class="keyword">void</span></code>
          for functions with no arguments -- <span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">(</span><span class="keyword">void</span><span class="special">)</span></code>
          is deprecated. Therefore, on C99 compilers <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)()</span></code> should be used in <span class="emphasis"><em>signature-sequence</em></span>
          for functions with no arguments instead of <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span></code>.
        </p>
<p>
          This library supports both syntaxes <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span></code> and
          <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)()</span></code> in <span class="emphasis"><em>signature-sequence</em></span>
          but the later syntax will only compile for C99 (so it is not recommended).
        </p>
<p>
          The same limitation applies to the <code class="computeroutput"><a href="../CONTRACT_INVARIANT.html" target="_top">CONTRACT_INVARIANT</a><span class="special">()</span></code> macro when the class has no invariant.
          Also in this case the library supports both syntaxes <code class="computeroutput"><a href="../CONTRACT_INVARIANT.html" target="_top">CONTRACT_INVARIANT</a><span class="special">(</span> <span class="special">({})</span> <span class="special">)</span></code> and <code class="computeroutput"><a href="../CONTRACT_INVARIANT.html" target="_top">CONTRACT_INVARIANT</a><span class="special">()</span></code> bu the later syntax will only compile
          for C99 (so it is not recommended).
        </p>
</td></tr>
</table></div>
<a name="contract__.tutorial.function_arguments.default_arguments"></a><h6>
<a name="contract__.tutorial.function_arguments.default_arguments-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.function_arguments.default_arguments">Default
        Arguments</a>
      </h6>
<p>
        If the contracted function has default argument values, the default values
        are <span class="emphasis"><em>not</em></span> repeated in <span class="emphasis"><em>signature-sequence</em></span>
        for which only the argument type and name are specified. However, the default
        argument values specified for the contracted function work as usual and the
        caller can omit to specify such augments when calling the contracted function:
      </p>
<pre class="programlisting"><span class="keyword">int</span> <span class="identifier">f</span><span class="special">(</span><span class="keyword">int</span> <span class="identifier">x</span> <span class="special">=</span> <span class="number">0</span><span class="special">)</span>
<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)</span> <span class="special">(</span><span class="identifier">f</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">)</span> <span class="bold"><strong>// Do not repeat default value 0.</strong></span>
<span class="special">(</span><span class="identifier">precondition</span><span class="special">)</span> <span class="special">({</span>
    <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">x</span> <span class="special">&gt;=</span> <span class="number">0</span> <span class="special">);</span>
<span class="special">})</span>
<span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">(</span><span class="identifier">result</span><span class="special">)</span> <span class="special">({</span>
    <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">result</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">x</span> <span class="special">+</span> <span class="number">10</span><span class="special">)</span> <span class="special">);</span>
<span class="special">})</span>
<span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
    <span class="keyword">return</span> <span class="identifier">x</span> <span class="special">+</span> <span class="number">10</span><span class="special">;</span>
<span class="special">})</span> <span class="special">)</span>

<span class="special">...</span>
<span class="keyword">int</span> <span class="identifier">y</span> <span class="special">=</span> <span class="identifier">f</span><span class="special">();</span> <span class="bold"><strong>// y is 10 (call uses default value 0).</strong></span>
<span class="identifier">y</span> <span class="special">=</span> <span class="identifier">f</span><span class="special">(</span><span class="number">2</span><span class="special">);</span> <span class="comment">// y is 12.</span>
<span class="identifier">y</span> <span class="special">=</span> <span class="identifier">f</span><span class="special">(-</span><span class="number">1</span><span class="special">);</span> <span class="comment">// Call precondition failure handler.</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.inheritance"></a><a class="link" href="tutorial.html#contract__.tutorial.inheritance" title="Inheritance">Inheritance</a>
</h3></div></div></div>
<p>
        The library supports subcontracting from multiple base classes in case of
        multiple inheritance. Contracts are for pure virtual functions are also supported
        as usual when body definition is deferred to the derived classes (see below).
      </p>
<p>
        However, note that constructors and destructors do not directly subcontract
        (their <span class="emphasis"><em>signature-sequences</em></span> do not accept any <code class="computeroutput"><span class="special">(</span><span class="identifier">inherit</span><span class="special">)(</span></code><span class="emphasis"><em>base-class-type</em></span><code class="computeroutput"><span class="special">)</span></code> token). This is because the C++ object construction
        and destruction mechanism will automatically execute the code that checks
        the base class constructor and destructor contracts if present.
      </p>
<a name="contract__.tutorial.inheritance.multiple_inheritance"></a><h6>
<a name="contract__.tutorial.inheritance.multiple_inheritance-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.inheritance.multiple_inheritance">Multiple
        Inheritance</a>
      </h6>
<p>
        In case of multiple inheritance, it is possible to subcontract from multiple
        base classes by repeating <code class="computeroutput"><span class="special">(</span><span class="identifier">inherit</span><span class="special">)(</span></code><span class="emphasis"><em>base-class-type</em></span><code class="computeroutput"><span class="special">)</span></code> multiple times in <span class="emphasis"><em>signature-sequence</em></span>.
        For example, assuming <code class="computeroutput"><span class="identifier">myvector</span></code>
        is inheriting and subcontracting from <span class="emphasis"><em>both</em></span> the <code class="computeroutput"><span class="identifier">boundable</span></code> and the <code class="computeroutput"><span class="identifier">basic_begin</span></code>
        base classes:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span><span class="special">:</span>
        <span class="keyword">public</span> <span class="bold"><strong>boundable&lt;typename std::vector&lt;T&gt;::const_iterator&gt;</strong></span><span class="special">,</span>
        <span class="keyword">private</span> <span class="bold"><strong>basic_begin&lt;typename std::vector&lt;T&gt;::const_iterator&gt;</strong></span> <span class="special">{</span>
    <span class="special">...</span> <span class="comment">// Class invariants.</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span> <span class="identifier">const_iterator</span><span class="special">;</span>
    
    <span class="identifier">const_iterator</span> <span class="identifier">begin</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)</span>
            <span class="comment">// Multiple inheritance.</span>
            <span class="bold"><strong>(inherit)(boundable&lt;const_iterator&gt;)</strong></span>
            <span class="bold"><strong>(inherit)(basic_begin&lt;const_iterator&gt;)</strong></span>
            <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="identifier">const_iterator</span><span class="special">)</span> <span class="special">(</span><span class="identifier">begin</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="special">(</span><span class="keyword">const</span><span class="special">)</span>
    <span class="comment">// No preconditions (omitted).</span>
    <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">(</span><span class="identifier">result</span><span class="special">)</span> <span class="special">({</span> <span class="comment">// Return value `result` in postconditions.</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">empty</span><span class="special">())</span> <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">result</span> <span class="special">==</span> <span class="identifier">end</span><span class="special">()</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
        <span class="comment">// Must use CONTRACT_BODY() when calling the base function.</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">basic_begin</span><span class="special">&lt;</span><span class="identifier">const_iterator</span><span class="special">&gt;::</span><span class="bold"><strong>CONTRACT_BODY</strong></span><span class="special">(</span><span class="identifier">begin</span><span class="special">)</span> <span class="special">==</span>
                <span class="identifier">const_iterator</span><span class="special">())</span> <span class="special">{</span>
            <span class="keyword">return</span> <span class="identifier">const_iterator</span><span class="special">();</span>
        <span class="special">}</span>
        <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">begin</span><span class="special">();</span>
    <span class="special">})</span> <span class="special">)</span>

    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>        
<span class="special">};</span>
</pre>
<p>
        The subcontracted contracts are checked in the order in which their <code class="computeroutput"><span class="special">(</span><span class="identifier">inherit</span><span class="special">)</span></code> tokens are listed in <span class="emphasis"><em>signature-sequence</em></span>
        and the derived class contracts are checked last.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
<p>
          The above implies that if a derived class relaxes the precondition of an
          overridden function, all the base contract preconditions will have be checked
          first to fails before the relaxed preconditions of the overridden function
          are checked to pass.
        </p>
<p>
          In this case, it would appear more efficient to check the derived class
          contract first. However, the derived class invariants could be written
          assuming that the base class invariants hold true (for example the base
          class invariants could assert a pointer to be not null and thus the derived
          class invariants could deference the pointer without checking for nullity).
          In doing so, the derived class invariants assume that they are checked
          last in <span class="emphasis"><em>AND</em></span> with all base classes invariants. The
          same argument can be made for postconditions. Therefore, if derived class
          invariants (and postconditions) should be checked last in <span class="emphasis"><em>AND</em></span>
          with all base classes invariants (and postconditions). It is natural to
          follow the same policy and check derived class function preconditions last
          in the <span class="emphasis"><em>OR</em></span> with all base class function preconditions
          (even if this introduces the inefficiency to have to check and fail all
          the base class function preconditions when a derived class function if
          relaxing the base class function preconditions).
        </p>
</td></tr>
</table></div>
<a name="contract__.tutorial.inheritance.base_function_call"></a><h6>
<a name="contract__.tutorial.inheritance.base_function_call-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.inheritance.base_function_call">Base Function
        Call</a>
      </h6>
<p>
        When the derived class invokes the overridden function in the base class
        the <code class="computeroutput"><span class="identifier">CONTRACT_BODY</span><span class="special">()</span></code>
        macro must be used:
      </p>
<pre class="programlisting"><span class="emphasis"><em>base-class</em></span><span class="special">::</span><span class="identifier">CONTRACT_BODY</span><span class="special">(</span><span class="emphasis"><em>function-name</em></span><span class="special">)(...)</span>
</pre>
<p>
        as illustrated by the example above. The overriding function should <span class="bold"><strong>not</strong></span> call the overridden function directly without
        using the macro:
      </p>
<pre class="programlisting"><span class="emphasis"><em>base-class</em></span><span class="special">::</span><span class="emphasis"><em>function-name</em></span><span class="special">)(...)</span>
</pre>
<p>
        because this call will cause the contracts to executed infinite recursive
        calls (due to the dynamic binding of the contracted virtual base function
        <span class="emphasis"><em>base-class</em></span><code class="computeroutput"><span class="special">::</span></code><span class="emphasis"><em>function-name</em></span>).
        <sup>[<a name="id878216" href="#ftn.id878216" class="footnote">14</a>]</sup>
      </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top">
<p>
          <span class="bold"><strong>Base Calls via CONTRACT_BODY()</strong></span>
        </p>
<p>
          Overriding functions must use <span class="emphasis"><em>base-class</em></span><code class="computeroutput"><span class="special">::</span><span class="identifier">CONTRACT_BODY</span><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)</span></code> and not just <span class="emphasis"><em>base-class</em></span><code class="computeroutput"><span class="special">::</span></code><span class="emphasis"><em>function-name</em></span> when
          calling the overridden functions (otherwise the contract calls will cause
          infinite recursion).
        </p>
</td></tr>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.operators"></a><a class="link" href="tutorial.html#contract__.tutorial.operators" title="Operators">Operators</a>
</h3></div></div></div>
<p>
        The library supports contracts for operators.
      </p>
<p>
        For operators, the <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)</span></code> token in <span class="emphasis"><em>signature-sequence</em></span>
        must contain both the operator symbol and the operator <span class="emphasis"><em>name</em></span>
        spelled out in words without using any special symbol (this is necessary
        because, in general, the operator special symbols (<code class="computeroutput"><span class="special">[]</span></code>,
        <code class="computeroutput"><span class="special">==</span></code>, <code class="computeroutput"><span class="special">&lt;&lt;</span></code>,
        etc) are not valid preprocessor tokens). For operators, <code class="computeroutput"><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)</span></code> takes the following form:
      </p>
<pre class="programlisting"><span class="special">(</span><span class="keyword">operator</span><span class="special">(</span><span class="emphasis"><em>symbol</em></span><span class="special">,</span> <span class="emphasis"><em>name</em></span><span class="special">))</span>
</pre>
<p>
        Note the necessary double closing parenthesis <code class="computeroutput"><span class="string">"))"</span></code>
        at the end. For example:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span> <span class="special">{</span>
    <span class="special">...</span> <span class="comment">// Class invariants.</span>
    
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">size_type</span> <span class="identifier">size_type</span><span class="special">;</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_reference</span> <span class="identifier">const_reference</span><span class="special">;</span>

    <span class="identifier">const_reference</span> *operator[]*<span class="special">(</span><span class="identifier">size_type</span> <span class="identifier">index</span><span class="special">)</span> <span class="keyword">const</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)</span>
            <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="identifier">const_reference</span><span class="special">)</span> *(operator([]*<span class="bold"><strong>, at))</strong></span><span class="special">(</span>
                    <span class="special">(</span><span class="identifier">size_type</span><span class="special">)(</span><span class="identifier">index</span><span class="special">)</span> <span class="special">)</span> <span class="special">(</span><span class="keyword">const</span><span class="special">)</span>
    <span class="special">(</span><span class="identifier">precondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">index</span> <span class="special">&lt;</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="comment">// No postconditions (omitted).</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
        <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">[</span><span class="identifier">index</span><span class="special">];</span>
    <span class="special">})</span> <span class="special">)</span>

    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span> 
<span class="special">};</span>
</pre>
<p>
        The operator name, in this example <code class="computeroutput"><span class="string">"at"</span></code>,
        is arbitrary and any name without special symbols can been used.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.overloaded_functions"></a><a class="link" href="tutorial.html#contract__.tutorial.overloaded_functions" title="Overloaded Functions">Overloaded
      Functions</a>
</h3></div></div></div>
<p>
        The library supports contracts for overloaded functions.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
<p>
          However, the library uses the argument <span class="bold"><strong>names</strong></span>
          to distinguish the overloaded function signatures whereas C++ uses the
          argument types (this is because, in general, the argument types, for example
          <code class="computeroutput"><span class="keyword">const</span> <span class="keyword">int</span><span class="special">&amp;</span></code>, are not valid preprocessor tokens).
        </p>
<p>
          If two functions share the same name, the same number of arguments, and
          the same <code class="computeroutput"><span class="keyword">const</span></code> qualifier then
          their argument names (and not just their types) must be different to allow
          the library to distinguish these two functions from each other. (This is
          usually not a significant limitation because different argument names can
          be given.)
        </p>
</td></tr>
</table></div>
<p>
        For example:
      </p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">number</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="comment">// Overloaded functions distinguished using argument names (not types) and const.</span>
    
    <span class="identifier">number</span> <span class="identifier">add</span><span class="special">(</span><span class="keyword">const</span> <span class="keyword">int</span><span class="special">&amp;</span> <span class="identifier">n</span><span class="special">)</span> <span class="comment">// (1)</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(...)</span>

    <span class="comment">// OK -- different from (1) because this is `const`.</span>
    <span class="identifier">number</span><span class="special">&amp;</span> <span class="identifier">add</span><span class="special">(</span><span class="keyword">const</span> <span class="keyword">int</span><span class="special">&amp;</span> <span class="identifier">n</span><span class="special">)</span> <span class="keyword">const</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(...)</span>

    <span class="comment">// OK -- different from (1) because argument named "d" instead of "n".</span>
    <span class="identifier">number</span> <span class="identifier">add</span><span class="special">(</span><span class="keyword">const</span> <span class="keyword">double</span><span class="special">&amp;</span> <span class="identifier">d</span><span class="special">)</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(...)</span>
    
    <span class="comment">// Error -- same as (1) because both non-const and with argument named "n" (even if different argument type).</span>
    <span class="identifier">number</span> <span class="identifier">add</span><span class="special">(</span><span class="keyword">const</span> <span class="keyword">double</span><span class="special">&amp;</span> <span class="identifier">n</span><span class="special">)</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(...)</span> <span class="comment">// Same as (1), error!</span>
    
    <span class="special">...</span>
<span class="special">};</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.function_templates"></a><a class="link" href="tutorial.html#contract__.tutorial.function_templates" title="Function Templates">Function Templates</a>
</h3></div></div></div>
<p>
        The <code class="computeroutput"><span class="special">(</span><span class="keyword">template</span><span class="special">)</span></code> token is used in <span class="emphasis"><em>signature-sequence</em></span>
        to specify a function template listing the relative template parameters.
        The template parameters are specified using a syntax similar to the one of
        the function arguments.
      </p>
<p>
        For example:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span> <span class="special">{</span>
    <span class="special">...</span> <span class="comment">// Class invariants.</span>
    
<span class="keyword">private</span><span class="special">:</span>
    <span class="bold"><strong>template&lt;class Iter&gt;</strong></span>
    <span class="keyword">static</span> <span class="keyword">bool</span> <span class="identifier">all_equals</span><span class="special">(</span><span class="identifier">Iter</span> <span class="identifier">first</span><span class="special">,</span> <span class="identifier">Iter</span> <span class="identifier">last</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span><span class="special">)</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)</span>
            <span class="special">(</span><span class="keyword">private</span><span class="special">)</span> <span class="bold"><strong>(template)( (class)(Iter) )</strong></span>
            <span class="special">(</span><span class="keyword">static</span><span class="special">)</span> <span class="special">(</span><span class="keyword">bool</span><span class="special">)</span> <span class="special">(</span><span class="identifier">all_equals</span><span class="special">)(</span>
                    <span class="special">(</span><span class="identifier">Iter</span><span class="special">)(</span><span class="identifier">first</span><span class="special">)</span> <span class="special">(</span><span class="identifier">Iter</span><span class="special">)(</span><span class="identifier">last</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)(</span><span class="identifier">element</span><span class="special">)</span> <span class="special">)</span>
    <span class="special">(</span><span class="identifier">precondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">first</span> <span class="special">&lt;</span> <span class="identifier">last</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
        <span class="keyword">for</span> <span class="special">(</span><span class="identifier">Iter</span> <span class="identifier">i</span> <span class="special">=</span> <span class="identifier">first</span><span class="special">;</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="identifier">last</span><span class="special">;</span> <span class="special">++</span><span class="identifier">i</span><span class="special">)</span> <span class="special">{</span>
            <span class="keyword">if</span> <span class="special">(*</span><span class="identifier">i</span> <span class="special">!=</span> <span class="identifier">element</span><span class="special">)</span> <span class="keyword">return</span> <span class="keyword">false</span><span class="special">;</span>
        <span class="special">}</span>
        <span class="keyword">return</span> <span class="keyword">true</span><span class="special">;</span>
    <span class="special">})</span> <span class="special">)</span>
    
    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="special">};</span>
</pre>
<p>
        In this example, the function also happens to be a static member but any
        function (non-member, member, static member, constructor, etc) can be be
        declared a template function as usual in C++.
      </p>
<p>
        In principle, the library also supports contracts for <code class="computeroutput"><span class="keyword">export</span></code>
        class and function templates. For non-member function templates <code class="computeroutput"><span class="special">(</span><span class="keyword">export</span><span class="special">)</span></code>
        can be specified within the <span class="emphasis"><em>signature-sequence</em></span> as usual.
        However, most compilers do not support <code class="computeroutput"><span class="keyword">export</span></code>
        templates and this library feature has not being tested.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.deferring_the_body"></a><a class="link" href="tutorial.html#contract__.tutorial.deferring_the_body" title="Deferring the Body">Deferring the
      Body</a>
</h3></div></div></div>
<p>
        Class invariants, preconditions, and postconditions are part of the function
        specifications (indeed they <span class="emphasis"><em>assert</em></span> the function specifications).
        Therefore, this library requires contracts to be defined together with the
        function declarations. However, the function body (i.e., the function implementation)
        can be defined either together with the function declaration or separately.
      </p>
<p>
        In other words, the usual C++ feature that allows to separate a function
        definition from its declaration is retained by this library.
      </p>
<a name="contract__.tutorial.deferring_the_body.separating_declaration_and_definition"></a><h6>
<a name="contract__.tutorial.deferring_the_body.separating_declaration_and_definition-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.deferring_the_body.separating_declaration_and_definition">Separating
        Declaration and Definition</a>
      </h6>
<p>
        When the function body is defined separately from the function declaration:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            The <code class="computeroutput"><span class="special">(</span><span class="identifier">body</span><span class="special">)(;)</span></code> tokens are used to define the body
            in the macro parameter passed to <code class="computeroutput"><a href="../CONTRACT_FUNCTION.html" target="_top">CONTRACT_FUNCTION</a><span class="special">()</span></code>. The <code class="computeroutput"><span class="string">";"</span></code>
            symbol is the usual C++ symbol used to separate the function definition
            from its declaration.
          </li>
<li class="listitem">
            The <code class="computeroutput"><a href="../CONTRACT_BODY.html" target="_top">CONTRACT_BODY</a><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)</span></code> macro is used to name the function where
            it is defined. Again, for operators <span class="emphasis"><em>function-name</em></span>
            must be specified as <code class="computeroutput"><span class="keyword">operator</span><span class="special">(</span></code><span class="emphasis"><em>symbol</em></span><code class="computeroutput"><span class="special">,</span> </code><span class="emphasis"><em>name</em></span><code class="computeroutput"><span class="special">)</span></code>.
          </li>
<li class="listitem">
            Similarly, it is possible to separate constructor and destructor body
            definitions. In this case, the macros <code class="computeroutput"><a href="../CONTRACT_CONSTRUCTOR_BODY.html" target="_top">CONTRACT_CONSTRUCTOR_BODY</a><span class="special">(</span></code><span class="emphasis"><em>class-type</em></span><code class="computeroutput"><span class="special">,</span> </code><span class="emphasis"><em>class-name</em></span><code class="computeroutput"><span class="special">)</span></code> and <code class="computeroutput"><a href="../CONTRACT_DESTRUCTOR_BODY.html" target="_top">CONTRACT_DESTRUCTOR_BODY</a><span class="special">(</span></code><span class="emphasis"><em>class-type</em></span><code class="computeroutput"><span class="special">,</span> </code><span class="emphasis"><em>class-name</em></span><code class="computeroutput"><span class="special">)</span></code> should be used when the constructor
            and destructor are defined respectively (note again that <code class="computeroutput"><span class="string">"~"</span></code> is <span class="emphasis"><em>not</em></span>
            specified to name destructors, just use the class name instead).
          </li>
</ul></div>
<p>
        For example:
      </p>
<pre class="programlisting"><span class="comment">// Declarations (usually in header files).</span>

<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span><span class="special">:</span>
        <span class="keyword">public</span> <span class="identifier">boundable</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span><span class="special">&gt;,</span>
        <span class="keyword">private</span> <span class="identifier">basic_begin</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span><span class="special">&gt;</span> <span class="special">{</span>
    <span class="special">...</span> <span class="comment">// Class invariants.</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">size_type</span> <span class="identifier">size_type</span><span class="special">;</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_reference</span> <span class="identifier">const_reference</span><span class="special">;</span>
    <span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span> <span class="identifier">const_iterator</span><span class="special">;</span>

    <span class="identifier">myvector</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&amp;</span> <span class="identifier">right</span><span class="special">)</span>
    <span class="identifier">CONTRACT_CONSTRUCTOR</span><span class="special">(</span> <span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)</span>
            <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&amp;)(</span><span class="identifier">right</span><span class="special">)</span> <span class="special">)</span>
    <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">vector_</span> <span class="special">==</span> <span class="identifier">right</span><span class="special">.</span><span class="identifier">vector_</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">(</span>
        <span class="bold"><strong>;</strong></span> <span class="comment">// Deferres body definition.</span>
    <span class="special">)</span> <span class="special">)</span>

    <span class="keyword">virtual</span> <span class="special">~</span><span class="identifier">myvector</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span>
    <span class="identifier">CONTRACT_DESTRUCTOR</span><span class="special">(</span>
            <span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)</span>
            <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">virtual</span><span class="special">)</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">(</span>
        <span class="bold"><strong>;</strong></span>
    <span class="special">)</span> <span class="special">)</span>
    
    <span class="identifier">const_iterator</span> <span class="identifier">begin</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)</span>
            <span class="special">(</span><span class="identifier">inherit</span><span class="special">)(</span><span class="identifier">boundable</span><span class="special">&lt;</span><span class="identifier">const_iterator</span><span class="special">&gt;)</span>
            <span class="special">(</span><span class="identifier">inherit</span><span class="special">)(</span><span class="identifier">basic_begin</span><span class="special">&lt;</span><span class="identifier">const_iterator</span><span class="special">&gt;)</span>
            <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="identifier">const_iterator</span><span class="special">)</span> <span class="special">(</span><span class="identifier">begin</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="special">(</span><span class="keyword">const</span><span class="special">)</span>
    <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">(</span><span class="identifier">result</span><span class="special">)</span> <span class="special">({</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">empty</span><span class="special">())</span> <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">result</span> <span class="special">==</span> <span class="identifier">end</span><span class="special">()</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">(</span>
        <span class="bold"><strong>;</strong></span>
    <span class="special">)</span> <span class="special">)</span>

    <span class="identifier">const_reference</span> <span class="keyword">operator</span><span class="special">[](</span><span class="identifier">size_type</span> <span class="identifier">index</span><span class="special">)</span> <span class="keyword">const</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)</span>
            <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="identifier">const_reference</span><span class="special">)</span> <span class="special">(</span><span class="keyword">operator</span><span class="special">([],</span> <span class="identifier">at</span><span class="special">))(</span>
                    <span class="special">(</span><span class="identifier">size_type</span><span class="special">)(</span><span class="identifier">index</span><span class="special">)</span> <span class="special">)</span> <span class="special">(</span><span class="keyword">const</span><span class="special">)</span>
    <span class="special">(</span><span class="identifier">precondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">index</span> <span class="special">&lt;</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">(</span>
        <span class="bold"><strong>;</strong></span>
    <span class="special">)</span> <span class="special">)</span>

    <span class="special">...</span> <span class="comment">// Rest of the class.</span>
<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>        
<span class="special">};</span>

<span class="comment">// Separated definitions (eventually in a different file).</span>

<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="bold"><strong>CONTRACT_CONSTRUCTOR_BODY(myvector&lt;T&gt;, myvector)</strong></span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&amp;</span> <span class="identifier">right</span><span class="special">)</span> <span class="special">{</span>
    <span class="identifier">vector_</span> <span class="special">=</span> <span class="identifier">right</span><span class="special">.</span><span class="identifier">vector_</span><span class="special">;</span>
<span class="special">}</span>

<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="bold"><strong>CONTRACT_DESTRUCTOR_BODY(myvector&lt;T&gt;, myvector)</strong></span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">{</span>
    <span class="comment">// Do nothing in this case.</span>
<span class="special">}</span>

<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">typename</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">iterator</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="bold"><strong>CONTRACT_BODY(begin)</strong></span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">begin</span><span class="special">();</span>
<span class="special">}</span>

<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">typename</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_reference</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span>
        *CONTRACT_BODY(operator([]*<span class="bold"><strong>, at))</strong></span><span class="special">(</span><span class="identifier">size_type</span> <span class="identifier">index</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">[</span><span class="identifier">index</span><span class="special">];</span>
<span class="special">}</span>
</pre>
<p>
        In addition to the usual benefits of separating function definitions from
        their declarations (smaller and more readable header files, less recompilation
        needed, etc), this separation also improves the library compile-time error
        messages. When a function is defined together with its declaration, the function
        implementation code is passed as one single macro parameter <code class="computeroutput"><span class="special">(</span><span class="identifier">body</span><span class="special">)({</span>
        <span class="special">...</span> <span class="special">})</span></code>
        to the contract macros. Macro preprocessing removes all newline characters
        from within the macro parameters so the implementation code is compiled as
        if it were written on a single line. As a result, any compile-time error
        within the function body code will be reported having the same line number
        and it will be harder to track. Instead, if the body definition is separated
        from the function declaration, the definition code is not wrapped within
        a macro parameter and the compiler errors will indicate useful line numbers.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          It is recommended to separate the body definition from the function declaration
          so that line numbers in compiler errors retain their usual values.
        </p></td></tr>
</table></div>
<p>
        Finally, note how the <span class="emphasis"><em>signature-sequence</em></span> unusual syntax
        does <span class="emphasis"><em>not</em></span> propagate to the function definitions (only
        the function name is changed in the function definitions). Therefore, when
        definitions are separated from declarations, the files containing the definitions
        (usually the ".cpp" files) will not contain the unusual <span class="emphasis"><em>signature-sequence</em></span>
        syntax and they will be easier to read.
      </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top">
<p>
          <span class="bold"><strong>Constructor Member Initialization List</strong></span>
        </p>
<p>
          Because of a library limitation, it is not possible to separate a constructor
          definition from its declaration when the constructor uses a member initialization
          list (see <code class="computeroutput"><a href="../CONTRACT_CONSTRUCTOR_BODY.html" target="_top">CONTRACT_CONSTRUCTOR_BODY</a><span class="special">()</span></code> macro for details and workarounds) <sup>[<a name="id883219" href="#ftn.id883219" class="footnote">15</a>]</sup>.
        </p>
</td></tr>
</table></div>
<a name="contract__.tutorial.deferring_the_body.pure_virtual_functions"></a><h6>
<a name="contract__.tutorial.deferring_the_body.pure_virtual_functions-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.deferring_the_body.pure_virtual_functions">Pure
        Virtual Functions</a>
      </h6>
<p>
        The library also supports contracts for pure virtual functions.
      </p>
<p>
        In this case, the <code class="computeroutput"><span class="special">(</span><span class="identifier">body</span><span class="special">)(=</span> <span class="number">0</span><span class="special">;)</span></code>
        tokens are used to define the body in the macro parameter passed to <code class="computeroutput"><a href="../CONTRACT_FUNCTION.html" target="_top">CONTRACT_FUNCTION</a><span class="special">()</span></code>.
        The <code class="computeroutput"><span class="string">"= 0;"</span></code> symbol is
        the usual C++ symbol used to specify pure virtual functions.
      </p>
<p>
        For example:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">pushable</span> <span class="special">{</span>
    <span class="special">...</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="identifier">push_back</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span><span class="special">)</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="special">(</span><span class="keyword">class</span><span class="special">)</span> <span class="special">(</span><span class="identifier">pushable</span><span class="special">)</span>
            <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">virtual</span><span class="special">)</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">(</span><span class="identifier">push_back</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)(</span><span class="identifier">element</span><span class="special">)</span> <span class="special">)</span>
    <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">({</span>
        <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">back</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">element</span> <span class="special">);</span>
    <span class="special">})</span>
    <span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">(</span>
        <span class="special">=</span> <span class="number">0</span><span class="special">;</span>
    <span class="special">)</span> <span class="special">)</span> <span class="comment">// Pure virtual body.</span>
<span class="special">};</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.friends"></a><a class="link" href="tutorial.html#contract__.tutorial.friends" title="Friends">Friends</a>
</h3></div></div></div>
<p>
        The library supports contracts for friend non-member functions (and friend
        classes work as usual).
      </p>
<p>
        However, when a friend non-member function is contracted:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            The function definition must always be separated from its friendship
            declaration (whereas, C++ allows to define friends function in place
            together with they friendship declarations).
          </li>
<li class="listitem">
            The body function <code class="computeroutput"><a href="../CONTRACT_BODY.html" target="_top">CONTRACT_BODY</a><span class="special">(</span></code><span class="emphasis"><em>function-name</em></span><code class="computeroutput"><span class="special">)</span></code>, and not the contracted function <span class="emphasis"><em>function-name</em></span>,
            must be declared friend using .
          </li>
</ol></div>
<p>
        For example:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">point</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="identifier">point</span><span class="special">(</span><span class="keyword">const</span> <span class="keyword">double</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span> <span class="keyword">const</span> <span class="keyword">double</span><span class="special">&amp;</span> <span class="identifier">y</span><span class="special">):</span> <span class="identifier">x_</span><span class="special">(</span><span class="identifier">x</span><span class="special">),</span> <span class="identifier">y_</span><span class="special">(</span><span class="identifier">y</span><span class="special">)</span> <span class="special">{}</span>

    <span class="keyword">bool</span> <span class="identifier">printable</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="keyword">true</span><span class="special">;</span> <span class="special">}</span> <span class="comment">// Dummy implementation.</span>

    <span class="comment">// Forward declare body as friend.</span>
    <span class="keyword">friend</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">ostream</span><span class="special">&amp;</span> <span class="identifier">CONTRACT_NONMEMBER_BODY</span><span class="special">(</span><span class="keyword">operator</span><span class="special">(&lt;&lt;,</span> <span class="identifier">out</span><span class="special">))(</span>
            <span class="identifier">std</span><span class="special">::</span><span class="identifier">ostream</span><span class="special">&amp;</span> <span class="identifier">s</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">point</span><span class="special">&amp;</span> <span class="identifier">o</span><span class="special">);</span>

<span class="keyword">private</span><span class="special">:</span>
    <span class="keyword">double</span> <span class="identifier">x_</span><span class="special">;</span>
    <span class="keyword">double</span> <span class="identifier">y_</span><span class="special">;</span>
<span class="special">};</span>
    
<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
<span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">ostream</span><span class="special">&amp;)</span> <span class="special">(</span><span class="keyword">operator</span><span class="special">(&lt;&lt;,</span> <span class="identifier">out</span><span class="special">))(</span> <span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">ostream</span><span class="special">&amp;)(</span><span class="identifier">s</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">point</span><span class="special">&amp;)(</span><span class="identifier">o</span><span class="special">)</span> <span class="special">)</span>
    <span class="special">(</span><span class="identifier">precondition</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">o</span><span class="special">.</span><span class="identifier">printable</span><span class="special">())</span> <span class="special">)</span>
<span class="special">({</span>
    <span class="keyword">return</span> <span class="identifier">s</span> <span class="special">&lt;&lt;</span> <span class="string">"("</span> <span class="special">&lt;&lt;</span> <span class="identifier">o</span><span class="special">.</span><span class="identifier">x_</span> <span class="special">&lt;&lt;</span> <span class="string">", "</span> <span class="special">&lt;&lt;</span> <span class="identifier">o</span><span class="special">.</span><span class="identifier">y_</span> <span class="special">&lt;&lt;</span> <span class="string">")"</span><span class="special">;</span>
<span class="special">})</span> <span class="special">)</span>

</pre>
<p>
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.structs_and_unions"></a><a class="link" href="tutorial.html#contract__.tutorial.structs_and_unions" title="Structs and Unions">Structs and Unions</a>
</h3></div></div></div>
<p>
        Note that <code class="computeroutput"><span class="special">(</span><span class="keyword">class</span><span class="special">)</span></code> and <code class="computeroutput"><span class="special">(</span><span class="keyword">struct</span><span class="special">)</span></code> can
        be used interchangeably in the <span class="emphasis"><em>signature-sequence</em></span> as
        the library makes <span class="emphasis"><em>no</em></span> differentiation between contracts
        for classes and a structs. However, as always remember:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            To always specify the member access level <code class="computeroutput"><span class="special">(</span><span class="keyword">public</span><span class="special">)</span></code>,
            etc.
          </li>
<li class="listitem">
            To use <code class="computeroutput"><a href="../CONTRACT_INVARIANT.html" target="_top">CONTRACT_INVARIANT</a><span class="special">()</span></code> in a private section also for <code class="computeroutput"><span class="keyword">struct</span></code>.
          </li>
<li class="listitem">
            That no contract is checked (not event the class invariants) when member
            variables are accessed directly (so it might be best for the <code class="computeroutput"><span class="keyword">struct</span></code> to have no non-constant public
            member variable).
          </li>
</ol></div>
<p>
        For example:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">positive</span> <span class="special">{</span>
    <span class="keyword">const</span> <span class="keyword">double</span><span class="special">&amp;</span> <span class="identifier">number</span><span class="special">;</span>

<span class="keyword">private</span><span class="special">:</span> <span class="comment">// Alway contract class (invariants, etc) in a private section at top.</span>
    <span class="identifier">CONTRACT_CLASS</span><span class="special">(</span> <span class="special">(</span><span class="identifier">positive</span><span class="special">)</span>
    <span class="special">(</span><span class="identifier">invariant</span><span class="special">)(</span>
        <span class="special">(</span><span class="identifier">number</span> <span class="special">&gt;</span> <span class="number">0.0</span><span class="special">)</span>
    <span class="special">)</span> <span class="special">)</span>

<span class="keyword">public</span><span class="special">:</span> <span class="comment">// Remember to always specify the access level (public, etc).</span>
    <span class="identifier">CONTRACT_CONSTRUCTOR</span><span class="special">(</span>
    <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="identifier">positive</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="keyword">double</span><span class="special">&amp;)(</span><span class="identifier">n</span><span class="special">)</span> <span class="special">)</span> <span class="special">(</span><span class="identifier">number</span><span class="special">(</span><span class="identifier">n</span><span class="special">))</span>
        <span class="special">(</span><span class="identifier">precondition</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">n</span> <span class="special">&gt;</span> <span class="number">0.0</span><span class="special">)</span> <span class="special">)</span>
    <span class="special">({</span>
    <span class="special">})</span> <span class="special">)</span>
<span class="special">};</span>

</pre>
<p>
      </p>
<p>
        This library does <span class="emphasis"><em>not</em></span> support contracts for unions and
        <code class="computeroutput"><span class="special">(</span><span class="keyword">union</span><span class="special">)</span></code> cannot be specified in the <span class="emphasis"><em>signature-sequence</em></span>.
        Contracts for unions are not supported because union member variable allocations
        overlap and they cannot have constructors instead the library needs to augment
        the object state using a (non overlapping) <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/state.html" target="_top">state</a></code>
        member variable with a default constructor to disable invariant checking
        in nested function calls.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.qualifiers"></a><a class="link" href="tutorial.html#contract__.tutorial.qualifiers" title="Qualifiers">Qualifiers</a>
</h3></div></div></div>
<p>
        This library supports contracts also when constant, linkage, storage, etc
        qualifiers are specified.
      </p>
<a name="contract__.tutorial.qualifiers.const_and_volatile"></a><h6>
<a name="contract__.tutorial.qualifiers.const_and_volatile-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.qualifiers.const_and_volatile">Const and
        Volatile</a>
      </h6>
<p>
        The <code class="computeroutput"><span class="keyword">const</span></code> and <code class="computeroutput"><span class="keyword">volatile</span></code> qualifiers are repeated in the <span class="emphasis"><em>signature-sequence</em></span>
        and they can be used as usual. However, when they are both specified they
        must appear in the order <code class="computeroutput"><span class="special">(</span><span class="keyword">const</span><span class="special">)</span> <span class="special">(</span><span class="keyword">volatile</span><span class="special">)</span></code> and not <code class="computeroutput"><span class="special">(</span><span class="keyword">volatile</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span><span class="special">)</span></code>.
      </p>
<p>
        The invariant, precondition, and postcondition functions are always <code class="computeroutput"><span class="keyword">const</span></code> to ensure contract constant-correctness.
        In addition, the eventual <code class="computeroutput"><span class="keyword">const</span></code>
        and <code class="computeroutput"><span class="keyword">volatile</span></code> qualifiers specified
        for the contracted function are applied to the body, precondition, and postcondition
        functions as well. Therefore, applying the usual <code class="computeroutput"><span class="keyword">const</span>
        <span class="keyword">volatile</span></code> semantics, note the followings:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            Class invariants can access any <code class="computeroutput"><span class="keyword">const</span></code>
            and <code class="computeroutput"><span class="keyword">const</span> <span class="keyword">volatile</span></code>
            member.
          </li>
<li class="listitem">
            Preconditions and postconditions of non-<code class="computeroutput"><span class="keyword">const</span></code>
            and <code class="computeroutput"><span class="keyword">const</span></code> members can access
            any <code class="computeroutput"><span class="keyword">const</span></code> and <code class="computeroutput"><span class="keyword">const</span> <span class="keyword">volatile</span></code>
            member.
          </li>
<li class="listitem">
            Preconditions and postconditions of <code class="computeroutput"><span class="keyword">volatile</span></code>
            members can only access <code class="computeroutput"><span class="keyword">const</span>
            <span class="keyword">volatile</span></code> members.
          </li>
<li class="listitem">
            If a <code class="computeroutput"><span class="keyword">volatile</span></code> member function
            tags the class type <code class="computeroutput"><span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span></code> so to use the object old value in postconditions
            then the object old value is, as well as the object current value, <code class="computeroutput"><span class="keyword">const</span> <span class="keyword">volatile</span></code>
            qualified and therefore programmers must specify a constant-correct copy
            constructor for the <code class="computeroutput"><span class="keyword">volatile</span></code>
            object type otherwise the library will generate a compile-time error
            (note that C++ will automatically synthesize only the constant-correct
            copy constructor the the original class type and not for the <code class="computeroutput"><span class="keyword">volatile</span></code> class type).
          </li>
</ol></div>
<p>
        For example:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">z</span><span class="special">:</span> <span class="keyword">public</span> <span class="identifier">b</span> <span class="special">{</span> <span class="comment">// Some base class b to show subcontracting.</span>

    <span class="identifier">CONTRACT_CLASS</span><span class="special">(</span> <span class="special">(</span><span class="identifier">z</span><span class="special">)</span> <span class="special">(</span><span class="keyword">public</span><span class="special">)(</span><span class="identifier">b</span><span class="special">)</span>
    <span class="special">(</span><span class="identifier">invariant</span><span class="special">)(</span>
        <span class="special">(</span><span class="identifier">check_c</span><span class="special">()</span> <span class="special">&amp;&amp;</span> <span class="identifier">check_cv</span><span class="special">())</span> <span class="comment">// const</span>
    <span class="special">)</span> <span class="special">)</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="identifier">z</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">{}</span>

    <span class="comment">// For old object, must manually program const-correct copy</span>
    <span class="comment">// constructor for volatile type (instead use `z(constz&amp;)`</span>
    <span class="comment">// automatically synthesized by C++ for non-volatile type).</span>
    <span class="identifier">z</span><span class="special">(</span><span class="keyword">const</span> <span class="keyword">volatile</span> <span class="identifier">z</span><span class="special">&amp;</span> <span class="identifier">source</span><span class="special">)</span> <span class="special">{}</span>

    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)</span> <span class="special">(</span><span class="identifier">f</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span> <span class="comment">// no-cv</span>
        <span class="special">(</span><span class="identifier">precondition</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">check_c</span><span class="special">()</span> <span class="special">&amp;&amp;</span> <span class="identifier">check_cv</span><span class="special">())</span> <span class="special">)</span> <span class="comment">// const</span>
        <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)(</span><span class="identifier">result</span><span class="special">)(</span>
            <span class="special">(</span><span class="identifier">check_c</span><span class="special">()</span> <span class="special">&amp;&amp;</span> <span class="identifier">check_cv</span><span class="special">())</span> <span class="comment">// const</span>
            <span class="special">(</span><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)-&gt;</span><span class="identifier">check_c</span><span class="special">()</span> <span class="comment">// oldof(this) also const</span>
                    <span class="special">&amp;&amp;</span> <span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)-&gt;</span><span class="identifier">check_cv</span><span class="special">())</span>
        <span class="special">)</span>
    <span class="special">({</span> <span class="comment">// no-cv</span>
        <span class="identifier">check_nocv</span><span class="special">();</span> <span class="identifier">check_c</span><span class="special">();</span> <span class="identifier">check_v</span><span class="special">();</span> <span class="identifier">check_cv</span><span class="special">();</span>
        <span class="keyword">return</span> <span class="number">1</span><span class="special">;</span>
    <span class="special">})</span> <span class="special">)</span>

    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)</span> <span class="special">(</span><span class="identifier">f</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="special">(</span><span class="keyword">const</span><span class="special">)</span> <span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span>
        <span class="special">(</span><span class="identifier">precondition</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">check_c</span><span class="special">()</span> <span class="special">&amp;&amp;</span> <span class="identifier">check_cv</span><span class="special">())</span> <span class="special">)</span> <span class="comment">// const</span>
        <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)(</span><span class="identifier">result</span><span class="special">)(</span>
            <span class="special">(</span><span class="identifier">check_c</span><span class="special">()</span> <span class="special">&amp;&amp;</span> <span class="identifier">check_cv</span><span class="special">())</span> <span class="comment">// const</span>
            <span class="special">(</span><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)-&gt;</span><span class="identifier">check_c</span><span class="special">()</span> <span class="comment">// oldof(this) also const</span>
                    <span class="special">&amp;&amp;</span> <span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)-&gt;</span><span class="identifier">check_cv</span><span class="special">())</span>
        <span class="special">)</span>
    <span class="special">({</span> <span class="comment">// const</span>
        <span class="identifier">check_c</span><span class="special">();</span> <span class="identifier">check_cv</span><span class="special">();</span>
        <span class="keyword">return</span> <span class="number">2</span><span class="special">;</span>
    <span class="special">})</span> <span class="special">)</span>
    
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)</span> <span class="special">(</span><span class="identifier">f</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="special">(</span><span class="keyword">volatile</span><span class="special">)</span> <span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span>
        <span class="special">(</span><span class="identifier">precondition</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">check_cv</span><span class="special">())</span> <span class="special">)</span> <span class="comment">// const volatile</span>
        <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)(</span><span class="identifier">result</span><span class="special">)(</span>
            <span class="special">(</span><span class="identifier">check_cv</span><span class="special">())</span> <span class="comment">// const volatile</span>
            <span class="comment">// oldof(this) also const volatile</span>
            <span class="special">(</span><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)-&gt;</span><span class="identifier">check_cv</span><span class="special">())</span>
        <span class="special">)</span>
    <span class="special">({</span> <span class="comment">// volatile</span>
        <span class="identifier">check_v</span><span class="special">();</span> <span class="identifier">check_cv</span><span class="special">();</span>
        <span class="keyword">return</span> <span class="number">3</span><span class="special">;</span>
    <span class="special">})</span> <span class="special">)</span>
    
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="comment">// const must appear before volatile in signature</span>
    <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)</span> <span class="special">(</span><span class="identifier">f</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="special">(</span><span class="keyword">const</span><span class="special">)</span> <span class="special">(</span><span class="keyword">volatile</span><span class="special">)</span> <span class="special">(</span><span class="identifier">copyable</span><span class="special">)</span>
        <span class="special">(</span><span class="identifier">precondition</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">check_cv</span><span class="special">())</span> <span class="special">)</span> <span class="comment">// const volatile</span>
        <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)(</span><span class="identifier">result</span><span class="special">)(</span>
            <span class="special">(</span><span class="identifier">check_cv</span><span class="special">())</span> <span class="comment">// const volatile</span>
            <span class="comment">// oldof(this) also const volatile</span>
            <span class="special">(</span><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="keyword">this</span><span class="special">)-&gt;</span><span class="identifier">check_cv</span><span class="special">())</span>
        <span class="special">)</span>
    <span class="special">({</span> <span class="comment">// const volatile</span>
        <span class="identifier">check_cv</span><span class="special">();</span>
        <span class="keyword">return</span> <span class="number">4</span><span class="special">;</span>
    <span class="special">})</span> <span class="special">)</span>
    
    <span class="comment">// Used to demonstrate qualified member access constraints.</span>
    <span class="keyword">bool</span> <span class="identifier">check_nocv</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">{</span> <span class="keyword">return</span> <span class="keyword">true</span><span class="special">;</span> <span class="special">}</span>
    <span class="keyword">bool</span> <span class="identifier">check_c</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="keyword">true</span><span class="special">;</span> <span class="special">}</span>
    <span class="keyword">bool</span> <span class="identifier">check_v</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">volatile</span> <span class="special">{</span> <span class="keyword">return</span> <span class="keyword">true</span><span class="special">;</span> <span class="special">}</span>
    <span class="keyword">bool</span> <span class="identifier">check_cv</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="keyword">volatile</span> <span class="special">{</span> <span class="keyword">return</span> <span class="keyword">true</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span>

</pre>
<p>
      </p>
<p>
        Note that the cv-qualifier is used to resolve overloading as usual (so there
        is no need to use different argument names). Also subcontracting works as
        usual for cv-qualified member functions (as shown by the base class <code class="computeroutput"><span class="identifier">b</span></code> in this example).
      </p>
<a name="contract__.tutorial.qualifiers.inline"></a><h6>
<a name="contract__.tutorial.qualifiers.inline-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.qualifiers.inline">Inline</a>
      </h6>
<p>
        The <code class="computeroutput"><span class="keyword">inline</span></code> qualifier is repeated
        in the <span class="emphasis"><em>signature-sequence</em></span> and it is used as usual. For
        example:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">z</span> <span class="special">{</span>

    <span class="identifier">CONTRACT_CLASS</span><span class="special">(</span> <span class="special">(</span><span class="identifier">z</span><span class="special">)</span> <span class="special">)</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">inline</span><span class="special">)</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">(</span><span class="identifier">inl</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">)</span>
    <span class="special">({</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="identifier">x</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
    <span class="special">})</span> <span class="special">)</span>
<span class="special">};</span>

<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
<span class="special">(</span><span class="keyword">inline</span><span class="special">)</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">(</span><span class="identifier">inl</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">)</span>
<span class="special">({</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="identifier">x</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
<span class="special">})</span> <span class="special">)</span>

</pre>
<p>
      </p>
<a name="contract__.tutorial.qualifiers.extern_and_static"></a><h6>
<a name="contract__.tutorial.qualifiers.extern_and_static-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.qualifiers.extern_and_static">Extern and
        Static</a>
      </h6>
<p>
        The <code class="computeroutput"><span class="keyword">extern</span></code> linkage qualifier
        is repeated in the <span class="emphasis"><em>signature-sequence</em></span> for non-member
        functions and it is used as usual. For example:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
<span class="special">(</span><span class="keyword">extern</span><span class="special">)</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">(</span><span class="identifier">ext</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">)</span> <span class="comment">// External linkage.</span>
<span class="special">({</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="identifier">x</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
<span class="special">})</span> <span class="special">)</span>

<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
<span class="special">(</span><span class="keyword">extern</span> <span class="string">"C"</span><span class="special">)</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">(</span><span class="identifier">ext_c</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">)</span> <span class="comment">// External linkage callable from C.</span>
<span class="special">({</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="identifier">x</span> <span class="special">&lt;&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">endl</span><span class="special">;</span>
<span class="special">})</span> <span class="special">)</span>

</pre>
<p>
      </p>
<p>
        The <code class="computeroutput"><span class="keyword">static</span></code> qualifier is used
        as usual for static member functions and it is specified in <span class="emphasis"><em>signature-sequence</em></span>.
        The <code class="computeroutput"><span class="keyword">static</span></code> qualifier for non-member
        functions to indicate non-members local to a translation unit was deprecated
        from C to C++ (see [Stroustrup1997]) therefore it is not supported by this
        library and it cannot be specified in <span class="emphasis"><em>signature-sequence</em></span>.
      </p>
<a name="contract__.tutorial.qualifiers.auto_and_register"></a><h6>
<a name="contract__.tutorial.qualifiers.auto_and_register-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.qualifiers.auto_and_register">Auto and
        Register</a>
      </h6>
<p>
        The <code class="computeroutput"><span class="keyword">auto</span></code> and <code class="computeroutput"><span class="keyword">register</span></code>
        storage qualifiers are <span class="emphasis"><em>not</em></span> repeated in the <span class="emphasis"><em>signature-sequence</em></span>
        but they can appear in the contracted function as usual. When these qualifiers
        are used, they will have effect for the contracted function but not for the
        contract (i.e., these qualifier will not be applied to the precondition,
        postcondition, and body function arguments). For example:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
<span class="special">(</span><span class="keyword">double</span><span class="special">)</span> <span class="special">(</span><span class="identifier">square</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">auto</span><span class="special">)(</span><span class="keyword">double</span><span class="special">)(</span><span class="identifier">d</span><span class="special">)</span> <span class="special">)</span> <span class="comment">// `auto` storage classifier.</span>
    <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)(</span><span class="identifier">result</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">result</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">d</span> <span class="special">*</span> <span class="identifier">d</span><span class="special">))</span> <span class="special">)</span>
<span class="special">({</span>
    <span class="keyword">auto</span> <span class="keyword">double</span> <span class="identifier">y</span> <span class="special">=</span> <span class="identifier">d</span> <span class="special">*</span> <span class="identifier">d</span><span class="special">;</span>
    <span class="keyword">return</span> <span class="identifier">y</span><span class="special">;</span>
<span class="special">})</span> <span class="special">)</span>

<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
<span class="special">(</span><span class="keyword">int</span><span class="special">)</span> <span class="special">(</span><span class="identifier">square</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">register</span><span class="special">)(</span><span class="keyword">int</span><span class="special">)(</span><span class="identifier">i</span><span class="special">)</span> <span class="special">)</span> <span class="comment">// `register` storage classifier.</span>
    <span class="special">(</span><span class="identifier">postcondition</span><span class="special">)(</span><span class="identifier">result</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">result</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">i</span> <span class="special">*</span> <span class="identifier">i</span><span class="special">))</span> <span class="special">)</span>
<span class="special">({</span>
    <span class="keyword">register</span> <span class="keyword">int</span> <span class="identifier">y</span> <span class="special">=</span> <span class="identifier">i</span> <span class="special">*</span> <span class="identifier">i</span><span class="special">;</span>
    <span class="keyword">return</span> <span class="identifier">y</span><span class="special">;</span>
<span class="special">})</span> <span class="special">)</span>

</pre>
<p>
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.blocks_and_loops"></a><a class="link" href="tutorial.html#contract__.tutorial.blocks_and_loops" title="Blocks and Loops">Blocks and Loops</a>
</h3></div></div></div>
<p>
        Block invariants <code class="computeroutput"><a href="../CONTRACT_ASSERT_BLOCK_INVARIANT.html" target="_top">CONTRACT_ASSERT_BLOCK_INVARIANT</a><span class="special">()</span></code> can be used to assert conditions anywhere
        within a code block (not just loops). When used within a loop, block invariants
        can be used to assert loop invariants.
      </p>
<p>
        Loop variants can be used to check the correctness of a loop, including its
        termination, as explained in detail in <a class="link" href="bibliography.html" title="Bibliography">[Meyer1997]</a>
        (and they can only appear within loops). At each loop iteration, the specified
        loop variant integer expression is automatically asserted to be positive
        (&gt; 0) and to decrease from the previous loop iteration. Loop variants
        can be used to assert loop correctness. Because the variant decreases and
        it cannot be zero or smaller than zero it is possible to guarantee loop termination.
        A loop can only have one variant.
      </p>
<p>
        When asserting loop variants using <code class="computeroutput"><a href="../CONTRACT_ASSERT_LOOP_VARIANT.html" target="_top">CONTRACT_ASSERT_LOOP_VARIANT</a><span class="special">()</span></code> it is necessary to first call <code class="computeroutput"><a href="../CONTRACT_INIT_LOOP_VARIANT.html" target="_top">CONTRACT_INIT_LOOP_VARIANT</a></code>
        once (and only once) within a code block that has same of higher scope level
        than the loop code block.
      </p>
<p>
        For example:
      </p>
<pre class="programlisting"><span class="keyword">double</span> <span class="identifier">abs_total</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;&amp;</span> <span class="identifier">vector</span><span class="special">)</span>
<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
        <span class="special">(</span><span class="keyword">double</span><span class="special">)</span> <span class="special">(</span><span class="identifier">abs_total</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;&amp;)(</span><span class="identifier">vector</span><span class="special">)</span> <span class="special">)</span>
<span class="special">(</span><span class="identifier">postcondition</span><span class="special">)</span> <span class="special">(</span><span class="identifier">total</span><span class="special">)</span> <span class="special">({</span> <span class="comment">// Result value named `total`.</span>
    <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">total</span> <span class="special">&gt;=</span> <span class="number">0.0</span> <span class="special">);</span>
<span class="special">})</span>
<span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
    <span class="keyword">double</span> <span class="identifier">total</span> <span class="special">=</span> <span class="number">0.0</span><span class="special">;</span>
    <span class="comment">// Block invariants can appear anywhere in code block.</span>
    <span class="bold"><strong>CONTRACT_ASSERT_BLOCK_INVARIANT( total == 0.0 );</strong></span>

    <span class="special">{</span> <span class="comment">// Variant initialized locally to its loop.</span>
        <span class="bold"><strong>CONTRACT_INIT_LOOP_VARIANT;</strong></span>
        <span class="keyword">for</span> <span class="special">(</span><span class="identifier">size_t</span> <span class="identifier">i</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="identifier">vector</span><span class="special">.</span><span class="identifier">size</span><span class="special">();</span> <span class="special">++</span><span class="identifier">i</span><span class="special">)</span> <span class="special">{</span>
            <span class="comment">// Block invariants used to assert loop invariants.</span>
            <span class="bold"><strong>CONTRACT_ASSERT_BLOCK_INVARIANT( i &lt; vector.size() );</strong></span>
            <span class="comment">// Loop variant (can only appear in loops).</span>
            <span class="bold"><strong>CONTRACT_ASSERT_LOOP_VARIANT( vector.size() - i );</strong></span>

            <span class="identifier">total</span> <span class="special">+=</span> <span class="identifier">vector</span><span class="special">[</span><span class="identifier">i</span><span class="special">];</span>
        <span class="special">}</span>
    <span class="special">}</span>
    <span class="keyword">return</span> <span class="identifier">total</span> <span class="special">&lt;</span> <span class="number">0.0</span> <span class="special">?</span> <span class="special">-</span><span class="identifier">total</span> <span class="special">:</span> <span class="identifier">total</span><span class="special">;</span>
<span class="special">})</span> <span class="special">)</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.exception_specifications"></a><a class="link" href="tutorial.html#contract__.tutorial.exception_specifications" title="Exception Specifications">Exception
      Specifications</a>
</h3></div></div></div>
<p>
        Exception specifications are <span class="emphasis"><em>not</em></span> repeated in the <span class="emphasis"><em>signature-sequence</em></span>
        but they can be specified for contracted member functions as usual.
      </p>
<p>
        However, non-member functions with exception specifications cannot be contracted
        (the library will generated a compile-time error otherwise). A possible workaround
        for this library limitation is to make the non-member functions with exception
        specifications static members of some artificially introduced class so they
        can be contracted. For example:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">c</span> <span class="special">{</span> <span class="comment">// Some artificially introduced class.</span>

    <span class="identifier">CONTRACT_CLASS</span><span class="special">(</span> <span class="special">(</span><span class="identifier">c</span><span class="special">)</span> <span class="special">)</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">static</span><span class="special">)</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">(</span><span class="identifier">some</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">&amp;)(</span><span class="identifier">what</span><span class="special">)</span> <span class="special">)</span>
            <span class="special">(</span><span class="keyword">throw</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">char</span><span class="special">)</span> <span class="special">(</span><span class="keyword">int</span><span class="special">)</span> <span class="special">)</span> <span class="comment">// Exception specifications.</span>
    <span class="special">({</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">what</span> <span class="special">==</span> <span class="string">"none"</span><span class="special">)</span> <span class="keyword">return</span><span class="special">;</span> <span class="comment">// OK.</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">what</span> <span class="special">==</span> <span class="string">"char"</span><span class="special">)</span> <span class="keyword">throw</span> <span class="keyword">char</span><span class="special">(</span><span class="char">'a'</span><span class="special">);</span> <span class="comment">// OK.</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">what</span> <span class="special">==</span> <span class="string">"int"</span><span class="special">)</span> <span class="keyword">throw</span> <span class="keyword">int</span><span class="special">(-</span><span class="number">1</span><span class="special">);</span> <span class="comment">// OK.</span>
        <span class="keyword">throw</span> <span class="identifier">what</span><span class="special">;</span> <span class="comment">// Not in specs so terminate() is called.</span>
    <span class="special">})</span> <span class="special">)</span>
    
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="comment">// Ex. specs not repeated in signature.</span>
    <span class="special">(</span><span class="keyword">public</span><span class="special">)</span> <span class="special">(</span><span class="keyword">static</span><span class="special">)</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">(</span><span class="identifier">none</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">&amp;)(</span><span class="identifier">what</span><span class="special">)</span> <span class="special">)</span>
            <span class="special">(</span><span class="keyword">throw</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">)</span> <span class="comment">// Exception specifications (throw nothing).</span>
    <span class="special">({</span>
        <span class="keyword">if</span> <span class="special">(</span><span class="identifier">what</span> <span class="special">==</span> <span class="string">"none"</span><span class="special">)</span> <span class="keyword">return</span><span class="special">;</span> <span class="comment">// OK.</span>
        <span class="keyword">throw</span> <span class="identifier">what</span><span class="special">;</span> <span class="comment">// Not in specs so terminate() is called.</span>
    <span class="special">})</span> <span class="special">)</span>
<span class="special">};</span>

</pre>
<p>
      </p>
<p>
        The library uses the following rules to handle exceptions thrown by the contracts:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            When an exception is thrown while checking invariants, preconditions,
            or postconditions then the contract condition is considered <span class="emphasis"><em>failed</em></span>
            (because it was not possible to check it to be true) so the relative
            contract failure handler function is invoked.
          </li>
<li class="listitem">
            When an exception is thrown while executing the body then the class invariants
            are checked (for member functions only) and, if they hold true, the exception
            is passed up to the caller as usual (otherwise the class invariant failed
            handler function is invoked).
          </li>
</ol></div>
<p>
        Therefore, exception specifications work as usual as long as the member function
        body does not fail the class invariant when it throws the exception. Furthermore,
        if the contract failure handlers are redefined to throw exceptions (instead
        of calling <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">terminate</span><span class="special">()</span></code>,
        see <a class="link" href="throw_on_failure.html" title="Annex: Throw on Failure">Throw on Failure</a>)
        then the exception specifications still work as usual because they apply
        to both the exceptions thrown by the body and the exceptions thrown by the
        contract failure handlers.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.commas_within_macro_parameters"></a><a class="link" href="tutorial.html#contract__.tutorial.commas_within_macro_parameters" title="Commas Within Macro Parameters">Commas
      Within Macro Parameters</a>
</h3></div></div></div>
<p>
        The C++ preprocessor only recognizes the <code class="computeroutput"><span class="special">()</span></code>
        parenthesis. It does not recognize any other parenthesis such as <code class="computeroutput"><span class="special">&lt;&gt;</span></code>, <code class="computeroutput"><span class="special">[]</span></code>,
        or <code class="computeroutput"><span class="special">{}</span></code>. As a consequence, any
        comma passed within a macro parameter that is not wrapped by the <code class="computeroutput"><span class="special">()</span></code> parenthesis will be interpreted by the
        preprocessor as a parameter separation token and will generate a preprocessing
        error. Also macro parameters passed as elements of <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
        sequences cannot contain commas not wrapped by extra <code class="computeroutput"><span class="special">()</span></code>
        parenthesis (the preprocessor sequence <code class="computeroutput"><span class="special">()</span></code>
        parenthesis are not sufficient to wrap the commas).
      </p>
<p>
        Consider the following example:
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">K</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">fill</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;&amp;</span> <span class="identifier">source</span><span class="special">,</span>
        <span class="keyword">const</span> <span class="identifier">K</span><span class="special">&amp;</span> <span class="identifier">key</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span><span class="special">)</span>
<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
        <span class="special">(</span><span class="keyword">template</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">typename</span><span class="special">)(</span><span class="identifier">K</span><span class="special">)</span> <span class="special">(</span><span class="keyword">typename</span><span class="special">)(</span><span class="identifier">T</span><span class="special">)</span> <span class="special">)</span>
        <span class="comment">// Commas within another type expression.</span>
        <span class="bold"><strong>(std::map&lt;K, T&gt;)</strong></span> <span class="special">(</span><span class="identifier">set</span><span class="special">)(</span> 
                <span class="comment">// Commas within a type expression.</span>
                <span class="bold"><strong>(const std::map&lt;K, T&gt;&amp;)</strong></span><span class="special">(</span><span class="identifier">source</span><span class="special">)</span>
                <span class="special">(</span><span class="keyword">const</span> <span class="identifier">K</span><span class="special">&amp;)(</span><span class="identifier">key</span><span class="special">)</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)(</span><span class="identifier">element</span><span class="special">)</span> <span class="special">)</span>
<span class="special">(</span><span class="identifier">precondition</span><span class="special">)</span> <span class="special">({</span>
    <span class="comment">// Commas within a value expression.</span>
    <span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="bold"><strong>std::map&lt;K, T&gt;().empty()</strong></span> <span class="special">);</span>
<span class="special">})</span>
<span class="special">(</span><span class="identifier">body</span><span class="special">)</span> <span class="special">({</span>
    <span class="special">...</span>
<span class="special">})</span> <span class="special">)</span>
</pre>
<a name="contract__.tutorial.commas_within_macro_parameters.value_expressions"></a><h6>
<a name="contract__.tutorial.commas_within_macro_parameters.value_expressions-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.commas_within_macro_parameters.value_expressions">Value
        Expressions</a>
      </h6>
<p>
        The example above will <span class="emphasis"><em>not</em></span> compile because the preprocessor
        will interpret the expression:
      </p>
<pre class="programlisting"><span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;().</span><span class="identifier">empty</span><span class="special">()</span> <span class="special">);</span>
</pre>
<p>
        as a call to the macro <code class="computeroutput"><a href="../CONTRACT_ASSERT.html" target="_top">CONTRACT_ASSERT</a><span class="special">()</span></code> passing <span class="emphasis"><em>two</em></span> parameters
        separated by the comma:
      </p>
<pre class="programlisting"><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span>    <span class="comment">// 1st macro parameter.</span>
<span class="identifier">T</span><span class="special">&gt;().</span><span class="identifier">empty</span><span class="special">()</span>  <span class="comment">// 2nd macro parameter.</span>
</pre>
<p>
        Because <code class="computeroutput"><a href="../CONTRACT_ASSERT.html" target="_top">CONTRACT_ASSERT</a><span class="special">()</span></code> takes only one parameter, the above code
        will generate a preprocessing error.
      </p>
<p>
        The expressions <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;().</span><span class="identifier">empty</span><span class="special">()</span></code> is interpreted by the compiler as a value
        expression (it will be either be <code class="computeroutput"><span class="keyword">true</span></code>
        or <code class="computeroutput"><span class="keyword">false</span></code>). Value expressions
        can be wrapped by an extra set of parenthesis <code class="computeroutput"><span class="special">()</span></code>
        when passed as macro parameters. The following will compile:
      </p>
<pre class="programlisting"><span class="identifier">CONTRACT_ASSERT</span><span class="special">(</span> <span class="bold"><strong>(</strong></span><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;().</span><span class="identifier">empty</span><span class="special">()</span><span class="bold"><strong>)</strong></span> <span class="special">);</span>
</pre>
<a name="contract__.tutorial.commas_within_macro_parameters.type_expressions"></a><h6>
<a name="contract__.tutorial.commas_within_macro_parameters.type_expressions-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.commas_within_macro_parameters.type_expressions">Type
        Expressions</a>
      </h6>
<p>
        A similar issue arises for the preprocessor sequence element:
      </p>
<pre class="programlisting"><span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;)</span>
</pre>
<p>
        which will be interpreted as composed of 2 parameters separated by the comma
        (i.e., as a <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
        2-tuple instead than an element of a <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
        sequence):
      </p>
<pre class="programlisting"><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">T</span>  <span class="comment">// 1st macro parameter.</span>
<span class="identifier">T</span><span class="special">&gt;</span>          <span class="comment">// 2nd macro parameter.</span>
</pre>
<p>
        However, in this case the expression <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;</span></code> needs to be interpreted by the compiler
        as a type expression (indeed the type <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;</span></code>) and it cannot be wrapped by the extra
        parenthesis <code class="computeroutput"><span class="special">()</span></code>. In fact, depending
        on the context where they are used, types wrapped within parenthesis can
        generate compiler-time syntactic errors.
      </p>
<p>
        In order to wrap the type expression within parenthesis <code class="computeroutput"><span class="special">()</span></code>
        that can be parsed correctly by the preprocessor and interpreted correctly
        the compiler, first we created a void-function type that contains the type
        expression as the function only argument type:
      </p>
<pre class="programlisting"><span class="keyword">void</span><span class="bold"><strong>(</strong></span><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;</span><span class="bold"><strong>)</strong></span>  <span class="comment">// Function type (wraps comma within parenthesis).</span>
</pre>
<p>
        Then, we apply the library metafunction <code class="computeroutput"><span class="identifier">contract</span><span class="special">::</span><a href="../contract/wrap.html" target="_top">wrap</a></code>
        that returns the type of the first argument of the specified void-function
        type:
      </p>
<pre class="programlisting"><span class="identifier">contract</span><span class="special">::</span><span class="identifier">wrap</span><span class="special">&lt;</span><span class="keyword">void</span><span class="bold"><strong>(</strong></span><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;</span><span class="bold"><strong>)</strong></span><span class="special">&gt;::</span><span class="identifier">type</span>  <span class="comment">// Evaluates to the type `std::map&lt;K, T&gt;`.</span>
</pre>
<p>
        For convenience, the library provides the macro <code class="computeroutput"><a href="../CONTRACT_WRAP_TYPE.html" target="_top">CONTRACT_WRAP_TYPE</a><span class="special">()</span></code> which expands to the code above:
      </p>
<pre class="programlisting"><span class="identifier">CONTRACT_WRAP_TYPE</span><span class="special">(</span> <span class="bold"><strong>(</strong></span><span class="identifier">std</span><span class="special">::</span><span class="identifier">macp</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;</span><span class="bold"><strong>)</strong></span> <span class="special">)</span>
</pre>
<p>
        Note the extra parenthesis <code class="computeroutput"><span class="special">()</span></code>
        similar to what it was used for value expression.
      </p>
<a name="contract__.tutorial.commas_within_macro_parameters.body_code_block"></a><h6>
<a name="contract__.tutorial.commas_within_macro_parameters.body_code_block-heading"></a>
        <a class="link" href="tutorial.html#contract__.tutorial.commas_within_macro_parameters.body_code_block">Body
        Code Block</a>
      </h6>
<p>
        Finally, both techniques are applied to eventual commas within code blocks
        depending if the code is a value or type expression.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          However, if the body definition is separated from the contract declaration
          then the body code does not appear within a macro parameter so there is
          no need to implement these workarounds in the body code.
        </p></td></tr>
</table></div>
<p>
        Applying these techniques to the example above, we obtain the following code
        which compiles:
      </p>
<p>
        
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
<span class="special">(</span><span class="keyword">template</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">typename</span><span class="special">)(</span><span class="identifier">K</span><span class="special">)</span> <span class="special">(</span><span class="keyword">typename</span><span class="special">)(</span><span class="identifier">T</span><span class="special">)</span> <span class="special">)</span>
<span class="comment">// Commas within type expression using `IDENTITY_TYPE` macro.</span>
<span class="special">(</span><span class="keyword">typename</span> <span class="identifier">CONTRACT_IDENTITY_TYPE</span><span class="special">((</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;)))</span> <span class="special">(</span><span class="identifier">set</span><span class="special">)(</span> 
        <span class="comment">// Or directly using the `identity_type` metafunction.</span>
        <span class="special">(</span><span class="keyword">typename</span> <span class="identifier">contract</span><span class="special">::</span><span class="identifier">identity_type</span><span class="special">&lt;</span><span class="keyword">void</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;&amp;)</span> <span class="special">&gt;::</span><span class="identifier">type</span><span class="special">)</span>
                <span class="special">(</span><span class="identifier">source</span><span class="special">)</span>
        <span class="special">(</span><span class="keyword">const</span> <span class="identifier">K</span><span class="special">&amp;)(</span><span class="identifier">key</span><span class="special">)</span>
        <span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)(</span><span class="identifier">element</span><span class="special">)</span>
    <span class="special">)</span>
    <span class="special">(</span><span class="identifier">precondition</span><span class="special">)</span> <span class="special">(</span>
        <span class="comment">// Commas within value expressions must be wrapped by `()` using</span>
        <span class="comment">// `bool()` (or `contract::identity()`).</span>
        <span class="special">(</span><span class="keyword">bool</span><span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;().</span><span class="identifier">empty</span><span class="special">()))</span>
    <span class="special">)</span>
<span class="special">({</span>
    <span class="comment">// Commas within code blocks use same workarounds as above</span>
    <span class="comment">// wrapping differently commas within type or value expressions. </span>
    <span class="comment">// Or better, separate body definition so it is outside the macro.</span>

    <span class="comment">// OK, commas already wrapped by function call `()`.</span>
    <span class="identifier">print</span><span class="special">(</span><span class="identifier">key</span><span class="special">,</span> <span class="identifier">element</span><span class="special">);</span>
    
    <span class="comment">// Commas within type expression wrapped using the macro.</span>
    <span class="keyword">typename</span> <span class="identifier">CONTRACT_IDENTITY_TYPE</span><span class="special">((</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;))</span> <span class="identifier">m</span> <span class="special">=</span> <span class="identifier">source</span><span class="special">;</span>
    
    <span class="comment">// OK, commas already wrapped by if-statement `()`.</span>
    <span class="keyword">if</span> <span class="special">(</span><span class="number">0</span> <span class="special">==</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="identifier">K</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&gt;().</span><span class="identifier">empty</span><span class="special">())</span> <span class="identifier">m</span><span class="special">[</span><span class="identifier">key</span><span class="special">]</span> <span class="special">=</span> <span class="identifier">element</span><span class="special">;</span>
    
    <span class="keyword">return</span> <span class="identifier">m</span><span class="special">;</span>
<span class="special">})</span> <span class="special">)</span>

</pre>
<p>
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.a_fully_working_example"></a><a class="link" href="tutorial.html#contract__.tutorial.a_fully_working_example" title="A Fully Working Example">A Fully
      Working Example</a>
</h3></div></div></div>
<p>
        We conclude this section with a fully working example that can be compiled.
        This example illustrates how to use the library contract macros to program
        contracts in all the different library usages scenarios (constructor, destructors,
        member functions, non-member functions, template functions, etc).
      </p>
<p>
        For simplicity, this example only exposes a limited subset of the <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span></code>
        operations and it only programs simple contracts for them (see the STL Vector
        <a class="link" href="examples.html" title="Examples">Example</a> for complete contracts
        of all <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span></code> operations). Furthermore, the somewhat
        artificial base classes have been deliberately introduced to illustrate subcontracting
        and they will probably not be part of real code.
      </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Contract++ Syntax (supported for ISO C++ standard)
                </p>
              </th>
<th>
                <p>
                  N-Paper Proposal Syntax (not part of any C++ standard)
                </p>
              </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="string">"pushable.hpp"</span>             <span class="comment">// Base classes for subcontracting.</span>
<span class="preprocessor">#include</span> <span class="string">"boundable.hpp"</span>
<span class="preprocessor">#include</span> <span class="string">"basic_begin.hpp"</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">contract</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>             <span class="comment">// This library.</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">type_traits</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>    <span class="comment">// For static assertion condition.</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">concept_check</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>  <span class="comment">// Concepts for `(requires)`.</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">parameter</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>      <span class="comment">// Named parameters `(in)/(inout)/(out)`.</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">utility</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>        <span class="comment">// For `boost::prior()`.</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">mpl</span><span class="special">/</span><span class="keyword">bool</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>       <span class="comment">// For static assertion `true_`.</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">vector</span><span class="special">&gt;</span>                   <span class="comment">// STL vector.</span>

<span class="comment">// Use importance ordering to specify assertion computational complexity.</span>
<span class="preprocessor">#define</span> <span class="identifier">O_1</span>     <span class="number">0</span> <span class="comment">// Constant O(1) (default importance ordering).</span>
<span class="preprocessor">#define</span> <span class="identifier">O_LOGN</span>  <span class="number">1</span> <span class="comment">// Logaritmic O(log n).</span>
<span class="preprocessor">#define</span> <span class="identifier">O_N</span>     <span class="number">2</span> <span class="comment">// Linear O(n).</span>
    
<span class="comment">// Wrapper that adds simple (not complete) contracts to C++ STL illustrating</span>
<span class="comment">// most library usages. For simplicity, assume T is comparable and copyable.</span>
<span class="identifier">CONTRACT_CLASS</span><span class="special">(</span>
<span class="keyword">template</span><span class="special">(</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">)</span>
<span class="keyword">class</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)</span>
    <span class="identifier">extends</span><span class="special">(</span> <span class="comment">// Subcontract from base classes (support multiple inheritance).</span>
        <span class="keyword">public</span> <span class="identifier">pushable</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;,</span>
        <span class="keyword">public</span> <span class="identifier">boundable</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span><span class="special">&gt;,</span>
        <span class="keyword">private</span> <span class="identifier">basic_begin</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span><span class="special">&gt;</span>
    <span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="comment">// Class invariants (checked by any function with a contract).</span>
    <span class="identifier">CONTRACT_CLASS_INVARIANT</span><span class="special">(</span> <span class="comment">// Optional and they can access object.</span>
        <span class="identifier">empty</span><span class="special">()</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span><span class="special">),</span>
        <span class="keyword">static</span> <span class="keyword">sizeof</span><span class="special">(</span><span class="identifier">T</span><span class="special">)</span> <span class="special">&gt;</span> <span class="number">0</span> <span class="comment">// Also static assertions.</span>
        <span class="comment">// More class invariants here...</span>
    <span class="special">)</span>

    <span class="comment">// Static class invariants (checked by any function with a contract).</span>
    <span class="identifier">CONTRACT_STATIC_CLASS_INVARIANT</span><span class="special">(</span> <span class="comment">// Optional and cannot access the object.</span>
        <span class="keyword">true</span>
        <span class="comment">// More static class invaraints here...</span>
    <span class="special">)</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">size_type</span> <span class="identifier">size_type</span><span class="special">;</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">iterator</span> <span class="identifier">iterator</span><span class="special">;</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span> <span class="identifier">const_iterator</span><span class="special">;</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_reference</span> <span class="identifier">const_reference</span><span class="special">;</span>

    <span class="comment">// Contract for constructor plus default parameter values.</span>
    <span class="identifier">CONTRACT_CONSTRUCTOR</span><span class="special">(</span> 
    <span class="keyword">public</span> <span class="keyword">explicit</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">size_type</span><span class="special">)</span> <span class="identifier">count</span><span class="special">,</span> <span class="keyword">default</span> <span class="number">0</span> <span class="special">)</span>
        <span class="identifier">initialize</span><span class="special">(</span> <span class="identifier">vector_</span><span class="special">(</span><span class="identifier">count</span><span class="special">)</span> <span class="special">)</span> <span class="comment">// Member initializers.</span>
        <span class="comment">// Never object `this` in constructor preconditions.</span>
        <span class="comment">// Never `CONTRACT_OLDOF(this)` in constructor postconditions.</span>
        <span class="identifier">postcondition</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">count</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="comment">// Do nothing in this example.</span>
    <span class="special">}</span>

    <span class="comment">// Contractor for overloaded member (resolved by argumnet name).</span>
    <span class="identifier">CONTRACT_CONSTRUCTOR</span><span class="special">(</span> 
    <span class="keyword">public</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&amp;)</span> <span class="identifier">right</span> <span class="special">)</span>
        <span class="identifier">postcondition</span><span class="special">(</span> <span class="identifier">vector_</span> <span class="special">==</span> <span class="identifier">right</span><span class="special">.</span><span class="identifier">vector_</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">;</span> <span class="comment">// The `;` deferres body definition.</span>

    <span class="comment">// Contract for destructor.</span>
    <span class="identifier">CONTRACT_DESTRUCTOR</span><span class="special">(</span> 
    <span class="comment">// No `~` in destructor name.</span>
    <span class="comment">// Use `(void)` for empty function paramters.</span>
    <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">)()</span>
        <span class="comment">// No preconditions allowed (no arguments).</span>
        <span class="comment">// No postconditions allowed (no object after destructor).</span>
    <span class="special">)</span> <span class="special">;</span>

    <span class="comment">// Contract for member function, plus old values, plus assertion importance.</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="special">(</span><span class="identifier">insert</span><span class="special">)(</span> <span class="comment">// Multiple function parameters.</span>
            <span class="special">(</span><span class="identifier">iterator</span><span class="special">)</span> <span class="identifier">where</span><span class="special">,</span> <span class="special">(</span><span class="identifier">size_type</span><span class="special">)</span> <span class="identifier">count</span><span class="special">,</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)</span> <span class="identifier">element</span> <span class="special">)</span>
        <span class="identifier">precondition</span><span class="special">(</span> <span class="comment">// Function preconditions (optional).</span>
            <span class="identifier">max_size</span><span class="special">()</span> <span class="special">&gt;=</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">+</span> <span class="identifier">count</span>
            <span class="comment">// More preconditions here...</span>
        <span class="special">)</span>
        <span class="comment">// Function postconditions (optional). Old value expressions must have</span>
        <span class="comment">// different stringetized lengths.</span>
        <span class="identifier">postcondition</span><span class="special">(</span>
            <span class="keyword">auto</span> <span class="identifier">old_capacity</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="identifier">capacity</span><span class="special">()),</span> <span class="comment">// Use Boost.Typeof.</span>
            <span class="special">(</span><span class="identifier">iterator</span><span class="special">)</span> <span class="identifier">old_where</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="identifier">where</span><span class="special">),</span> <span class="comment">// No Typeof.</span>
            <span class="keyword">if</span><span class="special">(</span><span class="identifier">capacity</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">old_capacity</span><span class="special">)</span> <span class="special">(</span>
                <span class="comment">// Importance ordering specify assertion has linear complexity.</span>
                <span class="identifier">all_equals</span><span class="special">(</span><span class="identifier">boost</span><span class="special">::</span><span class="identifier">prior</span><span class="special">(</span><span class="identifier">old_where</span><span class="special">),</span>
                        <span class="identifier">boost</span><span class="special">::</span><span class="identifier">prior</span><span class="special">(</span><span class="identifier">old_where</span><span class="special">)</span> <span class="special">+</span> <span class="identifier">count</span><span class="special">,</span> <span class="identifier">element</span><span class="special">),</span>
                        <span class="identifier">importance</span> <span class="identifier">O_N</span>
            <span class="special">)</span> <span class="comment">// Optional `(else ...)` allowed here.</span>
            <span class="comment">// More postconditions here...</span>
        <span class="special">)</span>
    <span class="special">)</span> <span class="special">{</span> <span class="comment">// Original function implementation.</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span><span class="identifier">where</span><span class="special">,</span> <span class="identifier">count</span><span class="special">,</span> <span class="identifier">element</span><span class="special">);</span>
    <span class="special">}</span>

    <span class="comment">// Contract for constant member.</span>
    <span class="comment">// Non-void result type.</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="keyword">public</span> <span class="special">(</span><span class="identifier">const_iterator</span><span class="special">)</span> <span class="special">(</span><span class="identifier">begin</span><span class="special">)()</span> <span class="keyword">const</span> <span class="comment">// Constant.</span>
        <span class="identifier">postcondition</span><span class="special">(</span>
            <span class="keyword">auto</span> <span class="identifier">result</span> <span class="special">=</span> <span class="keyword">return</span><span class="special">,</span> <span class="comment">// Return value named `result`.</span>
            <span class="keyword">if</span><span class="special">(</span><span class="identifier">empty</span><span class="special">())</span> <span class="special">(</span> <span class="identifier">result</span> <span class="special">==</span> <span class="identifier">end</span><span class="special">()</span> <span class="special">)</span>
        <span class="special">)</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">begin</span><span class="special">();</span>
    <span class="special">}</span>
    
    <span class="comment">// Contract for overloaded member (resolved because not const).</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> 
    <span class="keyword">public</span> <span class="special">(</span><span class="identifier">iterator</span><span class="special">)</span> <span class="special">(</span><span class="identifier">begin</span><span class="special">)()</span>
        <span class="identifier">postcondition</span><span class="special">(</span>
            <span class="keyword">auto</span> <span class="identifier">iter</span> <span class="special">=</span> <span class="keyword">return</span><span class="special">,</span> <span class="comment">// Return value namded `iter`.</span>
            <span class="keyword">if</span><span class="special">(</span><span class="identifier">empty</span><span class="special">())</span> <span class="special">(</span> <span class="identifier">iter</span> <span class="special">==</span> <span class="identifier">end</span><span class="special">()</span> <span class="special">)</span>
        <span class="special">)</span>
    <span class="special">)</span> <span class="special">;</span>
 
    <span class="comment">// Contract for operator, plus static assertion.</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="comment">// Must spell operator name also in words (e.g., `at`).</span>
    <span class="keyword">public</span> <span class="special">(</span><span class="identifier">const_reference</span><span class="special">)</span> <span class="keyword">operator</span><span class="special">([],</span> <span class="identifier">at</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">size_type</span><span class="special">)</span> <span class="identifier">index</span> <span class="special">)</span> <span class="keyword">const</span>
        <span class="identifier">precondition</span><span class="special">(</span>
            <span class="identifier">index</span> <span class="special">&lt;</span> <span class="identifier">size</span><span class="special">(),</span>
            <span class="comment">// Static assertion (checked at compile-time).</span>
            <span class="keyword">static</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">has_nothrow_default_constructor</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">value</span>
        <span class="special">)</span>
    <span class="special">)</span> <span class="special">;</span>

    <span class="comment">// Main function example used in documentation.</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> 
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="special">(</span><span class="identifier">push_back</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)</span> <span class="identifier">element</span> <span class="special">)</span>
        <span class="identifier">precondition</span><span class="special">(</span>
            <span class="keyword">static</span> <span class="keyword">false</span><span class="special">,</span> <span class="comment">// Static assertion checked at compile-time.</span>
            <span class="comment">// This precondition has no effect because subcontracts from</span>
            <span class="comment">// `pushable::push_back()` which has no preconditions (this</span>
            <span class="comment">// might be confusing and it is not allowed by [N1962]).</span>
            <span class="identifier">size</span><span class="special">()</span> <span class="special">&lt;</span> <span class="identifier">max_size</span><span class="special">()</span>
        <span class="special">)</span>
        <span class="identifier">postcondition</span><span class="special">(</span>
            <span class="keyword">static</span> <span class="keyword">true</span><span class="special">,</span>
            <span class="keyword">auto</span> <span class="identifier">old_size</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="identifier">size</span><span class="special">()),</span>
            <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">old_size</span> <span class="special">+</span> <span class="number">1</span>
        <span class="special">)</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">element</span><span class="special">);</span>
    <span class="special">}</span>

    <span class="comment">// Contract for template, plus static member function, plus concepts.</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> 
    <span class="keyword">public</span> <span class="keyword">template</span><span class="special">(</span> <span class="keyword">class</span> <span class="identifier">Iter</span> <span class="special">)</span> <span class="comment">// Function template.</span>
        <span class="comment">// Concepts (uses Boost.ConceptCheck).</span>
        <span class="identifier">requires</span><span class="special">(</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">InputIterator</span><span class="special">&lt;</span><span class="identifier">Iter</span><span class="special">&gt;,</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">EqualityComparable</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="special">)</span>
    <span class="comment">// Static member.</span>
    <span class="keyword">static</span> <span class="keyword">bool</span> <span class="special">(</span><span class="identifier">all_equals</span><span class="special">)(</span> <span class="special">(</span><span class="identifier">Iter</span><span class="special">)</span> <span class="identifier">first</span><span class="special">,</span> <span class="special">(</span><span class="identifier">Iter</span><span class="special">)</span> <span class="identifier">last</span><span class="special">,</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)</span> <span class="identifier">element</span> <span class="special">)</span>
        <span class="identifier">precondition</span><span class="special">(</span> <span class="identifier">first</span> <span class="special">&lt;</span> <span class="identifier">last</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="comment">// Loop variants with importance.</span>
        <span class="comment">/** @todo Do I need to specify importance for CONTRACT_LOOP so I can
         * not declare the variant variable to avoid the unused error? But
         * there should be another way to get rid of the unused error... maybe
         * use a special object (like for scoped_mutex that do not give the
         * unused error...). */</span>
        <span class="identifier">CONTRACT_LOOP</span><span class="special">(</span> <span class="keyword">for</span><span class="special">(</span><span class="identifier">Iter</span> <span class="identifier">i</span> <span class="special">=</span> <span class="identifier">first</span><span class="special">;</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="identifier">last</span><span class="special">;</span> <span class="special">++</span><span class="identifier">i</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
            <span class="identifier">CONTRACT_LOOP_VARIANT</span><span class="special">(</span> <span class="keyword">const</span><span class="special">(</span> <span class="identifier">last</span><span class="special">,</span> <span class="identifier">i</span> <span class="special">)</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">distance</span><span class="special">(</span><span class="identifier">last</span><span class="special">,</span> <span class="identifier">i</span><span class="special">),</span>
                    <span class="identifier">importance</span> <span class="identifier">O_N</span> <span class="special">)</span>

            <span class="keyword">if</span><span class="special">(*</span><span class="identifier">i</span> <span class="special">!=</span> <span class="identifier">element</span><span class="special">)</span> <span class="keyword">return</span> <span class="keyword">false</span><span class="special">;</span>
        <span class="special">}</span> <span class="identifier">CONTRACT_LOOP_END</span>
        <span class="keyword">return</span> <span class="keyword">true</span><span class="special">;</span>
    <span class="special">}</span>

    <span class="comment">// Similarly, complete contracts sketched here and add contracts</span>
    <span class="comment">// for all other functions (see [Crowl2006] vector example).</span>
    <span class="keyword">bool</span> <span class="identifier">empty</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">empty</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">size_type</span> <span class="identifier">size</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">size</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">size_type</span> <span class="identifier">max_size</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">max_size</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">size_type</span> <span class="identifier">capacity</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">capacity</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">iterator</span> <span class="identifier">end</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">end</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">const_iterator</span> <span class="identifier">end</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">end</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">const_reference</span> <span class="identifier">back</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">back</span><span class="special">();</span> <span class="special">}</span>

<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>
<span class="special">};</span>

<span class="comment">// Deferred constructor body definition.</span>
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">CONTRACT_CONSTRUCTOR_BODY</span><span class="special">(</span><span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;,</span> <span class="identifier">myvector</span><span class="special">)(</span> <span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&amp;</span> <span class="identifier">right</span> <span class="special">)</span> <span class="special">{</span>
    <span class="identifier">vector_</span> <span class="special">=</span> <span class="identifier">right</span><span class="special">.</span><span class="identifier">vector_</span><span class="special">;</span>
<span class="special">}</span>

<span class="comment">// Deferred destructor body definition.</span>
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">CONTRACT_DESTRUCTOR_BODY</span><span class="special">(</span><span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;,</span> <span class="identifier">myvector</span><span class="special">)()</span> <span class="special">{</span>
    <span class="comment">// Do nothing in this case.</span>
<span class="special">}</span>

<span class="comment">// Deferred member function definition.</span>
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">typename</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">iterator</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">CONTRACT_MEMBER_BODY</span><span class="special">(</span><span class="identifier">begin</span><span class="special">)()</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">begin</span><span class="special">();</span>
<span class="special">}</span>

<span class="comment">// Deferred member operator definition.</span>
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">typename</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_reference</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span>
        <span class="identifier">CONTRACT_MEMBER_BODY</span><span class="special">(</span><span class="keyword">operator</span><span class="special">([],</span> <span class="identifier">at</span><span class="special">))(</span> <span class="identifier">size_type</span> <span class="identifier">index</span> <span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">[</span><span class="identifier">index</span><span class="special">];</span>
<span class="special">}</span>

<span class="identifier">BOOST_PARAMETER_NAME</span><span class="special">(</span><span class="identifier">vector</span><span class="special">)</span>    <span class="comment">// Declare Boost.Parameter for `vector`.</span>

<span class="comment">// Contracts for free function plus named parameters (Boost.Parameter).</span>
<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
<span class="keyword">double</span> <span class="special">(</span><span class="identifier">abs_total</span><span class="special">)(</span> <span class="identifier">in</span> <span class="special">(</span><span class="identifier">myvector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;)</span> <span class="identifier">vector</span> <span class="special">)</span> <span class="comment">// Named input parameter.</span>
    <span class="identifier">postcondition</span><span class="special">(</span> <span class="keyword">auto</span> <span class="identifier">result</span> <span class="special">=</span> <span class="keyword">return</span><span class="special">,</span> <span class="identifier">result</span> <span class="special">&gt;=</span> <span class="number">0.0</span> <span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="keyword">double</span> <span class="identifier">total</span> <span class="special">=</span> <span class="number">0.0</span><span class="special">;</span>
    <span class="comment">// Block invariants can appear anywhere in code block.</span>
    <span class="identifier">CONTRACT_BLOCK_INVARIANT</span><span class="special">(</span> <span class="keyword">const</span><span class="special">(</span> <span class="identifier">total</span> <span class="special">)</span> <span class="identifier">total</span> <span class="special">==</span> <span class="number">0.0</span> <span class="special">)</span>
    <span class="comment">// Block invariants assertions can be static and can have importance.</span>
    <span class="identifier">CONTRACT_BLOCK_INVARIANT</span><span class="special">(</span> <span class="keyword">static</span> <span class="keyword">sizeof</span><span class="special">(</span><span class="keyword">double</span><span class="special">)</span> <span class="special">&gt;</span> <span class="number">0</span><span class="special">,</span> <span class="identifier">importance</span> <span class="identifier">O_1</span> <span class="special">)</span>

    <span class="identifier">CONTRACT_LOOP</span><span class="special">(</span> <span class="keyword">for</span><span class="special">(</span><span class="identifier">size_t</span> <span class="identifier">i</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="identifier">vector</span><span class="special">.</span><span class="identifier">size</span><span class="special">();</span> <span class="special">++</span><span class="identifier">i</span><span class="special">)</span> <span class="special">)</span> <span class="special">{</span>
        <span class="comment">// Block invariants can assert loop invariants (also w/ importance).</span>
        <span class="comment">// For simplicity, constant-assertion is not used when assertion is</span>
        <span class="comment">// clearly a constant-expression (it is programmers' responsibility).</span>
        <span class="identifier">CONTRACT_BLOCK_INVARIANT</span><span class="special">(</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="identifier">vector</span><span class="special">.</span><span class="identifier">size</span><span class="special">()</span> <span class="special">)</span>
        <span class="comment">// Loop variant (can only appear in loops and cannot be static).</span>
        <span class="identifier">CONTRACT_LOOP_VARIANT</span><span class="special">(</span> <span class="keyword">const</span><span class="special">(</span> <span class="identifier">vector</span><span class="special">,</span> <span class="identifier">i</span> <span class="special">)</span> <span class="identifier">vector</span><span class="special">.</span><span class="identifier">size</span><span class="special">()</span> <span class="special">-</span> <span class="identifier">i</span> <span class="special">)</span>

        <span class="identifier">total</span> <span class="special">+=</span> <span class="identifier">vector</span><span class="special">[</span><span class="identifier">i</span><span class="special">];</span>
    <span class="special">}</span> <span class="identifier">CONTRACT_LOOP_END</span>

    <span class="keyword">return</span> <span class="identifier">total</span> <span class="special">&lt;</span> <span class="number">0.0</span> <span class="special">?</span> <span class="special">-</span><span class="identifier">total</span> <span class="special">:</span> <span class="identifier">total</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="comment">// Extra spaces, newlines, public, etc to better align code with library syntax.</span>
<span class="preprocessor">#include</span> <span class="string">"puchable.hpp"</span>
<span class="preprocessor">#include</span> <span class="string">"boundable.hpp"</span>
<span class="preprocessor">#include</span> <span class="string">"basic_begin.hpp"</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">concepts</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">vector</span><span class="special">&gt;</span>






<span class="preprocessor">#define</span> <span class="identifier">O_1</span>     <span class="number">0</span>
<span class="preprocessor">#define</span> <span class="identifier">O_LOGN</span>  <span class="number">1</span>
<span class="preprocessor">#define</span> <span class="identifier">O_N</span>     <span class="number">2</span>




<span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">myvector</span>
    <span class="special">:</span>
        <span class="keyword">public</span> <span class="identifier">pushable</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;,</span>
        <span class="keyword">public</span> <span class="identifier">boundable</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span><span class="special">&gt;,</span>
        <span class="keyword">private</span> <span class="identifier">basic_begin</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span><span class="special">&gt;</span>

<span class="special">{</span>

    <span class="identifier">invariant</span> <span class="special">{</span>
        <span class="identifier">empty</span><span class="special">()</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span><span class="special">);</span>
        <span class="keyword">static</span> <span class="keyword">sizeof</span><span class="special">(</span><span class="identifier">T</span><span class="special">)</span> <span class="special">&gt;</span> <span class="number">0</span><span class="special">;</span> <span class="comment">// Static assertions not in [N1962] but in [1866].</span>

    <span class="special">}</span>

    
    <span class="keyword">static</span> <span class="identifier">invariant</span> <span class="special">{</span> <span class="comment">// Static class invariants not in [N1962], etc.</span>
        <span class="keyword">true</span><span class="special">;</span>
    
    <span class="special">}</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">size_type</span> <span class="identifier">size_type</span><span class="special">;</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">iterator</span> <span class="identifier">iterator</span><span class="special">;</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span> <span class="identifier">const_iterator</span><span class="special">;</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_reference</span> <span class="identifier">const_reference</span><span class="special">;</span>



    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">explicit</span> <span class="identifier">myvector</span><span class="special">(</span> <span class="identifier">size_type</span> <span class="identifier">count</span> <span class="special">=</span> <span class="number">0</span> <span class="special">)</span>
        <span class="special">:</span> <span class="identifier">vector_</span><span class="special">(</span><span class="identifier">count</span><span class="special">)</span>


        <span class="identifier">postcondition</span> <span class="special">{</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">count</span><span class="special">;</span> <span class="special">}</span>
    <span class="special">{</span>
    
    <span class="special">}</span>



    <span class="keyword">public</span><span class="special">:</span> <span class="identifier">myvector</span><span class="special">(</span> <span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&amp;</span> <span class="identifier">right</span> <span class="special">)</span>
        <span class="identifier">postcondition</span> <span class="special">{</span> <span class="identifier">vector_</span> <span class="special">==</span> <span class="identifier">right</span><span class="special">.</span><span class="identifier">vector_</span><span class="special">;</span> <span class="special">}</span>
    

    
    
    
    
    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">virtual</span> <span class="special">~</span><span class="identifier">myvector</span><span class="special">()</span>
            
            
    <span class="special">;</span>


    
    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">void</span> <span class="identifier">insert</span><span class="special">(</span>
            <span class="identifier">iterator</span> <span class="identifier">where</span><span class="special">,</span> <span class="identifier">size_type</span> <span class="identifier">count</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span> <span class="special">)</span>
        <span class="identifier">precondition</span> <span class="special">{</span>
            <span class="identifier">max_size</span><span class="special">()</span> <span class="special">&gt;=</span> <span class="special">(</span><span class="identifier">size</span><span class="special">()</span> <span class="special">+</span> <span class="identifier">count</span><span class="special">);</span>
        
        <span class="special">}</span>


        <span class="identifier">postcondition</span> <span class="special">{</span>


            <span class="keyword">if</span> <span class="special">(</span><span class="identifier">capactiy</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">oldof</span> <span class="identifier">capacity</span><span class="special">())</span> <span class="special">{</span>

                <span class="identifier">all_equals</span><span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">prior</span><span class="special">(</span><span class="identifier">oldof</span> <span class="identifier">where</span><span class="special">),</span>
                        <span class="identifier">std</span><span class="special">::</span><span class="identifier">prior</span><span class="special">(</span><span class="identifier">oldof</span> <span class="identifier">where</span><span class="special">)</span> <span class="special">+</span> <span class="identifier">count</span><span class="special">,</span> <span class="identifier">element</span><span class="special">)</span>
                        <span class="special">:</span> <span class="identifier">O_N</span><span class="special">;</span> <span class="comment">// Importance ordering from [N1866].</span>
            <span class="special">}</span>

        <span class="special">}</span>
    <span class="special">{</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span><span class="identifier">where</span><span class="special">,</span> <span class="identifier">count</span><span class="special">,</span> <span class="identifier">element</span><span class="special">);</span>
    <span class="special">}</span>




    <span class="keyword">public</span><span class="special">:</span> <span class="identifier">const_iterator</span> <span class="identifier">begin</span><span class="special">()</span> <span class="keyword">const</span>
        <span class="identifier">postcondition</span><span class="special">(</span> <span class="identifier">result</span> <span class="special">)</span> <span class="special">{</span>
            
            <span class="keyword">if</span><span class="special">(</span><span class="identifier">empty</span><span class="special">())</span> <span class="special">{</span> <span class="identifier">result</span> <span class="special">==</span> <span class="identifier">end</span><span class="special">();</span> <span class="special">}</span>
        <span class="special">}</span>
    <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">begin</span><span class="special">();</span>
    <span class="special">}</span>



    <span class="keyword">public</span><span class="special">:</span> <span class="identifier">iterator</span> <span class="identifier">begin</span><span class="special">()</span>
        <span class="identifier">postcondition</span><span class="special">(</span> <span class="identifier">iter</span> <span class="special">)</span> <span class="special">{</span>

            <span class="keyword">if</span><span class="special">(</span><span class="identifier">empty</span><span class="special">())</span> <span class="special">{</span> <span class="identifier">iter</span> <span class="special">==</span> <span class="identifier">end</span><span class="special">();</span> <span class="special">}</span>
        <span class="special">}</span>
    <span class="special">;</span>




    <span class="keyword">public</span><span class="special">:</span> <span class="identifier">const_reference</span> <span class="keyword">operator</span><span class="special">[](</span> <span class="identifier">size_type</span> <span class="identifier">index</span> <span class="special">)</span> <span class="keyword">const</span>
        <span class="identifier">precondition</span> <span class="special">{</span>
            <span class="identifier">index</span> <span class="special">&lt;</span> <span class="identifier">size</span><span class="special">();</span>

            <span class="keyword">static</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">has_nothrow_default_constructor</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">value</span><span class="special">;</span>
        <span class="special">}</span>
    <span class="special">;</span>



    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">void</span> <span class="identifier">push_back</span><span class="special">(</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span> <span class="special">)</span>
        <span class="identifier">precondition</span> <span class="special">{</span>
            <span class="keyword">static</span> <span class="keyword">false</span><span class="special">;</span>



            <span class="identifier">size</span><span class="special">()</span> <span class="special">&lt;</span> <span class="identifier">max_size</span><span class="special">();</span>
        <span class="special">}</span>
        <span class="identifier">postcondition</span> <span class="special">{</span>
            <span class="keyword">static</span> <span class="keyword">true</span><span class="special">;</span>

            <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">oldof</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">+</span> <span class="number">1</span><span class="special">;</span>
        <span class="special">}</span>
    <span class="special">{</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">element</span><span class="special">);</span>
    <span class="special">}</span>



    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">class</span> <span class="identifier">Iter</span> <span class="special">&gt;</span>

        <span class="identifier">requires</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">InputIterator</span><span class="special">&lt;</span><span class="identifier">Iter</span><span class="special">&gt;,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">EqualityComparable</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>

    <span class="keyword">static</span> <span class="keyword">bool</span> <span class="identifier">all_equals</span><span class="special">(</span> <span class="identifier">Iter</span> <span class="identifier">first</span><span class="special">,</span> <span class="identifier">Iter</span> <span class="identifier">last</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span> <span class="special">)</span>
        <span class="identifier">precondition</span> <span class="special">{</span> <span class="identifier">first</span> <span class="special">&lt;</span> <span class="identifier">last</span><span class="special">;</span> <span class="special">}</span>
    <span class="special">{</span>





        <span class="comment">// No loop invariant/variant in [N1963].</span>
        <span class="keyword">for</span><span class="special">(</span><span class="identifier">Iter</span> <span class="identifier">i</span> <span class="special">=</span> <span class="identifier">first</span><span class="special">;</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="identifier">last</span><span class="special">;</span> <span class="special">++</span><span class="identifier">i</span><span class="special">)</span> <span class="special">{</span>



            <span class="keyword">if</span><span class="special">(*</span><span class="identifier">i</span> <span class="special">!=</span> <span class="identifier">element</span><span class="special">)</span> <span class="keyword">return</span> <span class="keyword">false</span><span class="special">;</span>
        <span class="special">}</span>
        <span class="keyword">return</span> <span class="keyword">true</span><span class="special">;</span>
    <span class="special">}</span>

    
    
    <span class="keyword">bool</span> <span class="identifier">empty</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">empty</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">size_type</span> <span class="identifier">size</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">size</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">size_type</span> <span class="identifier">max_size</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">max_size</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">size_type</span> <span class="identifier">capacity</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">capacity</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">iterator</span> <span class="identifier">end</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">end</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">const_iterator</span> <span class="identifier">end</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">end</span><span class="special">();</span> <span class="special">}</span>
    <span class="identifier">const_reference</span> <span class="identifier">back</span><span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">back</span><span class="special">();</span> <span class="special">}</span>

<span class="keyword">private</span><span class="special">:</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>
<span class="special">};</span>


<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">myvector</span><span class="special">(</span> <span class="keyword">const</span> <span class="identifier">myvector</span><span class="special">&amp;</span> <span class="identifier">right</span> <span class="special">)</span> <span class="special">{</span>
    <span class="identifier">vector_</span> <span class="special">=</span> <span class="identifier">right</span><span class="special">.</span><span class="identifier">vector_</span><span class="special">;</span>
<span class="special">}</span>


<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::~</span><span class="identifier">myvector</span><span class="special">()</span> <span class="special">{</span>

<span class="special">}</span>


<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">typename</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">iterator</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">begin</span><span class="special">()</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">begin</span><span class="special">();</span>
<span class="special">}</span>


<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">typename</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_reference</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span>
        <span class="keyword">operator</span><span class="special">[](</span> <span class="identifier">size_type</span> <span class="identifier">index</span> <span class="special">)</span> <span class="keyword">const</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">vector_</span><span class="special">[</span><span class="identifier">index</span><span class="special">];</span>
<span class="special">}</span>




<span class="comment">// No named parameter (there is no C++ proposal that supports them).</span>
<span class="keyword">double</span> <span class="identifier">abs_total</span><span class="special">(</span> <span class="identifier">myvector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;&amp;</span> <span class="identifier">vector</span> <span class="special">)</span>
    <span class="identifier">poscondition</span><span class="special">(</span> <span class="identifier">result</span> <span class="special">)</span> <span class="special">{</span> <span class="identifier">result</span> <span class="special">&gt;=</span> <span class="number">0.0</span><span class="special">;</span> <span class="special">}</span>
<span class="special">{</span>
    <span class="keyword">double</span> <span class="identifier">total</span> <span class="special">=</span> <span class="number">0.0</span><span class="special">;</span>

    <span class="identifier">invariant</span> <span class="special">{</span> <span class="identifier">total</span> <span class="special">==</span> <span class="number">0.0</span><span class="special">;</span> <span class="special">}</span>
    
    <span class="identifier">invariant</span> <span class="special">{</span> <span class="keyword">static</span> <span class="keyword">sizeof</span><span class="special">(</span><span class="keyword">double</span><span class="special">)</span> <span class="special">&gt;</span> <span class="number">0</span> <span class="special">:</span> <span class="identifier">O_1</span> <span class="special">}</span> <span class="comment">// No proposal for `static`.</span>

    <span class="keyword">for</span><span class="special">(</span><span class="identifier">size_t</span> <span class="identifier">i</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="identifier">vector</span><span class="special">.</span><span class="identifier">size</span><span class="special">();</span> <span class="special">++</span><span class="identifier">i</span><span class="special">)</span> <span class="special">{</span>



        <span class="identifier">invariant</span> <span class="special">{</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="identifier">vector</span><span class="special">.</span><span class="identifier">size</span><span class="special">();</span> <span class="special">}</span>

        <span class="comment">// No proposal for loop variants.</span>

        <span class="identifier">total</span> <span class="special">+=</span> <span class="identifier">vector</span><span class="special">[</span><span class="identifier">i</span><span class="special">];</span>
    <span class="special">}</span>

    <span class="keyword">return</span> <span class="identifier">total</span> <span class="special">&lt;</span> <span class="number">0.0</span> <span class="special">?</span> <span class="special">-</span><span class="identifier">total</span> <span class="special">:</span> <span class="identifier">total</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">contract</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="identifier">CONTRACT_CLASS</span><span class="special">(</span>
<span class="keyword">template</span><span class="special">(</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">)</span>
<span class="keyword">class</span> <span class="special">(</span><span class="identifier">pushable</span><span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="comment">// No class invariants.</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">virtual</span> <span class="special">~</span><span class="identifier">pushable</span><span class="special">()</span> <span class="special">{}</span>

    <span class="comment">// Contract for pure virtual function.</span>
    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="special">(</span><span class="identifier">push_back</span><span class="special">)(</span> <span class="special">(</span><span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;)</span> <span class="identifier">element</span> <span class="special">)</span>
        <span class="comment">/** @todo No precondition here implies all preconditions of derived 
         * classes have no effect... */</span>
        <span class="identifier">postcondition</span><span class="special">(</span> <span class="identifier">back</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">element</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span> <span class="comment">// Pure virtual body.</span>

    <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">back</span><span class="special">()</span> <span class="keyword">const</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span>
<span class="special">};</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="comment">// Extra spaces, newlines, public, etc to better align code with library syntax.</span>


<span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">pushable</span>
<span class="special">{</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">virtual</span> <span class="special">~</span><span class="identifier">pushable</span><span class="special">()</span> <span class="special">{}</span>



    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="identifier">push_back</span><span class="special">(</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">element</span> <span class="special">)</span>
        

        <span class="identifier">postcondition</span> <span class="special">{</span> <span class="identifier">back</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">element</span><span class="special">;</span> <span class="special">}</span>
    <span class="special">=</span> <span class="number">0</span><span class="special">;</span>

    <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">back</span><span class="special">()</span> <span class="keyword">const</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span>
<span class="special">};</span>
</pre>
<p>
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">contract</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="identifier">CONTRACT_CLASS</span><span class="special">(</span>
<span class="keyword">template</span><span class="special">(</span> <span class="keyword">class</span> <span class="identifier">ConstIter</span> <span class="special">)</span>
<span class="keyword">class</span> <span class="special">(</span><span class="identifier">boundable</span><span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="identifier">CONTRACT_CLASS_INVARIANT</span><span class="special">(</span> <span class="identifier">begin</span><span class="special">()</span> <span class="special">&lt;=</span> <span class="identifier">end</span><span class="special">()</span> <span class="special">)</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">virtual</span> <span class="special">~</span><span class="identifier">boundable</span><span class="special">()</span> <span class="special">{}</span>

    <span class="keyword">virtual</span> <span class="identifier">ConstIter</span> <span class="identifier">begin</span><span class="special">()</span> <span class="keyword">const</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span>
    <span class="keyword">virtual</span> <span class="identifier">ConstIter</span> <span class="identifier">end</span><span class="special">()</span> <span class="keyword">const</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span>
<span class="special">};</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="comment">// Extra spaces, newlines, public, etc to better align code with library syntax.</span>


<span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">class</span> <span class="identifier">ConstIter</span> <span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">boundable</span>
<span class="special">{</span>
    <span class="identifier">invariant</span> <span class="special">{</span> <span class="identifier">begin</span><span class="special">()</span> <span class="special">&lt;=</span> <span class="identifier">end</span><span class="special">();</span> <span class="special">}</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">virtual</span> <span class="special">~</span><span class="identifier">boundable</span><span class="special">()</span> <span class="special">{}</span>

    <span class="keyword">virtual</span> <span class="identifier">ConstIter</span> <span class="identifier">begin</span><span class="special">()</span> <span class="keyword">const</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span>
    <span class="keyword">virtual</span> <span class="identifier">ConstIter</span> <span class="identifier">end</span><span class="special">()</span> <span class="keyword">const</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span>
<span class="special">};</span>
</pre>
<p>
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">contract</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="identifier">CONTRACT_CLASS</span><span class="special">(</span>
<span class="keyword">template</span><span class="special">(</span> <span class="keyword">class</span> <span class="identifier">ConstIter</span> <span class="special">)</span>
<span class="keyword">class</span> <span class="special">(</span><span class="identifier">basic_begin</span><span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="comment">// No class invariants.</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">virtual</span> <span class="special">~</span><span class="identifier">basic_begin</span><span class="special">()</span> <span class="special">{}</span>

    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> 
    <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="special">(</span><span class="identifier">ConstIter</span><span class="special">)</span> <span class="special">(</span><span class="identifier">begin</span><span class="special">)()</span> <span class="keyword">const</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">ConstIter</span><span class="special">();</span> <span class="comment">// Dummy implementation (for example only).</span>
    <span class="special">}</span>
<span class="special">};</span>
</pre>
<p>
                </p>
              </td>
<td>
                <p>
                  
</p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="comment">// Extra spaces, newlines, public, etc to better align code with library syntax.</span>


<span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">class</span> <span class="identifier">ConstIter</span> <span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">basic_begin</span>
<span class="special">{</span>

<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">virtual</span> <span class="special">~</span><span class="identifier">basic_begin</span><span class="special">()</span> <span class="special">{}</span>


    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">virtual</span> <span class="identifier">ConstIter</span> <span class="identifier">begin</span><span class="special">()</span> <span class="keyword">const</span>
    <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">ConstIter</span><span class="special">();</span>
    <span class="special">}</span>
<span class="special">};</span>
</pre>
<p>
                </p>
              </td>
</tr>
</tbody>
</table></div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div class="footnote"><p><sup>[<a id="ftn.id866548" href="#id866548" class="para">2</a>] </sup>
              Static member functions cannot be virtual so they cannot be overridden
              and they cannot subcontract.
            </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id866910" href="#id866910" class="para">3</a>] </sup>
              However, the destructor body should be programmed to <span class="emphasis"><em>never</em></span>
              throw exceptions to comply with C++ STL exception safety requirements.
            </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id867338" href="#id867338" class="para">4</a>] </sup>
          As usual in C++, constant-correctness can be enforced at compile-time only
          as long as programmers do not use <code class="computeroutput"><span class="keyword">const_cast</span></code>
          and <code class="computeroutput"><span class="keyword">mutable</span></code>.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id867464" href="#id867464" class="para">5</a>] </sup>
          To improve contract readability, it is recommended to configure your editor
          C++ syntax highlighting to highlight also the macros <code class="computeroutput"><span class="identifier">CONTRACT_INVARIANT</span></code>,
          <code class="computeroutput"><span class="identifier">CONTRACT_FUNCTION</span></code>, <code class="computeroutput"><span class="identifier">CONTRACT_CONSTRUCTOR</span></code>, <code class="computeroutput"><span class="identifier">CONTRACT_DESTRUCTOR</span></code>,
          <code class="computeroutput"><span class="identifier">CONTRACT_OLDOF</span></code>, <code class="computeroutput"><span class="identifier">CONTRACT_BODY</span></code>, <code class="computeroutput"><span class="identifier">CONTRACT_CONSTRUCTOR_BODY</span></code>,
          <code class="computeroutput"><span class="identifier">CONTRACT_DESTRUCTOR_BODY</span></code>,
          <code class="computeroutput"><span class="identifier">CONTRACT_ASSERT</span></code>, <code class="computeroutput"><span class="identifier">CONTRACT_ASSERT_MSG</span></code>, <code class="computeroutput"><span class="identifier">CONTRACT_ASSERT_BLOCK_INVARIANT</span></code>,
          <code class="computeroutput"><span class="identifier">CONTRACT_ASSERT_BLOCK_INVARIANT_MSG</span></code>,
          <code class="computeroutput"><span class="identifier">CONTRACT_ASSERT_LOOP_VARIANT</span></code>,
          <code class="computeroutput"><span class="identifier">CONTRACT_ASSERT_LOOP_VARIANT_MSG</span></code>,
          <code class="computeroutput"><span class="identifier">CONTRACT_INIT_LOOP_VARIANT</span></code>,
          and the sequence tokens <code class="computeroutput"><span class="identifier">precondition</span></code>,
          <code class="computeroutput"><span class="identifier">postcondition</span></code>, <code class="computeroutput"><span class="identifier">body</span></code>, <code class="computeroutput"><span class="identifier">copyable</span></code>,
          and <code class="computeroutput"><span class="identifier">inherit</span></code>. For example,
          this can be done in the Vi IMproved (VIM) editor by adding these symbols
          to the <code class="computeroutput"><span class="string">"cpp.vim"</span></code>
          file (usually in the VIM system configuration directory).
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id867784" href="#id867784" class="para">6</a>] </sup>
              Some text editing programs might highlight curly brackets <code class="computeroutput"><span class="special">{}</span></code> within a macro parameter as a C++
              syntax error. This is incorrect as the ISO C++ standard allows for
              macro parameters to contain curly brackets and the editor might offer
              an option for disabling this incorrect syntax error highlighting. For
              example, when C++ syntax highlighting is turned on in the Vi IMproved
              (VIM) editor, curly brackets within macro parameters are highlighted
              as errors but that can be disabled by adding the line <code class="computeroutput"><span class="identifier">let</span> <span class="identifier">c_no_curly_error</span><span class="special">=</span><span class="number">1</span></code> in
              the <code class="computeroutput"><span class="string">".vimrc"</span></code>
              file (typically in your home directory).
            </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id868670" href="#id868670" class="para">7</a>] </sup>
            However, this is the only sensible semantics for copying pointers as
            the pointer could of type <code class="computeroutput"><span class="keyword">void</span><span class="special">*</span></code> for which it is not possible to copy
            the pointed object, plus there might cases where the functions actually
            changed the pointer value so <code class="computeroutput"><a href="../CONTRACT_OLDOF.html" target="_top">CONTRACT_OLDOF</a><span class="special">()</span></code> needs to the return the old pointer
            value (and not the old pointed value), plus this the usual C++ pointer
            copy semantic.
          </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id871438" href="#id871438" class="para">8</a>] </sup>
          <a class="link" href="bibliography.html" title="Bibliography">[Meyer1997]</a> argues preconditions
          asserted using non-public members are ill written thus the Eiffel programming
          language enforces this rule at compile-time. However, in C++ friend callers
          could still be able to fully check preconditions via the friendship even
          when non-public functions are used to assert them therefore this rule is
          left as a recommended practice for programmers to follow and it is not
          enforced by the library.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id871584" href="#id871584" class="para">9</a>] </sup>
          If two <a href="http://www.boost.org/libs/preprocessor/doc/index.html" target="_top">Boost.Preprocessor</a>
          sequences are specified one after the other then they are automatically
          concatenated into one larger sequence. For example let <code class="computeroutput"><span class="identifier">seq1</span></code>
          be <code class="computeroutput"><span class="special">(</span><span class="identifier">token1</span><span class="special">)</span> <span class="special">(</span><span class="identifier">token2</span><span class="special">)</span></code> and <code class="computeroutput"><span class="identifier">seq2</span></code>
          be <code class="computeroutput"><span class="special">(</span><span class="identifier">token3</span><span class="special">)</span> <span class="special">(</span><span class="identifier">token4</span><span class="special">)</span> <span class="special">(</span><span class="identifier">token5</span><span class="special">)</span></code> then <code class="computeroutput"><span class="identifier">seq1</span>
          <span class="identifier">seq2</span></code> is <code class="computeroutput"><span class="special">(</span><span class="identifier">token1</span><span class="special">)</span> <span class="special">(</span><span class="identifier">token2</span><span class="special">)</span> <span class="special">(</span><span class="identifier">token3</span><span class="special">)</span> <span class="special">(</span><span class="identifier">token4</span><span class="special">)</span> <span class="special">(</span><span class="identifier">token5</span><span class="special">)</span></code>.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id871800" href="#id871800" class="para">10</a>] </sup>
          Because the <span class="emphasis"><em>signature-sequence</em></span> essentially contains
          all the tokens necessary to declare the function, the contract macros could
          have been implemented to replace the function declaration entirely instead
          of being specified right after the function declaration. This would have
          saved the programmers from repeating the function declaration tokens twice,
          first to declare the function and then to invoke the contract macro. However,
          replacing the function declarations entirely with the unfamiliar looking
          <span class="emphasis"><em>signature-sequence</em></span> would have drastically reduced
          readability therefore it was intentionally avoided.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id873455" href="#id873455" class="para">11</a>] </sup>
              A <span class="emphasis"><em>constant-correct copy constructor</em></span> constructs
              the object copying it from a constant-reference of the source object
              thus it cannot alter the state of the copied object.
            </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id875102" href="#id875102" class="para">12</a>] </sup>
          However, this could change in future revisions of the library if C++ were
          to support delegating constructors (see <a class="link" href="bibliography.html" title="Bibliography">[Sutter2005]</a>).
          Therefore, <code class="computeroutput"><span class="special">(</span><span class="keyword">explicit</span><span class="special">)</span></code> is part of the library API and it should
          always be specified in <span class="emphasis"><em>signature-sequence</em></span> when the
          contracted constructor is <code class="computeroutput"><span class="keyword">explicit</span></code>.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id875716" href="#id875716" class="para">13</a>] </sup>
          One specific token ordering was fixed so to simplify the implementation
          of the library code that parsers <span class="emphasis"><em>signature-sequence</em></span>.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id878216" href="#id878216" class="para">14</a>] </sup>
          Using the augmented object state the library could detect infinite recursion
          between overriding and overridden function. However, to break the recursion
          the base contract will have to call the base body function forcing static
          binding (otherwise using dynamic binding the overriding function will be
          called causing the infinite recursion). The contract itself cannot perform
          the static binding call (e.g., using static_cast&lt;&gt; to the object)
          because the object state is changed only if pointers or references to the
          objects are used to call the body, but if pointers or reference are used
          then C++ uses dynamic binding for the call. So the contract function could
          call a special method of the contract class which performs the static binding
          call but such a static binding call will raise a compiler error if the
          body function is pure virtual. The library does not know directly when
          a function is pure virtual (body is <code class="computeroutput"><span class="special">=</span>
          <span class="number">0</span><span class="special">;</span></code>)
          or not so the library will have to define the contract class static binding
          method also for pure virtual functions and in this case the static binding
          call <code class="computeroutput"><span class="identifier">B</span><span class="special">::</span><span class="identifier">f</span><span class="special">()</span></code> will
          raise a compile time error because the function called via static binding
          is pure virtual.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.id883219" href="#id883219" class="para">15</a>] </sup>
            The library <span class="emphasis"><em>could</em></span> overcome this limitation if future
            versions of the C++ standard were to support delegating constructors
            (as proposed by <a class="link" href="bibliography.html" title="Bibliography">[Sutter2005]</a>).
          </p></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2009, 2010 Lorenzo Caminiti<p>
        Distributed under the Contract++ Software License, Version 1.0 (see accompanying
        file LICENSE_1_0.txt)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="getting_started.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="without_the_macros.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
