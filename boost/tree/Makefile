# Makefile for "types examples"
# written by Marc Cromme
#
# typical compile command:
# gcc -o ex1 ex1.c -lglut -lGLU -lGL -lm 
# -L/usr/X11R6/lib -L/usr/X11/lib -lX11 -lXext -lXmu -lXt
#

###########################################################
# Compiler flags


#CCPP = g++-3.0
CCPP = g++-3.2

# production flags
#CCFLAGS = -O3 --pipe

# debug flags
CCFLAGS = -g -p -ansi -pedantic -W -Wall -Wshadow -Wpointer-arith
#CCFLAGS = -g -p -ansi -pedantic -W -Wall -Wshadow -Wpointer-arith -Weffc++ -Wfloat-equal 

# Include flags
#INCFLAG = -I/usr/include -I/usr/local/include 
#INCFLAG = -I/usr/include -I/usr/local/include -I/usr/include/stlport

# Linker flags
#STLFLAG = -lstlport
#MATHFLAG = -lm
#GLLIBFLAG = -lglut -lGLU -lGL -lm
#XLIBFLAG = -lX11 -lXext -lXmu -lXt
#LDFLAG = -L/usr/X11R6/lib 

###########################################################
# Suffix rules for compilation


# suffix rules
.SUFFIXES: .o  .cpp  

# compile C++ code to Object files
.cpp.o:
	$(CCPP) $(CCFLAGS)  -c $*.cpp  $(INCFLAG)


###########################################################
# Source files
#SOURCES = $(shell ls *.hpp *.cpp) 
SOURCES = $(wildcard *.hpp *.cpp) 
#SOURCES =  *.hpp *.cpp 

###########################################################
# Targets, executables
TARGETS = main utest

MAIN = main.o
UTEST = utest.o utest_ntree.o utest_mappediterator.o \
	unittest.o 


all:  $(TARGETS)


# link into executable targets
main: $(MAIN)
	$(CCPP) $(LDFLAG) $(MAIN)  -o $@ $(STLFLAG) $(MATHFLAG) $(GLLIBFLAG) $(XLIBFLAG)

utest: $(UTEST)
	$(CCPP) $(LDFLAG) $(UTEST)  -o $@ $(STLFLAG) $(MATHFLAG) $(GLLIBFLAG) $(XLIBFLAG)


# documentation
doc:   $(SOURCES)
	doxygen > doc


# clean intermediate derived files
clean: 
	rm -f *.o *.ii *.s *~ doc dependencies.d

# clean everything, only sources left
realclean: 
	rm -rf *.o *.ii *.s *~ doc dependencies.d $(TARGETS) html


###########################################################
# Subtargets, generated by 'g++-3.1 -MM *.cpp'

dependencies.d:  $(SOURCES)
	$(CCPP) -MM *.cpp > dependencies.d

include dependencies.d 














