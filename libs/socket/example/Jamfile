# declare the location of this subproject relative to the root

subproject libs/socket/example ;

# bring in the rules for testing
SEARCH on testing.jam = $(BOOST_BUILD_PATH) ;
include testing.jam ;

B_ROOT ?= c:/usr/boost ;
SPIRIT_ROOT ?= c:/usr/spirit ;

rule socket-example ( example-name : sources + )
{
    exe $(example-name) :
      $(sources)
	<lib>../build/boost_socket
	:
	<include>$(B_ROOT)
	<include>$(BOOST_ROOT)
	<include>$(SPIRIT_ROOT)
	<bcc56><*><cxxflags>-Q
	  <runtime-link>static
	  <threading>single
	  <msvc><*><find-library>Ws2_32
	  <vc7><*><find-library>Ws2_32
	  <gcc><*><find-library>Ws2_32
	  ;
}

rule socket-test-example ( example-name : sources + )
{
    exe $(example-name) :
      $(sources)
	<lib>../build/boost_socket
	:
	<include>$(B_ROOT)
	<include>$(BOOST_ROOT)
	<library-path>$(B_ROOT)/libs/test/build/bin/libunit_test_framework.lib/$(TOOLS)/debug/runtime-link-static/threading-single
	<gcc><*><find-library>unit_test_framework
	<borland><*><find-library>libunit_test_framework
	<bcc56><*><find-library>libunit_test_framework
	<bcc56><*><cxxflags>-Q
	<vc7><*><find-library>libunit_test_framework
	<msvc><*><find-library>libunit_test_framework
	  <runtime-link>static
	  <threading>single
	  <msvc><*><find-library>Ws2_32
	  <vc7><*><find-library>Ws2_32
	  <gcc><*><find-library>Ws2_32
	  ;
}


socket-test-example simple_client : client_test.cpp ;
socket-test-example simple_server : server_test.cpp ;

socket-example http_get : http_get.cpp ;
socket-example async_server : async_server.cpp ;

#socket-example named_pipe_server : named_pipe_server.cpp ;
#socket-example named_pipe_client : named_pipe_client.cpp ;