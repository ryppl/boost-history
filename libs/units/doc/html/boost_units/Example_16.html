<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Example 16</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.71.1">
<link rel="start" href="../index.html" title="Chapter 1. Boost.Units 0.7.0">
<link rel="up" href="Examples.html" title="Examples">
<link rel="prev" href="Example_15.html" title="Example 15">
<link rel="next" href="Example_17.html" title="Example 17">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%">
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../boost.png"></td>
<td align="center"><a href="../../../index.htm">Home</a></td>
<td align="center"><a href="../libraries.html">Libraries</a></td>
<td align="center"><a href="../../../people/people.htm">People</a></td>
<td align="center"><a href="../../../more/faq.htm">FAQ</a></td>
<td align="center"><a href="../../../more/index.htm">More</a></td>
</table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="Example_15.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="Examples.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="Example_17.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_units.Example_16"></a> Example 16</h3></div></div></div>
<p>
        (<a href="../../example/unit_example_16.cpp" target="_top">unit_example_16.cpp</a>)
      </p>
<p>
        This example demonstrates the implementation of two non-SI units of length,
        the nautical mile :
      </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting">
<span class="keyword">namespace</span> <span class="identifier">nautical</span> <span class="special">{</span>

<span class="comment">/// placeholder class defining nautical unit system
</span><span class="keyword">struct</span> <span class="identifier">system_tag</span> <span class="special">:</span> <span class="keyword">public</span> <span class="identifier">ordinal</span><span class="special">&lt;</span><span class="number">100</span><span class="special">&gt;</span> <span class="special">{</span> <span class="special">};</span>

<span class="keyword">typedef</span> <span class="identifier">homogeneous_system</span><span class="special">&lt;</span><span class="identifier">system_tag</span><span class="special">&gt;</span>  <span class="identifier">system</span><span class="special">;</span>

<span class="comment">/// unit typedefs
</span><span class="keyword">typedef</span> <span class="identifier">unit</span><span class="special">&lt;</span><span class="identifier">length_type</span><span class="special">,</span><span class="identifier">system</span><span class="special">&gt;</span>            <span class="identifier">length</span><span class="special">;</span>

<span class="keyword">static</span> <span class="keyword">const</span> <span class="identifier">length</span> <span class="identifier">mile</span><span class="special">,</span><span class="identifier">miles</span><span class="special">;</span>

<span class="special">}</span> <span class="comment">// namespace nautical
</span>
<span class="comment">// IO helper class
</span><span class="keyword">template</span><span class="special">&lt;&gt;</span> 
<span class="keyword">struct</span> <span class="identifier">unit_info</span><span class="special">&lt;</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">,</span><span class="identifier">length_tag</span><span class="special">&gt;</span> 
<span class="special">{</span> 
    <span class="keyword">static</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="identifier">name</span><span class="special">()</span>       <span class="special">{</span> <span class="keyword">return</span> <span class="string">"nautical mile"</span><span class="special">;</span> <span class="special">}</span>
    <span class="keyword">static</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="identifier">symbol</span><span class="special">()</span>     <span class="special">{</span> <span class="keyword">return</span> <span class="string">"nmi"</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span>

<span class="comment">// helpers for conversions between nautical length and SI length
</span><span class="keyword">template</span><span class="special">&lt;&gt;</span>
<span class="keyword">struct</span> <span class="identifier">base_unit_converter</span><span class="special">&lt;</span><span class="identifier">length_tag</span><span class="special">,</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">,</span><span class="identifier">SI</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">&gt;</span>
<span class="special">{</span>
    <span class="keyword">typedef</span> <span class="keyword">double</span> <span class="identifier">type</span><span class="special">;</span>
    <span class="keyword">static</span> <span class="identifier">type</span> <span class="identifier">value</span><span class="special">()</span> <span class="special">{</span> <span class="keyword">return</span> <span class="number">1.852e3</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span>

<span class="keyword">template</span><span class="special">&lt;&gt;</span>
<span class="keyword">struct</span> <span class="identifier">base_unit_converter</span><span class="special">&lt;</span><span class="identifier">length_tag</span><span class="special">,</span><span class="identifier">SI</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">,</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">&gt;</span>
<span class="special">{</span>
    <span class="keyword">typedef</span> <span class="keyword">double</span> <span class="identifier">type</span><span class="special">;</span>
    <span class="keyword">static</span> <span class="identifier">type</span> <span class="identifier">value</span><span class="special">()</span> <span class="special">{</span> <span class="keyword">return</span> <span class="number">1.0</span><span class="special">/</span><span class="number">1.852e3</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span>
</pre>
<p>
        </p>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"></table></div>
<p>
        </p>
<p>
      </p>
<p>
        and the imperial foot :
      </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting">
<span class="keyword">namespace</span> <span class="identifier">imperial</span> <span class="special">{</span>

<span class="comment">/// placeholder class defining imperial unit system
</span><span class="keyword">struct</span> <span class="identifier">system_tag</span> <span class="special">:</span> <span class="keyword">public</span> <span class="identifier">ordinal</span><span class="special">&lt;</span><span class="number">101</span><span class="special">&gt;</span> <span class="special">{</span> <span class="special">};</span>

<span class="keyword">typedef</span> <span class="identifier">homogeneous_system</span><span class="special">&lt;</span><span class="identifier">system_tag</span><span class="special">&gt;</span>  <span class="identifier">system</span><span class="special">;</span>

<span class="comment">/// unit typedefs
</span><span class="keyword">typedef</span> <span class="identifier">unit</span><span class="special">&lt;</span><span class="identifier">length_type</span><span class="special">,</span><span class="identifier">system</span><span class="special">&gt;</span>            <span class="identifier">length</span><span class="special">;</span>

<span class="keyword">static</span> <span class="keyword">const</span> <span class="identifier">length</span> <span class="identifier">foot</span><span class="special">,</span><span class="identifier">feet</span><span class="special">;</span>

<span class="special">}</span> <span class="comment">// imperial
</span>
<span class="comment">// IO helper class
</span><span class="keyword">template</span><span class="special">&lt;&gt;</span> 
<span class="keyword">struct</span> <span class="identifier">unit_info</span><span class="special">&lt;</span><span class="identifier">imperial</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">,</span><span class="identifier">length_tag</span><span class="special">&gt;</span> 
<span class="special">{</span> 
    <span class="keyword">static</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="identifier">name</span><span class="special">()</span>       <span class="special">{</span> <span class="keyword">return</span> <span class="string">"foot"</span><span class="special">;</span> <span class="special">}</span>
    <span class="keyword">static</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="identifier">symbol</span><span class="special">()</span>     <span class="special">{</span> <span class="keyword">return</span> <span class="string">"ft"</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span>

<span class="comment">// helpers for conversions between imperial length and SI length
</span><span class="keyword">template</span><span class="special">&lt;&gt;</span>
<span class="keyword">struct</span> <span class="identifier">base_unit_converter</span><span class="special">&lt;</span><span class="identifier">length_tag</span><span class="special">,</span><span class="identifier">imperial</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">,</span><span class="identifier">SI</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">&gt;</span>
<span class="special">{</span>
    <span class="keyword">typedef</span> <span class="keyword">double</span> <span class="identifier">type</span><span class="special">;</span>
    <span class="keyword">static</span> <span class="identifier">type</span> <span class="identifier">value</span><span class="special">()</span> <span class="special">{</span> <span class="keyword">return</span> <span class="number">1.0</span><span class="special">/</span><span class="number">3.28083989501312</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span>

<span class="keyword">template</span><span class="special">&lt;&gt;</span>
<span class="keyword">struct</span> <span class="identifier">base_unit_converter</span><span class="special">&lt;</span><span class="identifier">length_tag</span><span class="special">,</span><span class="identifier">SI</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">,</span><span class="identifier">imperial</span><span class="special">::</span><span class="identifier">system_tag</span><span class="special">&gt;</span>
<span class="special">{</span>
    <span class="keyword">typedef</span> <span class="keyword">double</span> <span class="identifier">type</span><span class="special">;</span>
    <span class="keyword">static</span> <span class="identifier">type</span> <span class="identifier">value</span><span class="special">()</span> <span class="special">{</span> <span class="keyword">return</span> <span class="number">3.28083989501312</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span>
</pre>
<p>
        </p>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"></table></div>
<p>
        </p>
<p>
      </p>
<p>
        These units include conversions between themselves and the meter. Three functions
        for computing radar beam height from radar range and the local earth radius
        are defined. The first takes arguments in one system and returns a value
        in the same system :
      </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting">
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">System</span><span class="special">,</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">unit</span><span class="special">&lt;</span><span class="identifier">length_type</span><span class="special">,</span><span class="identifier">System</span><span class="special">&gt;,</span><span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">radar_beam_height</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">unit</span><span class="special">&lt;</span><span class="identifier">length_type</span><span class="special">,</span><span class="identifier">System</span><span class="special">&gt;,</span><span class="identifier">T</span><span class="special">&gt;&amp;</span> <span class="identifier">radar_range</span><span class="special">,</span>
                  <span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">unit</span><span class="special">&lt;</span><span class="identifier">length_type</span><span class="special">,</span><span class="identifier">System</span><span class="special">&gt;,</span><span class="identifier">T</span><span class="special">&gt;&amp;</span> <span class="identifier">earth_radius</span><span class="special">,</span>
                  <span class="identifier">T</span> <span class="identifier">k</span> <span class="special">=</span> <span class="number">4.0</span><span class="special">/</span><span class="number">3.0</span><span class="special">)</span>
<span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">unit</span><span class="special">&lt;</span><span class="identifier">length_type</span><span class="special">,</span><span class="identifier">System</span><span class="special">&gt;,</span><span class="identifier">T</span><span class="special">&gt;(</span><span class="identifier">pow</span><span class="special">&lt;</span><span class="number">2</span><span class="special">&gt;(</span><span class="identifier">radar_range</span><span class="special">)/(</span><span class="number">2.0</span><span class="special">*</span><span class="identifier">k</span><span class="special">*</span><span class="identifier">earth_radius</span><span class="special">));</span>
<span class="special">}</span>
</pre>
<p>
        </p>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"></table></div>
<p>
        </p>
<p>
      </p>
<p>
        The second is similar, but is templated on return type, so that the arguments
        are converted to the return unit system internally :
      </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting">
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">return_type</span><span class="special">,</span><span class="keyword">class</span> <span class="identifier">System1</span><span class="special">,</span><span class="keyword">class</span> <span class="identifier">System2</span><span class="special">,</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">return_type</span>
<span class="identifier">radar_beam_height</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">unit</span><span class="special">&lt;</span><span class="identifier">length_type</span><span class="special">,</span><span class="identifier">System1</span><span class="special">&gt;,</span><span class="identifier">T</span><span class="special">&gt;&amp;</span> <span class="identifier">radar_range</span><span class="special">,</span>
                  <span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">unit</span><span class="special">&lt;</span><span class="identifier">length_type</span><span class="special">,</span><span class="identifier">System2</span><span class="special">&gt;,</span><span class="identifier">T</span><span class="special">&gt;&amp;</span> <span class="identifier">earth_radius</span><span class="special">,</span>
                  <span class="identifier">T</span> <span class="identifier">k</span> <span class="special">=</span> <span class="number">4.0</span><span class="special">/</span><span class="number">3.0</span><span class="special">)</span>
<span class="special">{</span>
    <span class="comment">// need to decide which system to use for calculation
</span>    <span class="keyword">const</span> <span class="identifier">return_type</span>   <span class="identifier">rr</span><span class="special">(</span><span class="identifier">radar_range</span><span class="special">),</span>
                        <span class="identifier">er</span><span class="special">(</span><span class="identifier">earth_radius</span><span class="special">);</span>

    <span class="keyword">return</span> <span class="identifier">return_type</span><span class="special">(</span><span class="identifier">pow</span><span class="special">&lt;</span><span class="number">2</span><span class="special">&gt;(</span><span class="identifier">rr</span><span class="special">)/(</span><span class="number">2.0</span><span class="special">*</span><span class="identifier">k</span><span class="special">*</span><span class="identifier">er</span><span class="special">));</span>
<span class="special">}</span>
</pre>
<p>
        </p>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"></table></div>
<p>
        </p>
<p>
      </p>
<p>
        Finally, the third function is an empirical approximation that is only valid
        for radar ranges specified in nautical miles, returning beam height in feet.
        This function uses the heterogeneous unit of nautical miles per square root
        of feet to ensure dimensional correctness :
      </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting">
<span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">imperial</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;</span> <span class="identifier">radar_beam_height</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;&amp;</span> <span class="identifier">range</span><span class="special">)</span>
<span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">pow</span><span class="special">&lt;</span><span class="number">2</span><span class="special">&gt;(</span><span class="identifier">range</span><span class="special">/(</span><span class="number">1.23</span><span class="special">*</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">miles</span><span class="special">/</span><span class="identifier">root</span><span class="special">&lt;</span><span class="number">2</span><span class="special">&gt;(</span><span class="identifier">imperial</span><span class="special">::</span><span class="identifier">feet</span><span class="special">)));</span>
<span class="special">}</span>
</pre>
<p>
        </p>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"></table></div>
<p>
        </p>
<p>
      </p>
<p>
        With these, we can compute radar beam height in various unit systems :
      </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting">
<span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;</span>    <span class="identifier">radar_range</span><span class="special">(</span><span class="number">300.0</span><span class="special">*</span><span class="identifier">miles</span><span class="special">);</span>
<span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">SI</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;</span>          <span class="identifier">earth_radius</span><span class="special">(</span><span class="number">6371.0087714</span><span class="special">*</span><span class="identifier">kilo</span><span class="special">*</span><span class="identifier">meters</span><span class="special">);</span>

<span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">SI</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;</span>          <span class="identifier">beam_height_1</span><span class="special">(</span><span class="identifier">radar_beam_height</span><span class="special">(</span><span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">SI</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;(</span><span class="identifier">radar_range</span><span class="special">),</span><span class="identifier">earth_radius</span><span class="special">));</span>
<span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;</span>    <span class="identifier">beam_height_2</span><span class="special">(</span><span class="identifier">radar_beam_height</span><span class="special">(</span><span class="identifier">radar_range</span><span class="special">,</span><span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;(</span><span class="identifier">earth_radius</span><span class="special">)));</span>
<span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">SI</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;</span>          <span class="identifier">beam_height_3</span><span class="special">(</span><span class="identifier">radar_beam_height</span><span class="special">&lt;</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">SI</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;</span> <span class="special">&gt;(</span><span class="identifier">radar_range</span><span class="special">,</span><span class="identifier">earth_radius</span><span class="special">));</span>
<span class="keyword">const</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;</span>    <span class="identifier">beam_height_4</span><span class="special">(</span><span class="identifier">radar_beam_height</span><span class="special">&lt;</span> <span class="identifier">quantity</span><span class="special">&lt;</span><span class="identifier">nautical</span><span class="special">::</span><span class="identifier">length</span><span class="special">&gt;</span> <span class="special">&gt;(</span><span class="identifier">radar_range</span><span class="special">,</span><span class="identifier">earth_radius</span><span class="special">));</span>
</pre>
<p>
        </p>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"></table></div>
<p>
        </p>
<p>
      </p>
<p>
        giving
      </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting">
<span class="identifier">radar</span> <span class="identifier">range</span>        <span class="special">:</span> <span class="number">300</span> <span class="identifier">nmi</span>
<span class="identifier">earth</span> <span class="identifier">radius</span>       <span class="special">:</span> <span class="number">6.37101e+06</span> <span class="identifier">m</span>
<span class="identifier">beam</span> <span class="identifier">height</span> <span class="number">1</span>      <span class="special">:</span> <span class="number">18169.7</span> <span class="identifier">m</span>
<span class="identifier">beam</span> <span class="identifier">height</span> <span class="number">2</span>      <span class="special">:</span> <span class="number">9.81085</span> <span class="identifier">nmi</span>
<span class="identifier">beam</span> <span class="identifier">height</span> <span class="number">3</span>      <span class="special">:</span> <span class="number">18169.7</span> <span class="identifier">m</span>
<span class="identifier">beam</span> <span class="identifier">height</span> <span class="number">4</span>      <span class="special">:</span> <span class="number">9.81085</span> <span class="identifier">nmi</span>
<span class="identifier">beam</span> <span class="identifier">height</span> <span class="identifier">approx</span> <span class="special">:</span> <span class="number">59488.4</span> <span class="identifier">ft</span>
<span class="identifier">beam</span> <span class="identifier">height</span> <span class="identifier">approx</span> <span class="special">:</span> <span class="number">18132.1</span> <span class="identifier">m</span>
</pre>
<p>
        </p>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"></table></div>
<p>
        </p>
<p>
      </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><small>Copyright © 2003 -2007 Matthias Christian Schabel, 2007 Steven Watanabe</small></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="Example_15.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="Examples.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="Example_17.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
