[/
          Copyright Oliver Kowalke 2009.
 Distributed under the Boost Software License, Version 1.0.
    (See accompanying file LICENSE_1_0.txt or copy at
          http://www.boost.org/LICENSE_1_0.txt
]


[section:static_pool Class template `static_pool`]

``
	#include <boost/task/static_pool.hpp>

	template< typename Channel >
	class static_pool : private noncopyable
	{
	public:
		static_pool();

		explicit static_pool(
			poolsize const& psize,
			posix_time::time_duration const& asleep = posix_time::microseconds( 10),
			scanns const& scns = scanns( 20) );

		explicit static_pool(
			poolsize const& psize,
			high_watermark const& hwm,
			low_watermark const& lwm,
			posix_time::time_duration const& asleep = posix_time::milliseconds( 100),
			scanns const& scns = scanns( 20) );

		static_pool( static_pool &&);

		static_pool & operator=( static_pool &&);

# if defined(BOOST_HAS_PROCESSOR_BINDINGS)
		explicit static_pool(
			<<unspec-type>>,
			posix_time::time_duration const& asleep = posix_time::microseconds( 10),
			scanns const& scns = scanns( 20) );

		explicit static_pool(
			<<unspec-type>>,
			high_watermark const& hwm,
			low_watermark const& lwm,
			posix_time::time_duration const& asleep = posix_time::milliseconds( 100),
			scanns const& scns = scanns( 20) );
			
		static <<unspec-type>> bind_to_processors();
# endif

		~static_pool();

		std::size_t size();
		std::size_t active();
		std::size_t idle();

		void shutdown();
		void shutdown_now();

		void interrupt_all_worker();

		bool closed();
		void clear();
		bool empty();
		std::size_t pending();

		const std::size_t upper_bound();
		void upper_bound( high_watermark const& hwm);
		const std::size_t lower_bound();
		void lower_bound( low_watermark const& lwm);

		template< typename R >
		handle< R > submit( task< R > && t);

		template< typename R, typename Attr >
		handle< R > submit( task< R > && t, Attr const& attr);

		void swap( static_pool & other); // throw()

		operator unspecified_bool_type() const;
		bool operator!() const;
	};
``

[heading Default constructor]

	static_pool()

[variablelist
[[Effects:] [constructs an unitialized pool]]
[[Throws:] [nothing]]
]


[heading Constructor (unbounded channel)]

	explicit static_pool(
		<<unspec-type>>,
		posix_time::time_duration const& asleep = posix_time::microseconds( 10),
		scanns const& scns = scanns( 20) )

[variablelist
[[Preconditions:] [operating system provides functionality for processor binding]]
[[Effects:] [constructs a pool - for each processor a worker-thread is created and bound to one processor - global-queue can queue an unlimited number of tasks]]
[[Throws:] [`boost::thread_resource_error`, `boost::task::invalid_scanns`, `boost::task::invalid_timeduration`]]
[[Notes:] [constructor has to be called if a unbounded-channel is used and `bind_to_processors()` must be set as first argument]]
]


[heading Constructor (unbounded channel/poolsize)]

	explicit static_pool(
		poolsize const& psize,
		posix_time::time_duration const& asleep = posix_time::microseconds( 10),
		scanns const& scns = scanns( 20) )

[variablelist
[[Effects:] [constructs a pool containing psize worker-threads - global-queue can queue an unlimited number of tasks]]
[[Throws:] [`boost::thread_resource_error`, `boost::task::invalid_scanns`, `boost::task::invalid_timeduration`]]
[[Notes:] [constructor has to be called if a unbounded-channel is used]]
]


[heading Constructor (bounded channel)]

	explicit static_pool(
		<<unspec-type>>,
		high_watermark const& hwm,
		low_watermark const& lwm,
		posix_time::time_duration const& asleep = posix_time::milliseconds( 100),
		scanns const& scns = scanns( 20) )

[variablelist
[[Preconditions:] [operating system provides functionality for processor binding]]
[[Effects:] [constructs a pool - for each processor a worker-thread is created and bound to one processor - global-queue can only queue a limited number of tasks]]
[[Throws:] [`boost::thread_resource_error`, `boost::task::invalid_scanns`, `boost::task::invalid_timeduration`, `boost::task::invalid_watermark`]]
[[Notes:] [constructor has to be called if a bounded-channel is used and `bind_to_processors()` must be set as first argument]]
]


[heading Constructor (bounded channel/poolsize)]

	explicit static_pool(
		poolsize const& psize,
		high_watermark const& hwm,
		low_watermark const& lwm,
		posix_time::time_duration const& asleep = posix_time::milliseconds( 100),
		scanns const& scns = scanns( 20) )

[variablelist
[[Effects:] [constructs a pool containing psize worker-threads - global-queue can only queue a limited number of tasks]]
[[Throws:] [`boost::thread_resource_error`, `boost::task::invalid_scanns`, `boost::task::invalid_timeduration`, `boost::task::invalid_watermark`]]
[[Notes:] [constructor has to be called if a bounded-channel is used]]
]


[heading Move-copy constructor]

	static_pool( static_pool &&)

[variablelist
[[Effects:] [creates an pool out of another one which gets zeroed out]]
[[Throws:] [nothing]]
]


[heading Move-assigment constructor]

	static_pool & operator=( static_pool &&)

[variablelist
[[Effects:] [creates an pool out of another one which gets zeroed out]]
[[Throws:] [nothing]]
]


[heading Destructor]

	~static_pool()

[variablelist
[[Effects:] [calls `shutdown()` if not already called]]
[[Throws:] [nothing]]
]


[heading Static member function `bind_to_processors()`]

	<<unspec-type>> bind_to_processors()

[variablelist
[[Effects:] [used in order to let the pool create worker-threads as cores are available and bound the threads to the cores]]
[[Throws:] [nothing]]
]


[heading Member function `size()`]

	std::size_t size()

[variablelist
[[Effects:] [returns how many worker-threads are running in the pool]]
[[Throws:] [`boost::task::pool_moved`]]
]


[heading Member function `active()`]

	std::size_t active()

[variablelist
[[Effects:] [returns how many worker-threads are active (executing an task)]]
[[Throws:] [`boost::task::pool_moved`]]
]


[heading Member function `idle()`]

	std::size_t idle()

[variablelist
[[Effects:] [returns how many worker-threads are idle (not executing an task).]]
[[Throws:] [`boost::task::pool_moved`]]
[[Notes:] [the value is the difference of `size()` and `active()`]]
]


[heading Member function `shutdown()`]

	void shutdown()

[variablelist
[[Effects:] [deactivates the channel and joins all worker-threads - the pool is closed]]
[[Throws:] [`boost::thread_interrupted`, `boost::system::system_error`, `boost::task::pool_moved`]]
[[Notes:] [all pending tasks are processed]]
]


[heading Member function `shutdown_now()`]

	void shutdown_now()

[variablelist
[[Effects:] [deactivates the channel, send interruption request to all worker-threads and joins them - the pool is closed]]
[[Throws:] [`boost::thread_interrupted`, `boost::system::system_error`, `boost::task::pool_moved`]]
[[Notes:] [pending tasks are not processed but returned]]
]


[heading Member function `interrupt_all_worker()`]

	void interrupt_all_worker()

[variablelist
[[Effects:] [interrupts all worker-threads without invalidating the pool]]
[[Throws:] [nothing]]
]


[heading Member function `closed()`]

	bool closed()

[variablelist
[[Effects:] [queries if the pool is closed (pool is shutdown)]]
[[Throws:] [`boost::task::pool_moved`]]
]


[heading Member function `clear()`]

	void clear()

[variablelist
[[Effects:] [removes all pending tasks from the channel]]
[[Throws:] [`boost::task::pool_moved`]]
]


[heading Member function `empty()`]

	bool empty()

[variablelist
[[Effects:] [queries if the channel is empty]]
[[Throws:] [`boost::task::pool_moved`]]
]


[heading Member function `pending()`]

	std::size_t pending()

[variablelist
[[Effects:] [queries how many tasks are pending (still unprocessed) in the global-queue (channel)]]
[[Throws:] [`boost::task::pool_moved`]]
]


[heading Member function `upper_bound()`]

	std::size_t upper_bound()

[variablelist
[[Preconditions:] [channel is of type bounded-channel]]
[[Effects:] [returns the upper bound of the bounded-channel]]
[[Throws:] [`boost::task::pool_moved`]]
[[Notes:] [can only be used if a bounded-channel is used]]
]


[heading Member function `upper_bound( high_watermark const& hwm)`]

	void upper_bound( high_watermark const& hwm)

[variablelist
[[Preconditions:] [channel is of type bounded-channel]]
[[Effects:] [sets the upper bound of the bounded-channel]]
[[Postconditions:] [`this->upper_bound() == hwm`]]
[[Throws:] [`boost::task::invalid_watermark`, `boost::task::pool_moved`]]
[[Notes:] [can only be used if a bounded-channel is used]]
]


[heading Member function `lower_bound()`]

	std::size_t lower_bound();

[variablelist
[[Preconditions:] [channel is of type bounded-channel]]
[[Effects:] [returns the lower bound of the bounded-channel]]
[[Throws:] [`boost::task::pool_moved`]]
[[Notes:] [can only be used if a bounded-channel is used]]
]


[heading Member function `lower_bound( low_watermark const& lwm)`]

	void lower_bound( low_watermark const& lwm)

[variablelist
[[Preconditions:] [channel is of type bounded-channel]]
[[Effects:] [sets the lower bound of the bounded-channel]]
[[Postconditions:] [`this->lower_bound() == lwm`]]
[[Throws:] [`boost::task::invalid_watermark`, `boost::task::pool_moved`]]
[[Notes:] [can only be used if a bounded-channel is used]]
]


[heading Member function `submit( task< R > &&)`]

	template< typename R >
	handle< R > submit( task< R > && t)

[variablelist
[[Preconditions:] [has_attribute< pool >::value == false && ! closed()]]
[[Effects:] [moves an task to the pool and returns an associated handle]]
[[Throws:] [`boost::task::task_rejected`, `boost::task::pool_moved`]]
]


[heading Member function `submit( task< R > &&, Attr const& attr)`]

	template< typename R, typename Attr >
	handle< R > submit( task< R > && t, Attr const& attr)

[variablelist
[[Preconditions:] [has_attribute< pool >::value == true && ! closed()]]
[[Effects:] [moves an task to the pool and returns an associated handle - task is scheduled by the attribute]]
[[Throws:] [`boost::task::task_rejected`, `boost::task::pool_moved`]]
]


[heading Member function swap( static_pool &)`]

	void swap( static_pool & other)

[variablelist
[[Effects:] [swaps pool]]
[[Throws:] [nothing]]
]


[heading operator `operator unspecified_bool_type()`]

	operator unspecified_bool_type() const

[variablelist
[[Effects:] [is static_pool valid == does static_pool own ownership]]
[[Throws:] [Nothing]]
]


[heading operator `operator!()`]

	bool operator!() const

[variablelist
[[Effects:] [is static_pool invalid == static_pool does not have ownership]]
[[Throws:] [Nothing]]
]


[endsect]
