#~ Copyright Rene Rivera 2008
#~ Distributed under the Boost Software License, Version 1.0.
#~ (See accompanying file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)


project
    :   requirements
        <library>/boost/test//boost_test_exec_monitor/<link>static
        <include>../../..
        <define>BOOST_ALL_NO_LIB=1
        <warnings>all
        <toolset>gcc:<cxxflags>-Wextra
        <toolset>gcc:<warnings-as-errors>on
        <toolset>gcc:<cxxflags>-Wno-long-long
        <toolset>gcc:<cxxflags>-Wcast-align
        <toolset>intel:<warnings-as-errors>on
        <toolset>msvc:<warnings-as-errors>on
    ;

import testing ;

run valgrind_config_check.cpp : : : <testing.launcher>"valgrind --error-exitcode=1" ;
explicit valgrind_config_check ;

test-suite pool :
    [ run test_gcd_lcm.cpp ]
    [ run test_simple_seg_storage.cpp ]
    [ run test_pool_alloc.cpp ]
    [ run pool_msvc_compiler_bug_test.cpp ]
    [ run test_msvc_mem_leak_detect.cpp ]
    [ run test_bug_3349.cpp ]
    [ run test_bug_4960.cpp ]
    [ run test_bug_1252.cpp ]
    [ run test_bug_2696.cpp ]

#
# The following tests test Boost.Pool's code with valgrind only if it's available:
#
    [ run test_gcd_lcm.cpp : : : [ check-target-builds valgrind_config_check : : <testing.launcher>"valgrind --error-exitcode=1" ] : test_gcd_lcm_valgrind ]
    [ run test_simple_seg_storage.cpp  : : : [ check-target-builds valgrind_config_check : : <testing.launcher>"valgrind --error-exitcode=1" ] : test_simple_seg_storage_valgrind ]
    [ run test_pool_alloc.cpp  : : : [ check-target-builds valgrind_config_check : : <testing.launcher>"valgrind --error-exitcode=1" ] : test_pool_alloc_valgrind ]
    [ run pool_msvc_compiler_bug_test.cpp  : : : [ check-target-builds valgrind_config_check : : <testing.launcher>"valgrind --error-exitcode=1" ] : pool_msvc_compiler_bug_test_valgrind ]
    [ run test_msvc_mem_leak_detect.cpp  : : : [ check-target-builds valgrind_config_check : : <testing.launcher>"valgrind --error-exitcode=1" ] : test_msvc_mem_leak_detect_valgrind ]
    [ run test_bug_3349.cpp  : : : [ check-target-builds valgrind_config_check : : <testing.launcher>"valgrind --error-exitcode=1" ] : test_bug_3349_valgrind ]
    [ run test_bug_4960.cpp  : : : [ check-target-builds valgrind_config_check : : <testing.launcher>"valgrind --error-exitcode=1" ] : test_bug_4960_valgrind ]
    [ run test_bug_1252.cpp  : : : [ check-target-builds valgrind_config_check : : <testing.launcher>"valgrind --error-exitcode=1" ] : test_bug_1252_valgrind ]
    [ run test_bug_2696.cpp  : : : [ check-target-builds valgrind_config_check : : <testing.launcher>"valgrind --error-exitcode=1" ] : test_bug_2696_valgrind ]
    ;


