<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Tutorial</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.1">
<link rel="home" href="../index.html" title="Cloneable 0.1">
<link rel="up" href="../index.html" title="Cloneable 0.1">
<link rel="prev" href="change_log.html" title="Change Log">
<link rel="next" href="tutorial/simple_hierarchical_cloning.html" title="Simple Hierarchical Cloning">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../boost.png"></td>
<td align="center"><a href="../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="change_log.html"><img src="../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="tutorial/simple_hierarchical_cloning.html"><img src="../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
<div class="section" title="Tutorial">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="cloneable.tutorial"></a><a class="link" href="tutorial.html" title="Tutorial"> Tutorial</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="tutorial/simple_hierarchical_cloning.html">Simple
      Hierarchical Cloning</a></span></dt>
<dt><span class="section"><a href="tutorial/controlling_construction.html">Controlling
      Construction</a></span></dt>
<dt><span class="section"><a href="tutorial/using_external_types.html">Using External
      Types</a></span></dt>
<dt><span class="section"><a href="tutorial/dealing_with_muliple_sub_objects.html">Dealing
      with Muliple Sub-Objects</a></span></dt>
<dt><span class="section"><a href="tutorial/customising_the_cloning_process.html">Customising
      the Cloning Process</a></span></dt>
<dt><span class="section"><a href="tutorial/using_custom_allocators.html">Using Custom
      Allocators</a></span></dt>
<dt><span class="section"><a href="tutorial/cloneable_traits.html">Cloneable Traits</a></span></dt>
</dl></div>
<p>
      This tutorial progresses through the basic usage of the library, demonstrating
      how to make a new Cloneable type, how to make an exsiting, external type Cloneable,
      and how to deal with multiple inheritance in type hierarchies.
    </p>
<p>
      The following is a quick introduction to <span class="bold"><strong>Boost.Cloneable</strong></span>:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">cloneable</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">using</span> <span class="keyword">namespace</span> <span class="identifier">boost</span><span class="special">;</span>

<span class="keyword">class</span> <span class="identifier">Foo</span> <span class="special">:</span> <span class="keyword">public</span> <span class="identifier">cloneable</span><span class="special">::</span><span class="identifier">base</span><span class="special">&lt;</span><span class="identifier">Foo</span><span class="special">&gt;</span> <span class="special">{</span> <span class="special">};</span>
</pre>
<p>
    </p>
<p>
      Here we have included the main <span class="bold"><strong>Boost.Cloneable</strong></span>
      header, made a class and derived from <code class="computeroutput"><span class="identifier">cloneable</span><span class="special">::</span><span class="identifier">base</span></code>, passing
      the type of thing to clone as the first type parameter. Now we can use it to
      make a clone:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span>
<span class="special">{</span>
     <span class="identifier">Foo</span> <span class="special">*</span><span class="identifier">foo</span> <span class="special">=</span> <span class="keyword">new</span> <span class="identifier">Foo</span><span class="special">();</span>
     <span class="identifier">cloneable</span><span class="special">::</span><span class="identifier">base_type</span> <span class="special">*</span><span class="identifier">cloned</span> <span class="special">=</span> <span class="identifier">foo</span><span class="special">-&gt;</span><span class="identifier">clone</span><span class="special">();</span>
     <span class="identifier">assert</span><span class="special">(</span><span class="keyword">typeid</span><span class="special">(*</span><span class="identifier">cloned</span><span class="special">)</span> <span class="special">==</span> <span class="keyword">typeid</span><span class="special">(</span><span class="identifier">Foo</span><span class="special">));</span>
     <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
    </p>
<p>
      Because we didn't supply a base type to use, the default base type named <code class="computeroutput"><span class="identifier">cloneable</span><span class="special">::</span><span class="identifier">base_type</span></code> is used. This is the return-type
      of the <code class="computeroutput"><span class="identifier">clone</span></code> method added to
      the <code class="computeroutput"><span class="identifier">Foo</span></code> type.
    </p>
<p>
      An equivalent way of making the clone is to use a free-function:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">Foo</span> <span class="special">*</span><span class="identifier">clone</span> <span class="special">=</span> <span class="identifier">cloneable</span><span class="special">::</span><span class="identifier">clone</span><span class="special">(*</span><span class="identifier">foo</span><span class="special">);</span> <span class="comment">// note: clone() takes a const reference, not a pointer
</span></pre>
<p>
    </p>
<p>
      This allows us to work with types that may or may not be <span class="emphasis"><em>Cloneable</em></span>
      in the sense of this library. If the given type is not <span class="emphasis"><em>Cloneable</em></span>,
      then the default way of making a clone using <code class="computeroutput"><span class="keyword">new</span>
      <span class="identifier">Type</span><span class="special">(</span><span class="identifier">original</span><span class="special">)</span></code>
      is used. (<span class="emphasis"><em>is defaulting to <code class="computeroutput"><span class="keyword">new</span>
      <span class="identifier">T</span><span class="special">(</span><span class="identifier">orig</span><span class="special">)</span></code> too
      dangerous? --CJS</em></span>)
    </p>
<p>
      To clone from a base class, which generally doesn't have any clone-related
      methods, we use the free-functions <code class="computeroutput"><span class="identifier">clone</span></code>,
      <code class="computeroutput"><span class="identifier">can_clone_as</span></code> and <code class="computeroutput"><span class="identifier">clone_as</span></code>:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span>
<span class="special">{</span>
	<span class="keyword">using</span> <span class="keyword">namespace</span> <span class="identifier">cloneable</span><span class="special">;</span>
	
	<span class="identifier">base_type</span> <span class="special">*</span><span class="identifier">foo_base</span> <span class="special">=</span> <span class="keyword">new</span> <span class="identifier">Foo</span><span class="special">();</span>
	<span class="identifier">assert</span><span class="special">(</span><span class="identifier">can_clone_as</span><span class="special">&lt;</span><span class="identifier">Foo</span><span class="special">&gt;(*</span><span class="identifier">foo_base</span><span class="special">));</span>
	
	<span class="identifier">Foo</span> <span class="special">*</span><span class="identifier">foo_clone</span> <span class="special">=</span> <span class="identifier">clone_as</span><span class="special">&lt;</span><span class="identifier">Foo</span><span class="special">&gt;(*</span><span class="identifier">foo_base</span><span class="special">);</span>
	<span class="identifier">assert</span><span class="special">(</span><span class="identifier">foo_clone</span> <span class="special">!=</span> <span class="number">0</span><span class="special">);</span>
	
    <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
    </p>
<p>
      Note that we pass references to these functions rather than pointers, and these
      functions work for <span class="emphasis"><em>Cloneable</em></span> types and generally. We can
      also pass an allocator to these functions, but more on custom allocation later.
    </p>
<p>
      Although it is fine to use the default base class in this example and other
      similar cases, we shall see that in general it is better to provide our own
      base classes. This gives us flexibility and space for customisation, allows
      us to use the types in associative containers, and to control resource management.
    </p>
<p>
      But we'll get to that later. For now, let's move on to some slightly less trivial
      examples.
    </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright © 2009 Christian Schladetsch<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="change_log.html"><img src="../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="tutorial/simple_hierarchical_cloning.html"><img src="../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
</body>
</html>
