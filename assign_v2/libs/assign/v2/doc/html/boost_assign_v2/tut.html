<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Tutorial</title>
<link rel="stylesheet" href="../../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
<link rel="home" href="../index.html" title="Chapter&#160;1.&#160;Boost.Assign 2.0">
<link rel="up" href="../index.html" title="Chapter&#160;1.&#160;Boost.Assign 2.0">
<link rel="prev" href="org.html" title="Organization">
<link rel="next" href="reference.html" title="Reference">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../boost.png"></td>
<td align="center"><a href="../../../index.html">Home</a></td>
<td align="center"><a href="../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="org.html"><img src="../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="reference.html"><img src="../../../doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="boost_assign_v2.tut"></a><a class="link" href="tut.html" title="Tutorial">Tutorial</a>
</h2></div></div></div>
<a name="boost_assign.tut.requisites"></a><h4>
<a name="id36332139"></a>
      <a class="link" href="tut.html#boost_assign.tut.requisites">Requisites</a>
    </h4>
<p>
      We assume in this tutorial that all the header files are included, as shown
      in section <a class="link" href="org.html#full_include">Organization</a> and 
</p>
<pre class="programlisting"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">assign</span><span class="special">::</span><span class="identifier">v2</span><span class="special">;</span>
</pre>
<p>
    </p>
<p>
      Headers from other libraries will not be shown in the code snippets of this
      tutorial, but they can be found in the tutorial's actual <a href="../../../tutorial.cpp" target="_top">source
      file</a>.
    </p>
<a name="boost_assign.tut.put"></a><h4>
<a name="id36332211"></a>
      <a class="link" href="tut.html#boost_assign.tut.put">Put</a>
    </h4>
<p>
      Consider this example:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="identifier">word_</span><span class="special">;</span>
<span class="keyword">const</span> <span class="keyword">char</span> <span class="identifier">x</span><span class="special">[]</span> <span class="special">=</span> <span class="string">"foo"</span><span class="special">;</span>
<span class="keyword">const</span> <span class="keyword">char</span> <span class="identifier">y</span><span class="special">[</span><span class="number">4</span><span class="special">]</span> <span class="special">=</span> <span class="special">{</span> <span class="char">'b'</span><span class="special">,</span> <span class="char">'a'</span><span class="special">,</span> <span class="char">'r'</span><span class="special">,</span> <span class="char">'\0'</span> <span class="special">};</span>
<span class="identifier">word_</span> <span class="identifier">z</span> <span class="special">=</span> <span class="string">"***baz"</span><span class="special">;</span>
<span class="identifier">std</span><span class="special">::</span><span class="identifier">map</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">word_</span><span class="special">&gt;</span> <span class="identifier">map</span><span class="special">;</span>
<span class="identifier">put</span><span class="special">(</span> <span class="identifier">map</span> <span class="special">)</span><a class="co" name="boost_assign1co" href="tut.html#boost_assign1"><img src="../../../doc/src/images/callouts/1.png" alt="1" border="0"></a><span class="special">(</span> <span class="number">1</span><span class="special">,</span> <span class="identifier">x</span><span class="special">,</span> <span class="number">3</span> <span class="special">)(</span> <span class="number">2</span><span class="special">,</span> <span class="identifier">y</span> <span class="special">)(</span> <span class="number">3</span><span class="special">,</span> <span class="identifier">z</span><span class="special">,</span> <span class="number">3</span><span class="special">,</span> <span class="number">3</span> <span class="special">)(</span> <span class="number">4</span><span class="special">,</span> <span class="string">"qux"</span> <span class="special">);</span>

<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">map</span><span class="special">[</span><span class="number">1</span><span class="special">]</span> <span class="special">==</span> <span class="string">"foo"</span> <span class="special">);</span> <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">map</span><span class="special">[</span><span class="number">2</span><span class="special">]</span> <span class="special">==</span> <span class="string">"bar"</span> <span class="special">);</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">map</span><span class="special">[</span><span class="number">3</span><span class="special">]</span> <span class="special">==</span> <span class="string">"baz"</span> <span class="special">);</span> <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">map</span><span class="special">[</span><span class="number">4</span><span class="special">]</span> <span class="special">==</span> <span class="string">"qux"</span> <span class="special">);</span>
</pre>
<p>
    </p>
<div class="calloutlist"><table border="0" summary="Callout list"><tr>
<td width="5%" valign="top" align="left"><p><a name="boost_assign1"></a><a href="#boost_assign1co"><img src="../../../doc/src/images/callouts/1.png" alt="1" border="0"></a> </p></td>
<td valign="top" align="left"><p>
          Calls <code class="computeroutput"><span class="identifier">map</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span> <span class="number">1</span><span class="special">,</span> <span class="identifier">word_</span><span class="special">(</span> <span class="identifier">x</span><span class="special">,</span>
          <span class="number">3</span> <span class="special">)</span> <span class="special">)</span></code>
        </p></td>
</tr></table></div>
<p>
      In this library, we call the variadic functor returned by <a class="link" href="reference/put.html#put"><code class="computeroutput">put</code></a>
      an <a class="link" href="reference/interpreter.html#interpreter_crtp"><span class="emphasis"><em>interpreter</em></span></a>.
      It performs two tasks:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          its arguments are forwarded to a <span class="emphasis"><em>data-generator</em></span>, which
          outputs a data element.
        </li>
<li class="listitem">
          it invokes a <span class="emphasis"><em>modifier</em></span>, <code class="computeroutput"><span class="identifier">insert</span></code>,
          in this case
        </li>
</ul></div>
<p>
      The syntax is invariant across container categories, but not the semantics:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          For a map, as above, the first argument is treated as a key, and the rest
          is forwarded to the mapped-type's constructor: <code class="computeroutput"><span class="identifier">word_</span><span class="special">(</span> <span class="identifier">x</span><span class="special">,</span>
          <span class="number">3</span> <span class="special">)</span></code>,
          in the first call. Key and data are then combined into a pair, which is
          inserted using modifier <code class="computeroutput"><span class="identifier">insert</span></code>.
        </li>
<li class="listitem">
          For a sequence container, all arguments are forwarded to the value-type's
          constructor, and the result is inserted using <code class="computeroutput"><span class="identifier">push_back</span></code>.
        </li>
</ul></div>
<p>
      For these and other container categories, see the specific rules for the <a class="link" href="reference/interpreter.html#data_gen_rules">data-generator</a> and those for the <a class="link" href="reference/interpreter.html#modifier_rules">modifier</a>.
      Also see the <a class="link" href="apx/cont.html#containers">supported containers</a>.
    </p>
<a name="boost_assign.tut.csv"></a><h4>
<a name="id36332950"></a>
      <a class="link" href="tut.html#boost_assign.tut.csv">Csv</a>
    </h4>
<p>
      As noted in the <a class="link" href="../index.html#boost_assign_v2.intro" title="Introduction">introduction</a>,
      <code class="computeroutput">put</code> caters to variable argument lists, whereas <code class="computeroutput">csv_put</code>
      is reserved for a fixed number of arguments, which is denoted <code class="literal">I</code>.
      There are two types of <code class="computeroutput">csv_put</code> overloads:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          If <code class="literal">I</code> is ommited it is assumed to be equal to one and
          is called the <span class="emphasis"><em>basic</em></span> form.
        </li>
<li class="listitem">
          If <code class="literal">I</code> is specified as an integer template parameter it
          is called the <span class="emphasis"><em>extended</em></span> form.
        </li>
</ul></div>
<p>
      Other names starting with <span class="emphasis"><em>csv</em></span> are treated similarly <sup>[<a name="id36333165" href="#ftn.id36333165" class="footnote">5</a>]</sup>. Among them, function <code class="computeroutput">csv</code> extends the interface of
      an interpreter, as shown below, in the basic form:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">numeric</span><span class="special">(</span> <span class="number">10</span> <span class="special">);</span> <span class="identifier">iota</span><span class="special">(</span> <span class="identifier">numeric</span><span class="special">,</span> <span class="number">0</span> <span class="special">);</span>
<span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="identifier">str_</span><span class="special">;</span> <span class="keyword">typedef</span> <span class="identifier">variant</span><span class="special">&lt;</span> <span class="keyword">int</span><span class="special">,</span> <span class="identifier">str_</span> <span class="special">&gt;</span> <span class="identifier">data_</span><span class="special">;</span>
<span class="identifier">array</span><span class="special">&lt;</span><span class="identifier">data_</span><span class="special">,</span> <span class="number">17</span><span class="special">&gt;</span> <span class="identifier">keypad</span><span class="special">;</span>

<a class="co" name="boost_assign2co" href="tut.html#boost_assign2"><img src="../../../doc/src/images/callouts/1.png" alt="1" border="0"></a><span class="identifier">csv</span><span class="special">(</span>
    <span class="identifier">put</span><span class="special">(</span> <span class="identifier">keypad</span> <span class="special">),</span>
    <span class="string">"+"</span><span class="special">,</span> <span class="string">"-"</span><span class="special">,</span> <span class="string">"*"</span><span class="special">,</span> <span class="string">"/"</span><span class="special">,</span> <span class="string">"="</span><span class="special">,</span> <span class="string">"."</span><span class="special">,</span> <span class="string">"c"</span>
<span class="special">).</span><span class="identifier">for_each</span><span class="special">(</span> <span class="identifier">numeric</span> <span class="special">);</span>

<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">get</span><span class="special">&lt;</span><span class="identifier">str_</span><span class="special">&gt;(</span> <span class="identifier">keypad</span><span class="special">.</span><span class="identifier">front</span><span class="special">()</span> <span class="special">)</span> <span class="special">==</span> <span class="string">"+"</span> <span class="special">);</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">get</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;(</span> <span class="identifier">keypad</span><span class="special">.</span><span class="identifier">back</span><span class="special">()</span> <span class="special">)</span> <span class="special">==</span> <span class="number">9</span> <span class="special">);</span>
</pre>
<p>
    </p>
<div class="calloutlist"><table border="0" summary="Callout list"><tr>
<td width="5%" valign="top" align="left"><p><a name="boost_assign2"></a><a href="#boost_assign2co"><img src="../../../doc/src/images/callouts/1.png" alt="1" border="0"></a> </p></td>
<td valign="top" align="left"><p>
          Equivalent to <code class="computeroutput"><span class="identifier">put</span><span class="special">(</span>
          <span class="identifier">keypad</span> <span class="special">)(</span>
          <span class="string">"+"</span> <span class="special">)(</span>
          <span class="string">"-"</span> <span class="special">)...(</span>
          <span class="string">"."</span> <span class="special">).</span><span class="identifier">for_each</span><span class="special">(</span> <span class="identifier">numeric</span> <span class="special">)</span></code>
        </p></td>
</tr></table></div>
<p>
      The second novelty to notice is the expression <code class="computeroutput"><span class="identifier">for_each</span><span class="special">(</span> <span class="identifier">numeric</span> <span class="special">)</span></code>, where <code class="computeroutput"><span class="identifier">numeric</span></code>
      is a <a href="http://svn.boost.org/svn/boost/trunk/libs/range/doc/html/range/concepts/overview.html" target="_top">range</a>.
      It instructs the interpreter to scan the range's elements, and process each
      as if passed as an individual argument. This function shares some commonality
      with the csv-form since it assumes a fixed arity, I = 1. There is also an extended
      syntax, <code class="computeroutput"><span class="identifier">for_each</span><span class="special">&lt;</span><span class="identifier">I</span><span class="special">&gt;(</span> r <span class="special">)</span></code>. See the <a class="link" href="reference/put.html" title="Put">reference</a>
      for details.
    </p>
<a name="boost_assign.tut.pipe_syntax"></a><h4>
<a name="id36333768"></a>
      <a class="link" href="tut.html#boost_assign.tut.pipe_syntax">Pipe syntax</a>
    </h4>
<p>
      Suppose we wish to put a set of integers in a container and, in the same statement,
      pass it through a mutating <a href="http://svn.boost.org/svn/boost/trunk/libs/range/doc/html/range/reference/algorithms.html" target="_top">algorithm</a>:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">std</span><span class="special">::</span><span class="identifier">deque</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">source</span><span class="special">(</span> <span class="number">6</span> <span class="special">),</span> <span class="identifier">target</span><span class="special">;</span> <span class="identifier">iota</span><span class="special">(</span> <span class="identifier">source</span><span class="special">,</span> <span class="number">0</span> <span class="special">);</span>

<span class="identifier">range</span><span class="special">::</span><span class="identifier">stable_partition</span><span class="special">(</span>
    <span class="identifier">target</span> <span class="special">|</span> <span class="identifier">_delay_put</span><span class="special">.</span><span class="identifier">for_each</span><span class="special">(</span> <span class="identifier">source</span> <span class="special">),</span>
    <span class="identifier">lambda</span><span class="special">::</span><span class="identifier">_1</span> <span class="special">%</span> <span class="number">2</span>
<span class="special">);</span>
</pre>
<p>
    </p>
<p>
      The vertical bar, <code class="computeroutput"><span class="special">|</span></code>, expresses
      the on-the-fly modification we were looking for, and call it <span class="emphasis"><em>piping</em></span>
      after the related <a href="http://en.wikipedia.org/wiki/Vertical_bar#Pipe" target="_top">idiom</a>
      by the same name. A related feature is Boost.Range's <a href="http://svn.boost.org/svn/boost/trunk/libs/range/doc/html/range/reference/adaptors.html" target="_top">range
      adaptors</a>. Also see the <a class="link" href="../index.html#boost_assign_v2.intro" title="Introduction">introduction</a>'s
      example.
    </p>
<a name="boost_assign.tut.container_generation"></a><h4>
<a name="id36333996"></a>
      <a class="link" href="tut.html#boost_assign.tut.container_generation">Container generation</a>
    </h4>
<a name="tut_cont_gen"></a><p>
      After having assigned <code class="computeroutput"><span class="identifier">target</span></code>
      and, in the same statement, passed it through a <a href="http://www.boost.org/doc/libs/1_46_0/libs/range/doc/html/range/reference/algorithms/mutating/stable_partition.html" target="_top">stable
      partition</a> algorithm, let's verify the state of the container against
      that of an in place generated container:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">assert</span><span class="special">(</span>
    <span class="identifier">range</span><span class="special">::</span><span class="identifier">equal</span><span class="special">(</span> <span class="identifier">target</span><span class="special">,</span> <span class="identifier">csv_deque</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="number">3</span><span class="special">,</span> <span class="number">5</span><span class="special">,</span> <span class="number">0</span><span class="special">,</span> <span class="number">2</span><span class="special">,</span> <span class="number">4</span><span class="special">)</span> <span class="special">)</span>
<span class="special">);</span>
</pre>
<p>
    </p>
<a name="tut_empty"></a><p>
      In keeping with our previously established <span class="emphasis"><em>csv</em></span> convention,
      container generating function <a class="link" href="reference/deque.html#csv_deque"><code class="computeroutput">csv_deque</code></a>
      is paired with a functor form, <a class="link" href="reference/deque.html#deque"><code class="computeroutput">deque</code></a>.
      Another convention, which we now introduce by way of example, is that which
      governs the generation of an empty container:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">assert</span><span class="special">(</span> <span class="identifier">deque</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;(</span> <span class="identifier">_nil</span> <span class="special">).</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span> <span class="special">);</span>    <span class="comment">// Functor form
</span><span class="identifier">assert</span><span class="special">(</span> <span class="identifier">csv_deque</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;().</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span> <span class="special">);</span>      <span class="comment">// Csv form
</span></pre>
<p>
    </p>
<p>
      In comparison, <code class="computeroutput">deque<span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;()</span></code> and <code class="computeroutput">csv_deque<span class="special">(</span>
      <span class="keyword">int</span><span class="special">()</span> <span class="special">)</span></code> generate a container of size <code class="literal">1</code>,
      whose element is default constructed.
    </p>
<a name="boost_assign.tut.pointer_containers"></a><h4>
<a name="id36334349"></a>
      <a class="link" href="tut.html#boost_assign.tut.pointer_containers">Pointer-containers</a>
    </h4>
<p>
      To insert elements in a <a href="http://www.boost.org/doc/libs/release/libs/ptr_container/doc/ptr_container.html" target="_top">pointer
      container</a>, pretend it is a value-container:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="identifier">word_</span><span class="special">;</span> <span class="identifier">ptr_set</span><span class="special">&lt;</span><span class="identifier">word_</span><span class="special">&gt;</span> <span class="identifier">words</span><span class="special">;</span>
<a class="co" name="boost_assign3co" href="tut.html#boost_assign3"><img src="../../../doc/src/images/callouts/1.png" alt="1" border="0"></a><span class="identifier">csv_put</span><span class="special">(</span> <span class="identifier">words</span><span class="special">,</span> <span class="string">"isomer"</span><span class="special">,</span> <span class="string">"ephemeral"</span><span class="special">,</span> <span class="string">"prosaic"</span> <span class="special">);</span>

<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">words</span><span class="special">.</span><span class="identifier">count</span><span class="special">(</span> <span class="string">"isomer"</span> <span class="special">)</span> <span class="special">==</span> <span class="number">1</span> <span class="special">);</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">words</span><span class="special">.</span><span class="identifier">count</span><span class="special">(</span> <span class="string">"prosaic"</span> <span class="special">)</span> <span class="special">==</span> <span class="number">1</span> <span class="special">);</span>
</pre>
<p>
    </p>
<div class="calloutlist"><table border="0" summary="Callout list"><tr>
<td width="5%" valign="top" align="left"><p><a name="boost_assign3"></a><a href="#boost_assign3co"><img src="../../../doc/src/images/callouts/1.png" alt="1" border="0"></a> </p></td>
<td valign="top" align="left"><p>
          Calls <code class="computeroutput"><span class="identifier">assoc</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span> <span class="keyword">new</span> <span class="identifier">word_</span><span class="special">(</span> <span class="identifier">s</span> <span class="special">)</span> <span class="special">)</span></code> for
          <code class="literal">s = "isomer", "ephemeral", "prosaic"</code>
        </p></td>
</tr></table></div>
<a name="boost_assign.tut.options"></a><h4>
<a name="id36334655"></a>
      <a class="link" href="tut.html#boost_assign.tut.options">Options</a>
    </h4>
<p>
      An <a class="link" href="reference/option.html" title="Option">option</a> overrides
      the default semantics, described under heading <span class="bold"><strong>Put</strong></span>,
      above, of
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          the data-generator, or
        </li>
<li class="listitem">
          the modifier
        </li>
</ul></div>
<p>
      Here's an example of an option for overriding the deduced <span class="bold"><strong>data-generator</strong></span>:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;</span> <span class="identifier">exponent</span><span class="special">;</span>

<span class="keyword">typedef</span> <span class="identifier">function</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">(</span><span class="keyword">double</span><span class="special">)&gt;</span> <span class="identifier">f_</span><span class="special">;</span>
<a class="co" name="boost_assign4co" href="tut.html#boost_assign4"><img src="../../../doc/src/images/callouts/1.png" alt="1" border="0"></a><span class="identifier">csv</span><span class="special">(</span>
    <span class="identifier">put</span><span class="special">(</span> <span class="identifier">exponent</span> <span class="special">)</span> <span class="special">%</span> <span class="special">(</span> <span class="identifier">_data</span> <span class="special">=</span> <span class="identifier">f_</span><span class="special">(</span> <span class="identifier">log10</span> <span class="special">)</span> <span class="special">)</span>
    <span class="special">,</span> <span class="number">1.0</span><span class="special">,</span> <span class="number">10.0</span><span class="special">,</span> <span class="number">100.0</span><span class="special">,</span> <span class="number">1000.0</span><span class="special">,</span> <span class="number">10000.0</span>
<span class="special">);</span>

<span class="keyword">double</span> <span class="identifier">eps</span> <span class="special">=</span> <span class="identifier">numeric</span><span class="special">::</span><span class="identifier">bounds</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;::</span><span class="identifier">smallest</span><span class="special">();</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">fabs</span><span class="special">(</span> <span class="identifier">exponent</span><span class="special">.</span><span class="identifier">front</span><span class="special">()</span> <span class="special">-</span> <span class="number">0.0</span> <span class="special">)</span> <span class="special">&lt;</span> <span class="identifier">eps</span> <span class="special">);</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">fabs</span><span class="special">(</span> <span class="identifier">exponent</span><span class="special">.</span><span class="identifier">back</span><span class="special">()</span> <span class="special">-</span> <span class="number">4.0</span> <span class="special">)</span> <span class="special">&lt;</span> <span class="identifier">eps</span> <span class="special">);</span>
</pre>
<p>
    </p>
<div class="calloutlist"><table border="0" summary="Callout list"><tr>
<td width="5%" valign="top" align="left"><p><a name="boost_assign4"></a><a href="#boost_assign4co"><img src="../../../doc/src/images/callouts/1.png" alt="1" border="0"></a> </p></td>
<td valign="top" align="left"><p>
          Equivalent to <code class="computeroutput"><span class="identifier">exponent</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span> <span class="keyword">double</span><span class="special">(</span> <span class="identifier">log10</span><span class="special">(</span> <span class="identifier">x</span> <span class="special">)</span> <span class="special">)</span> <span class="special">)</span></code>
          for <code class="literal">x = 1.0, ..., 10000.0</code>
        </p></td>
</tr></table></div>
<p>
      Option keyword <code class="computeroutput">_data</code> accepts as input two kinds of objects:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          A functor, such as <code class="computeroutput"><span class="identifier">f_</span><span class="special">(</span>
          <span class="identifier">log10</span> <span class="special">)</span></code>,
          above
        </li>
<li class="listitem">
          A keyword : <code class="computeroutput">_key</code>, <code class="computeroutput">_element</code>, <code class="computeroutput">_mapped</code>,
          and <code class="computeroutput">_value</code>.
        </li>
</ul></div>
<p>
      The second kind is only needed in rather special cases, yet here's how it works:
      with <code class="computeroutput">_data <span class="special">=</span> _value</code> <sup>[<a name="id36335250" href="#ftn.id36335250" class="footnote">6</a>]</sup> the data-generator is changed to the container's value-type constructor
      <sup>[<a name="id36335287" href="#ftn.id36335287" class="footnote">7</a>]</sup>, and likewise for other keywords.
    </p>
<p>
      Here's an example that changes the internal <span class="bold"><strong>modifier</strong></span>
      to <code class="computeroutput"><span class="identifier">push_front</span></code>:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">boost</span><span class="special">::</span><span class="identifier">circular_buffer</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">cb</span><span class="special">(</span> <span class="number">3</span> <span class="special">);</span>

<span class="identifier">assert</span><span class="special">(</span>
    <span class="identifier">range</span><span class="special">::</span><span class="identifier">equal</span><span class="special">(</span>
        <span class="identifier">cb</span> <span class="special">|</span> <span class="identifier">delay_csv_put</span><span class="special">&lt;</span><span class="identifier">push_front_</span><span class="special">,</span> <span class="number">1</span><span class="special">&gt;(</span> <span class="number">3</span><span class="special">,</span> <span class="number">2</span><span class="special">,</span> <span class="number">1</span> <span class="special">),</span>
        <span class="identifier">csv_deque</span><span class="special">(</span> <span class="number">1</span><span class="special">,</span> <span class="number">2</span><span class="special">,</span> <span class="number">3</span> <span class="special">)</span>
    <span class="special">)</span>
<span class="special">);</span>
</pre>
<p>
    </p>
<p>
      As seen from these two examples, there is a difference of syntax between the
      functor and its dual csv form:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          The functor form uses <code class="computeroutput"><span class="keyword">operator</span><span class="special">%</span></code> with an option keyword, say <code class="computeroutput">_push_front</code>.
        </li>
<li class="listitem">
          The csv form specifies the option with a template argument, say <code class="computeroutput"><span class="identifier">push_front_</span></code>.
        </li>
</ul></div>
<p>
      Consequently, only default constructible options are allowed in the second
      case. Function <code class="computeroutput">deque</code> works both ways:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">BOOST_AUTO</span><span class="special">(</span> <span class="identifier">_modifier</span><span class="special">,</span> <span class="special">(</span> <span class="identifier">_repeat</span> <span class="special">=</span> <span class="number">2</span> <span class="special">)</span> <span class="special">);</span>

<span class="identifier">assert</span><span class="special">(</span>
    <span class="identifier">boost</span><span class="special">::</span><span class="identifier">range</span><span class="special">::</span><span class="identifier">equal</span><span class="special">(</span>
        <span class="identifier">csv</span><span class="special">(</span>
            <span class="identifier">deque</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">push_front_</span><span class="special">&gt;(</span> <span class="identifier">_nil</span><span class="special">)</span> <span class="special">%</span> <span class="identifier">_modifier</span>
            <span class="special">,</span> <span class="number">1</span><span class="special">,</span> <span class="number">10</span><span class="special">,</span> <span class="number">100</span><span class="special">,</span> <span class="number">1000</span>
        <span class="special">),</span>
        <span class="identifier">csv_deque</span><span class="special">(</span> <span class="number">1000</span><span class="special">,</span> <span class="number">1000</span><span class="special">,</span> <span class="number">100</span><span class="special">,</span> <span class="number">100</span><span class="special">,</span> <span class="number">10</span><span class="special">,</span> <span class="number">10</span><span class="special">,</span> <span class="number">1</span><span class="special">,</span> <span class="number">1</span> <span class="special">)</span>
    <span class="special">)</span>
<span class="special">);</span>
</pre>
<p>
    </p>
<p>
      Composing the two options, here, could have alternatively been achieved as
      follows: <code class="computeroutput"><span class="identifier">deque</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;(</span> <span class="identifier">_nil</span><span class="special">)</span> <span class="special">%</span> <span class="identifier">_push_front</span>
      <span class="special">%</span> <span class="identifier">_modifier</span></code>.
      This composition syntax extends to an arbitrary number of options.
    </p>
<p>
      Creating a custom modifier-option is facilitated by <a class="link" href="reference/option.html#modifier_macro">macros</a>
      that manage the overhead.
    </p>
<a name="boost_assign.tut.reference_arrays"></a><h4>
<a name="id36335903"></a>
      <a class="link" href="tut.html#boost_assign.tut.reference_arrays">Reference arrays</a>
    </h4>
<p>
      In the examples that precede, <code class="computeroutput">csv_deque</code> could be replaced by
      <a class="link" href="reference/ref.html#ref_csv_array"><code class="computeroutput">ref::csv_array</code></a>, which returns
      a reference-array. The reciprocal is not true, in general:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          A reference-array is preferable if the values are expensive to copy
        </li>
<li class="listitem">
          It is necessary for working specifically with references
        </li>
</ul></div>
<p>
      The second case is illustrated below:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="keyword">int</span> <span class="identifier">x</span> <span class="special">=</span> <span class="number">4</span><span class="special">,</span> <span class="identifier">y</span> <span class="special">=</span> <span class="number">6</span><span class="special">,</span> <span class="identifier">z</span> <span class="special">=</span> <span class="special">-</span><span class="number">1</span><span class="special">;</span>
<span class="keyword">int</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">max</span> <span class="special">=</span> <span class="special">*</span><span class="identifier">max_element</span><span class="special">(</span> <span class="identifier">ref</span><span class="special">::</span><span class="identifier">csv_array</span><span class="special">(</span> <span class="identifier">x</span><span class="special">,</span> <span class="identifier">y</span><span class="special">,</span> <span class="identifier">z</span> <span class="special">)</span> <span class="special">);</span>

<span class="identifier">assert</span><span class="special">(</span> <span class="special">&amp;</span><span class="identifier">max</span> <span class="special">==</span> <span class="special">&amp;</span><span class="identifier">y</span> <span class="special">);</span>
</pre>
<p>
    </p>
<p>
      Here, an implicit conversion takes place, from each of the reference-array's
      element (a reference wrapper) to the reference it holds. More generally,
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          In read mode, as above, the context usually suffices to cause this conversion.
        </li>
<li class="listitem">
          In write-mode i.e. if the values of the held references are to be modified,
          explicit conversion is usually required.
        </li>
</ul></div>
<p>
      Explicit conversion is achieved using a <a href="http://svn.boost.org/svn/boost/trunk/libs/range/doc/html/range/reference/adaptors.html" target="_top">range
      adaptor</a> identified by keyword <code class="computeroutput">ref::_get</code>:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">vec</span><span class="special">(</span> <span class="number">3</span><span class="special">,</span> <span class="number">0</span> <span class="special">);</span>
<span class="identifier">boost</span><span class="special">::</span><span class="identifier">copy</span><span class="special">(</span>
    <span class="identifier">vec</span><span class="special">,</span>
    <span class="identifier">boost</span><span class="special">::</span><span class="identifier">begin</span><span class="special">(</span>
        <span class="identifier">ref</span><span class="special">::</span><span class="identifier">csv_array</span><span class="special">(</span> <span class="identifier">x</span><span class="special">,</span> <span class="identifier">y</span><span class="special">,</span> <span class="identifier">z</span> <span class="special">)</span> <span class="special">|</span> <span class="identifier">ref</span><span class="special">::</span><span class="identifier">_get</span>
    <span class="special">)</span>
<span class="special">);</span>

<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">x</span> <span class="special">==</span> <span class="number">0</span> <span class="special">);</span> <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">y</span> <span class="special">==</span> <span class="number">0</span> <span class="special">);</span> <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">z</span> <span class="special">==</span> <span class="number">0</span> <span class="special">);</span>
</pre>
<p>
    </p>
<p>
      In keeping with our <span class="emphasis"><em>csv</em></span> convention, <code class="computeroutput">ref::csv_array</code>
      has a functor dual, <a class="link" href="reference/ref.html#ref_array"><code class="computeroutput">ref::array</code></a>.
      Unlike <code class="computeroutput">put</code> or <code class="computeroutput">deque</code>, it is unary (not variadic).
    </p>
<a name="boost_assign.tut.chaining"></a><h4>
<a name="id36336487"></a>
      <a class="link" href="tut.html#boost_assign.tut.chaining">Chaining</a>
    </h4>
<p>
      Chaining ranges is already provided by <a href="http://svn.boost.org/svn/boost/trunk/boost/range/join.hpp" target="_top"><code class="computeroutput"><span class="identifier">join</span></code></a> in <a href="http://www.boost.org/doc/libs/release/libs/range/index.html" target="_top">Boost.Range</a>.
      Here's a <a class="link" href="reference.html#chain">variant</a> that caters to reference arrays:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">source</span><span class="special">(</span> <span class="number">8</span> <span class="special">);</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">iota</span><span class="special">(</span> <span class="identifier">source</span><span class="special">,</span> <span class="number">1</span> <span class="special">);</span>

<span class="identifier">array</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="number">4</span><span class="special">&gt;</span> <span class="identifier">head</span><span class="special">;</span> <span class="keyword">int</span> <span class="identifier">t</span><span class="special">,</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">i</span><span class="special">,</span> <span class="identifier">l</span><span class="special">;</span>
<span class="identifier">boost</span><span class="special">::</span><span class="identifier">copy</span><span class="special">(</span>
    <span class="identifier">source</span><span class="special">,</span>
    <span class="identifier">boost</span><span class="special">::</span><span class="identifier">begin</span><span class="special">(</span>
        <span class="identifier">head</span> <span class="special">|</span> <span class="identifier">_chain</span><span class="special">(</span>
            <span class="identifier">ref</span><span class="special">::</span><span class="identifier">csv_array</span><span class="special">(</span> <span class="identifier">t</span><span class="special">,</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">i</span><span class="special">,</span> <span class="identifier">l</span> <span class="special">)</span> <span class="special">|</span> <span class="identifier">ref</span><span class="special">::</span><span class="identifier">_get</span>
        <span class="special">)</span>
    <span class="special">)</span>
<span class="special">);</span>

<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">range</span><span class="special">::</span><span class="identifier">equal</span><span class="special">(</span> <span class="identifier">head</span><span class="special">,</span> <span class="identifier">csv_deque</span><span class="special">(</span> <span class="number">1</span><span class="special">,</span> <span class="number">2</span><span class="special">,</span> <span class="number">3</span><span class="special">,</span> <span class="number">4</span> <span class="special">)</span> <span class="special">)</span> <span class="special">);</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">t</span> <span class="special">==</span> <span class="number">5</span> <span class="special">);</span> <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">a</span> <span class="special">==</span> <span class="number">6</span> <span class="special">);</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">i</span> <span class="special">==</span> <span class="number">7</span> <span class="special">);</span> <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">l</span> <span class="special">==</span> <span class="number">8</span> <span class="special">);</span>
</pre>
<p>
    </p>
<p>
      It is noteworthy that this algorithm modifies <code class="computeroutput"><span class="identifier">x</span></code>,
      <code class="computeroutput"><span class="identifier">y</span></code> and <code class="computeroutput"><span class="identifier">z</span></code>
      even though the array returned by <code class="computeroutput"><span class="identifier">ref</span><span class="special">::</span><span class="identifier">csv_array</span></code>
      is a temporary. Keyword <a class="link" href="reference/ref.html#ref_get"><code class="computeroutput">ref::_get</code></a>
      is needed in conjunction with a reference-array, as explained under the previous
      heading, but otherwise it should be ommited.
    </p>
<a name="boost_assign.tut.conversion"></a><h4>
<a name="id36337102"></a>
      <a class="link" href="tut.html#boost_assign.tut.conversion">Conversion</a>
    </h4>
<p>
      This section deals with conversion from a <a href="http://svn.boost.org/svn/boost/trunk/libs/range/doc/html/range/concepts/overview.html" target="_top">Range</a>
      to collections of elements that need not (but may) support iterators. For example,
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">queue</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">C</span><span class="special">;</span>

<span class="identifier">C</span> <span class="identifier">fifo</span> <span class="special">=</span> <span class="identifier">converter</span><span class="special">(</span> <span class="identifier">csv_deque</span><span class="special">(</span> <span class="number">1</span><span class="special">,</span> <span class="number">2</span><span class="special">,</span> <span class="number">3</span> <span class="special">)</span> <span class="special">);</span>

<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">fifo</span><span class="special">.</span><span class="identifier">front</span><span class="special">()</span> <span class="special">==</span> <span class="number">1</span> <span class="special">);</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">fifo</span><span class="special">.</span><span class="identifier">back</span><span class="special">()</span> <span class="special">==</span> <span class="number">3</span> <span class="special">);</span>
</pre>
<p>
    </p>
<p>
      Notice that the left hand side of <code class="computeroutput"><span class="special">=</span></code>
      is an <a href="http://msdn.microsoft.com/en-us/library/1fe2x6kt(v=vs.80).aspx" target="_top">adapter</a>
      so, unlike the container in the right hand side, it is not a <a href="http://svn.boost.org/svn/boost/trunk/libs/range/doc/html/range/concepts/overview.html" target="_top">Range</a>.
    </p>
<p>
      The object returned by <a class="link" href="reference/conversion.html#converter">converter</a> is able to
      deduce the appropriate conversion (implicit). Some contexts, however, necessitate
      <a class="link" href="reference/conversion.html#convert">explicit conversion</a>, which is illustrated by
      continuing the above snippet as follows:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="identifier">assert</span><span class="special">(</span>
    <span class="special">(</span> <span class="identifier">csv_deque</span><span class="special">(</span> <span class="number">1</span><span class="special">,</span> <span class="number">1</span><span class="special">,</span> <span class="number">3</span> <span class="special">)</span> <span class="special">|</span> <span class="identifier">convert</span><span class="special">&lt;</span><span class="identifier">C</span><span class="special">&gt;()</span> <span class="special">)</span> <span class="special">&lt;</span> <span class="identifier">fifo</span>
<span class="special">);</span>
</pre>
<p>
    </p>
<p>
      Here's an example combining implicit and explicit conversion:
    </p>
<p>
      
</p>
<pre class="programlisting"><span class="keyword">const</span> <span class="keyword">int</span> <span class="identifier">sz</span> <span class="special">=</span> <span class="number">3</span><span class="special">;</span> <span class="keyword">typedef</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">array</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">sz</span><span class="special">&gt;</span>  <span class="identifier">row_</span><span class="special">;</span>

<span class="identifier">convert</span><span class="special">&lt;</span><span class="identifier">row_</span><span class="special">&gt;</span> <span class="identifier">as_row</span><span class="special">;</span>
<span class="identifier">boost</span><span class="special">::</span><span class="identifier">array</span><span class="special">&lt;</span><span class="identifier">row_</span><span class="special">,</span> <span class="identifier">sz</span><span class="special">&gt;</span>  <span class="identifier">matrix3x3</span> <span class="special">=</span> <span class="identifier">converter</span><span class="special">(</span>
    <span class="identifier">ref</span><span class="special">::</span><span class="identifier">array</span>
        <span class="special">(</span> <span class="identifier">ref</span><span class="special">::</span><span class="identifier">csv_array</span><span class="special">(</span> <span class="number">1</span><span class="special">,</span> <span class="number">2</span><span class="special">,</span> <span class="number">3</span> <span class="special">)</span> <span class="special">|</span> <span class="identifier">as_row</span> <span class="special">)</span>
        <span class="special">(</span> <span class="identifier">ref</span><span class="special">::</span><span class="identifier">csv_array</span><span class="special">(</span> <span class="number">4</span><span class="special">,</span> <span class="number">5</span><span class="special">,</span> <span class="number">6</span> <span class="special">)</span> <span class="special">|</span> <span class="identifier">as_row</span> <span class="special">)</span>
        <span class="special">(</span> <span class="identifier">ref</span><span class="special">::</span><span class="identifier">csv_array</span><span class="special">(</span> <span class="number">7</span><span class="special">,</span> <span class="number">8</span><span class="special">,</span> <span class="number">9</span> <span class="special">)</span> <span class="special">|</span> <span class="identifier">as_row</span> <span class="special">)</span>
<span class="special">);</span>

<span class="keyword">for</span><span class="special">(</span><span class="keyword">int</span> <span class="identifier">i</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="number">9</span><span class="special">;</span> <span class="identifier">i</span><span class="special">++)</span>
<span class="special">{</span>
    <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">matrix3x3</span><span class="special">[</span> <span class="identifier">i</span> <span class="special">/</span> <span class="number">3</span> <span class="special">][</span> <span class="identifier">i</span> <span class="special">%</span> <span class="number">3</span> <span class="special">]</span> <span class="special">==</span> <span class="identifier">i</span> <span class="special">+</span> <span class="number">1</span> <span class="special">);</span>
<span class="special">}</span>
</pre>
<p>
    </p>
<div class="footnotes">
<br><hr width="100" align="left">
<div class="footnote"><p><sup>[<a name="ftn.id36333165" href="#id36333165" class="para">5</a>] </sup>
        <span class="emphasis"><em>csv</em></span> stands for comma separated values
      </p></div>
<div class="footnote"><p><sup>[<a name="ftn.id36335250" href="#id36335250" class="para">6</a>] </sup>
        The type of expression <code class="computeroutput">_data <span class="special">=</span> _value</code>
        has alias <code class="computeroutput"><span class="identifier">value_</span></code>, so that
        <code class="computeroutput"><span class="identifier">value_</span><span class="special">()</span></code>
        can be used as a shortcut.
      </p></div>
<div class="footnote"><p><sup>[<a name="ftn.id36335287" href="#id36335287" class="para">7</a>] </sup>
        For pointer-container, pretend it is the counterpart that stores its element
        by value.
      </p></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2003 -2004 Thorsten Ottosen, 2011 Erwann Rogard<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="org.html"><img src="../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="reference.html"><img src="../../../doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
