#==============================================================================
#    Copyright (c) 2003-2006 Joel de Guzman
#    Copyright (c) 2006 Dan Marsden
#    Copyright (c) 2010 Christopher Schmidt
#
#   Use, modification and distribution is subject to the Boost Software
#   License, Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at
#   http://www.boost.org/LICENSE_1_0.txt)
#==============================================================================

import notfile ;

project
  : requirements
        <define>BOOST_FUSION_ENABLE_STATIC_ASSERTS
        <warnings>all
        <toolset>gcc:<cxxflags>-Wno-long-long
  ;
        
module timing-module
{
    rule timing-callback ( target-id * : target : start end user system )
    {
        echo $(target-id) ":" $(start) $(end) ;
    }
}
IMPORT timing-module : timing-callback : : timing-callback ;

rule report-time ( target * : source * : properties * )
{
    ALWAYS $(source) ;
    __TIMING_RULE__ on $(source) = timing-callback $(target:G=) ;
    JAM_SEMAPHORE on $(source) = fusion-compile-time-test ;
}

obj fold : fold.cpp ;
notfile fold.dummy : <action>blub @report-time test : fold ;

#for local test-file in [ glob-tree *.cpp ]
#{
#    obj $(test-file:B) : $(test-file) ;
#    notfile $(test-file).dummy : <action>blub @report-time test : $(test-file:B) ;

#    run $(test-file) :  :  :  : ;
#}

