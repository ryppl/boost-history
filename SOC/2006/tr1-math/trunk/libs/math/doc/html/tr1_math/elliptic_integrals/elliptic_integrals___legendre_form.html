<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Elliptic
      Integrals - Legendre Form</title>
<link rel="stylesheet" href="../../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.70.1">
<link rel="start" href="../../index.html" title="TR1-Math 0.9">
<link rel="up" href="../elliptic_integrals.html" title="Elliptic Integrals">
<link rel="prev" href="elliptic_integrals___carlson_form.html" title="Elliptic
      Integrals - Carlson Form">
<link rel="next" href="../references.html" title="References">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../boost.png"></td></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="elliptic_integrals___carlson_form.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../elliptic_integrals.html"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="../references.html"><img src="../../images/next.png" alt="Next"></a>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="tr1_math.elliptic_integrals.elliptic_integrals___legendre_form"></a><a href="elliptic_integrals___legendre_form.html" title="Elliptic
      Integrals - Legendre Form">Elliptic
      Integrals - Legendre Form</a></h3></div></div></div>
<div class="caution"><table border="0" summary="Caution">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="../../images/caution.png"></td>
<th align="left">Caution</th>
</tr>
<tr><td align="left" valign="top"><p>
          This is not an official Boost library, it is a library under construction,
          the code is fully functional and robust, but interfaces, library structure,
          and function names may be changed without notice.
        </p></td></tr>
</table></div>
<a name="tr1_math.elliptic_integrals.elliptic_integrals___legendre_form.synopsis"></a><h5>
<a name="id4858144"></a>
        <a href="elliptic_integrals___legendre_form.html#tr1_math.elliptic_integrals.elliptic_integrals___legendre_form.synopsis">Synopsis</a>
      </h5>
<p>
        
</p>
<pre class="programlisting">
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">math</span><span class="special">/</span><span class="identifier">special_functions</span><span class="special">/</span><span class="identifier">ellint_1</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">namespace</span> <span class="identifier">boost</span> <span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">math</span> <span class="special">{</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">T</span> <span class="identifier">ellint_f</span><span class="special">(</span><span class="identifier">T</span> <span class="identifier">phi</span><span class="special">,</span> <span class="identifier">T</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">T</span> <span class="identifier">ellint_k</span><span class="special">(</span><span class="identifier">T</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">float</span> <span class="identifier">ellint_1f</span><span class="special">(</span><span class="keyword">float</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">float</span> <span class="identifier">phi</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">double</span> <span class="identifier">ellint_1</span><span class="special">(</span><span class="keyword">double</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">double</span> <span class="identifier">phi</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">ellint_1l</span><span class="special">(</span><span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">phi</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">float</span> <span class="identifier">comp_ellint_1f</span><span class="special">(</span><span class="keyword">float</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">double</span> <span class="identifier">comp_ellint_1</span><span class="special">(</span><span class="keyword">double</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">comp_ellint_1l</span><span class="special">(</span><span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">k</span><span class="special">)</span>

<span class="special">}}</span> <span class="comment">// namespaces
</span></pre>
<p>
      </p>
<p>
        
</p>
<pre class="programlisting">
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">math</span><span class="special">/</span><span class="identifier">special_functions</span><span class="special">/</span><span class="identifier">ellint_2</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">namespace</span> <span class="identifier">boost</span> <span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">math</span> <span class="special">{</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">T</span> <span class="identifier">ellint_e</span><span class="special">(</span><span class="identifier">T</span> <span class="identifier">phi</span><span class="special">,</span> <span class="identifier">T</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">T</span> <span class="identifier">ellint_e</span><span class="special">(</span><span class="identifier">T</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">float</span> <span class="identifier">ellint_2f</span><span class="special">(</span><span class="keyword">float</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">float</span> <span class="identifier">phi</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">double</span> <span class="identifier">ellint_2</span><span class="special">(</span><span class="keyword">double</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">double</span> <span class="identifier">phi</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">ellint_2l</span><span class="special">(</span><span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">phi</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">float</span> <span class="identifier">comp_ellint_2f</span><span class="special">(</span><span class="keyword">float</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">double</span> <span class="identifier">comp_ellint_2</span><span class="special">(</span><span class="keyword">double</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">comp_ellint_2l</span><span class="special">(</span><span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">k</span><span class="special">)</span>

<span class="special">}}</span> <span class="comment">// namespaces
</span></pre>
<p>
      </p>
<p>
        
</p>
<pre class="programlisting">
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">math</span><span class="special">/</span><span class="identifier">special_functions</span><span class="special">/</span><span class="identifier">ellint_3</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">namespace</span> <span class="identifier">boost</span> <span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">math</span> <span class="special">{</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">T</span> <span class="identifier">ellint_pi</span><span class="special">(</span><span class="identifier">T</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">T</span> <span class="identifier">phi</span><span class="special">,</span> <span class="identifier">T</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="identifier">T</span> <span class="identifier">ellint_pi</span><span class="special">(</span><span class="identifier">T</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">T</span> <span class="identifier">k</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">float</span> <span class="identifier">ellint_3f</span><span class="special">(</span><span class="keyword">float</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">float</span> <span class="identifier">nu</span><span class="special">,</span> <span class="keyword">float</span> <span class="identifier">phi</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">double</span> <span class="identifier">ellint_3</span><span class="special">(</span><span class="keyword">double</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">double</span> <span class="identifier">nu</span><span class="special">,</span> <span class="keyword">double</span> <span class="identifier">phi</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">ellint_3l</span><span class="special">(</span><span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">nu</span><span class="special">,</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">phi</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">float</span> <span class="identifier">comp_ellint_3f</span><span class="special">(</span><span class="keyword">float</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">float</span> <span class="identifier">nu</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">double</span> <span class="identifier">comp_ellint_3</span><span class="special">(</span><span class="keyword">double</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">double</span> <span class="identifier">nu</span><span class="special">)</span>

<span class="keyword">inline</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">comp_ellint_3l</span><span class="special">(</span><span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">k</span><span class="special">,</span> <span class="keyword">long</span> <span class="keyword">double</span> <span class="identifier">nu</span><span class="special">)</span>

<span class="special">}}</span> <span class="comment">// namespaces
</span></pre>
<p>
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          In <code class="computeroutput"><span class="identifier">ellint_3</span><span class="special">.</span><span class="identifier">hpp</span></code>, arguments <code class="computeroutput"><span class="identifier">v</span></code>
          and <code class="computeroutput"><span class="identifier">nu</span></code> are used in lieu
          of <code class="computeroutput"><span class="identifier">n</span></code>.
        </p></td></tr>
</table></div>
<a name="tr1_math.elliptic_integrals.elliptic_integrals___legendre_form.description_and_implementation"></a><h5>
<a name="id4859989"></a>
        <a href="elliptic_integrals___legendre_form.html#tr1_math.elliptic_integrals.elliptic_integrals___legendre_form.description_and_implementation">Description
        and Implementation</a>
      </h5>
<p>
        The computations of elliptic integrals in Legendre form are very straightforward
        once Carlson's elliptic integrals are in place. It's just direct evaluations
        from <a href="introduction.html#ellint_formula">Carlson's formulas</a>.
      </p>
<p>
        Notice that the integrands are periodic can help to speed up the calculation
        and increase the precision.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          <span class="emphasis"><em>&#928;(n, &#966;, k)</em></span> is singular when <span class="emphasis"><em>n &gt; 1</em></span>,
          the integral's Cauchy principal value is returned.
        </p></td></tr>
</table></div>
<p>
        <span class="inlinemediaobject"><img src="../../plots/ellint_l.png" alt="ellint_l"></span>
      </p>
<a name="tr1_math.elliptic_integrals.elliptic_integrals___legendre_form.testing"></a><h5>
<a name="id4860065"></a>
        <a href="elliptic_integrals___legendre_form.html#tr1_math.elliptic_integrals.elliptic_integrals___legendre_form.testing">Testing</a>
      </h5>
<p>
        The test driver calculates relative errors and the following table lists
        some typical values.
      </p>
<div class="informaltable">
<h5>
<a name="id4860090"></a>
        </h5>
<table class="table">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Function</th>
<th>float</th>
<th>double</th>
<th>long
              double</th>
</tr></thead>
<tbody>
<tr>
<td><code class="computeroutput"><span class="identifier">ellint_f</span><span class="special">(</span><span class="identifier">phi</span><span class="special">,</span> <span class="identifier">k</span><span class="special">)</span></code></td>
<td>~
              10<sup>-8</sup> , 10<sup>-7</sup> </td>
<td>~ 10<sup>-16</sup> </td>
<td>~ 10<sup>-18</sup> , 10<sup>-17</sup> </td>
</tr>
<tr>
<td><code class="computeroutput"><span class="identifier">ellint_k</span><span class="special">(</span><span class="identifier">k</span><span class="special">)</span></code></td>
<td>~
              10<sup>-8</sup> </td>
<td>~ 10<sup>-16</sup> </td>
<td>~ 10<sup>-20</sup> , 10<sup>-19</sup> </td>
</tr>
<tr>
<td><code class="computeroutput"><span class="identifier">ellint_e</span><span class="special">(</span><span class="identifier">phi</span><span class="special">,</span> <span class="identifier">k</span><span class="special">)</span></code></td>
<td>~
              10<sup>-8</sup> , 10<sup>-7</sup> </td>
<td>~ 10<sup>-16</sup> </td>
<td>~ 10<sup>-18</sup> , 10<sup>-17</sup> </td>
</tr>
<tr>
<td><code class="computeroutput"><span class="identifier">ellint_e</span><span class="special">(</span><span class="identifier">k</span><span class="special">)</span></code></td>
<td>~
              10<sup>-8</sup> , 10<sup>-7</sup> </td>
<td>~ 10<sup>-16</sup> </td>
<td>~ 10<sup>-20</sup> , 10<sup>-19</sup> </td>
</tr>
<tr>
<td><code class="computeroutput"><span class="identifier">ellint_pi</span><span class="special">(</span><span class="identifier">v</span><span class="special">,</span> <span class="identifier">phi</span><span class="special">,</span> <span class="identifier">k</span><span class="special">)</span></code></td>
<td>~
              10<sup>-6</sup> </td>
<td>~ 10<sup>-16</sup> , 10<sup>-14</sup> </td>
<td>~ 10<sup>-18</sup> , 10<sup>-17</sup> </td>
</tr>
<tr>
<td><code class="computeroutput"><span class="identifier">ellint_pi</span><span class="special">(</span><span class="identifier">v</span><span class="special">,</span> <span class="identifier">k</span><span class="special">)</span></code></td>
<td>~
              10<sup>-8</sup> </td>
<td>~ 10<sup>-16</sup> , 10<sup>-14</sup> </td>
<td>~ 10<sup>-20</sup> , 10<sup>-19</sup> </td>
</tr>
</tbody>
</table>
</div>
<p>
        The results are quite robust for elliptic integrals of the first and second
        kinds in the sense that the relative error stays at close to to minimum level
        and does not fluctuate much. The elliptic integral of the third kind losts
        significant digits (5 to 6 for <code class="computeroutput"><span class="keyword">float</span></code>,
        4 to 5 for <code class="computeroutput"><span class="keyword">double</span></code>, 3 to 4 for
        <code class="computeroutput"><span class="keyword">long</span> <span class="keyword">double</span></code>)
        when <span class="emphasis"><em>|n|</em></span> is very large ( &gt; 10<sup>5</sup> ), otherwise the precision
        is good and stable. Also we can see that the complete elliptic integrals
        are more accurately computed than their incomplete counterparts by 1 or 2
        magnitudes.
      </p>
</div>
<table width="100%"><tr>
<td align="left"></td>
<td align="right"><small>Copyright © 2006 Xiaogang Zhang</small></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="elliptic_integrals___carlson_form.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../elliptic_integrals.html"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="../references.html"><img src="../../images/next.png" alt="Next"></a>
</div>
</body>
</html>
