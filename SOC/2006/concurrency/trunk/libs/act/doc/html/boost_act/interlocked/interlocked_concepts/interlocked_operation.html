<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Interlocked Operation</title><link rel="stylesheet" href="../../../../../doc/style/html/main.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.72.0" /><link rel="start" href="../../../index.html" title="Boost.Act" /><link rel="up" href="../interlocked_concepts.html" title="Interlocked Concepts" /><link rel="prev" href="../interlocked_concepts.html" title="Interlocked Concepts" /><link rel="next" href="interlocked_type.html" title="Interlocked Type" /><script type="text/javascript" src="../../../../../doc/javascript/main.js"></script>
      <script type="text/javascript" > <!--
         boostscript.init( new Array(
            boostscript.nested_links,
            boostscript.style_switcher,
            boostscript.common
         ),
         '../../../../../doc/javascript'
         );
      //--></script>

      <script type="text/javascript" > <!--
          boostscript.call( boostscript.style_switcher, 'include_alternate_stylesheets',
             '../../../../../doc/style/html/syntax.xml',
             '../../../../../doc/style/html'
          );
      //--></script>
<link rel="alternate stylesheet" type="text/css" title="Quickbook source" href="../../../../../doc/style/html/conversion/boostbook_to_quickbook.css" />
      <script type="text/javascript" > <!--
          boostscript.call( boostscript.style_switcher, 'load_user_stylesheet' );
      //--></script>
</head>
  <body>
    <div id="heading">
      <div id="heading-placard"></div>
      <div class="heading-navigation-box">
        <div class="nested-links-select-box" id="chapters_select_box">
      <script type="text/javascript" > <!--
         boostscript.call( boostscript.nested_links, 'select_box',
            'chapters_select_box',
            '../../../../../doc/chapters.xml',
            '../../../../../libs');
      //--></script>
</div>
        <div class="nested-links-select-box" id="sections_select_box">
      <script type="text/javascript" > <!--
         boostscript.call( boostscript.nested_links, 'select_box',
            'sections_select_box',
            '../../../sections.xml',
            '../../.././');
      //--></script>
</div>
      </div>
      <div class="search-box">
        <form id="cref" action="http://google.com/cse">
          <div class="search-box-label"></div>
          <div>
            <input type="hidden" name="cref" value="http://tinyurl.com/33np8c" />
            <input class="search-box" type="text" name="q" id="q" size="40" maxlength="255" alt="Search Text" />
          </div>
        </form>
      </div>
    </div>
    <div class="spirit-nav">
      <div class="spirit-nav-icon">
        <a accesskey="p" href="../interlocked_concepts.html">
          <div class="prev-icon"></div>
        </a>
      </div>
      <div class="spirit-nav-icon">
        <a accesskey="u" href="../interlocked_concepts.html">
          <div class="up-icon"></div>
        </a>
      </div>
      <div class="spirit-nav-icon">
        <a accesskey="h" href="../../../index.html">
          <div class="home-icon"></div>
        </a>
      </div>
      <div class="spirit-nav-icon">
        <a accesskey="n" href="interlocked_type.html">
          <div class="next-icon"></div>
        </a>
      </div>
    </div>
    <div id="body">
      <div id="body-inner">
        <div id="content">
          <div class="section">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="boost_act.interlocked.interlocked_concepts.interlocked_operation"></a><a href="interlocked_operation.html" title="Interlocked Operation">Interlocked
        Operation</a></h4>
                </div>
              </div>
            </div>
            <a id="boost_act.interlocked.interlocked_concepts.interlocked_operation.description"></a>
            <h6><a id="id455469"></a>
          <a href="interlocked_operation.html#boost_act.interlocked.interlocked_concepts.interlocked_operation.description">Description</a>
        </h6>
            <p>
          An <code class="literal">Interlocked Operation</code> is a function which provides
          guarantees concerning order and visibility of read and write operations
          with respect to multiple threads, often with semantics which may be specified
          by users at the call site.
        </p>
            <p>
          In order to be considered a valid <code class="literal">Interlocked Operation</code>,
          given the variable definitions below, the following expressions must be
          well-formed and have the indicated effects.
        </p>
            <div class="variablelist">
              <p class="title">
                <b>Notation</b>
              </p>
              <dl>
                <dt>
                  <span class="term">
          <em class="replaceable"><code>
            name
          </code></em>
          </span>
                </dt>
                <dd>
            An <code class="literal">Interlocked Operation</code>.
          </dd>
                <dt>
                  <span class="term">
                    <code class="computeroutput">
                      <span class="identifier">S</span>
                    </code>
                  </span>
                </dt>
                <dd>
            A <a href="interlocked_operation.html#boost_act.interlocked.interlocked_concepts.interlocked_operation.semantic_type">
            <code class="literal">Semantic Type</code></a>.
          </dd>
                <dt>
                  <span class="term">
          <em class="replaceable"><code>
            args
          </code></em>
          </span>
                </dt>
                <dd>
            The argument list (if any) for the <code class="literal">Interlocked Operation</code>.
          </dd>
              </dl>
            </div>
            <a id="boost_act.interlocked.interlocked_concepts.interlocked_operation.expression_requirements"></a>
            <h6><a id="id455609"></a>
          <a href="interlocked_operation.html#boost_act.interlocked.interlocked_concepts.interlocked_operation.expression_requirements">Expression
          Requirements</a>
        </h6>
            <div class="table">
              <a id="id455628"></a>
              <p class="title">
                <b>Table 2. Interlocked Operation Requirements</b>
              </p>
              <div class="table-contents">
                <table class="table" summary="Interlocked Operation Requirements">
                  <colgroup>
                    <col />
                    <col />
                  </colgroup>
                  <thead>
                    <tr>
                      <th>
              <p>
                Expression
              </p>
              </th>
                      <th>
              <p>
                Pre/Post-Condition
              </p>
              </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
              <p>
                <code class="computeroutput">name(args) </code>
              </p>
              </td>
                      <td>
              <p>
                Performs the operation with the default semantics as specified for
                that operation.
              </p>
              </td>
                    </tr>
                    <tr>
                      <td>
              <p>
                <code class="computeroutput">name&lt;S&gt;(args)</code>
              </p>
              </td>
                      <td>
              <p>
                Performs the operation with the specified semantics. <span class="emphasis"><em>Note:
                Not all <code class="literal">Interlocked Operations</code> support every
                <a href="interlocked_operation.html#boost_act.interlocked.interlocked_concepts.interlocked_operation.semantic_type">
                <code class="literal">Semantic Type</code></a>. Refer to documentation for
                the corresponding operation for exactly which semantics are supported
                for that operation. All <code class="literal">Interlocked Operations</code>
                must support the <code class="computeroutput"><span class="identifier">default_</span></code>
                <a href="interlocked_operation.html#boost_act.interlocked.interlocked_concepts.interlocked_operation.semantic_type">
                <code class="literal">Semantic Type</code></a>. --end note</em></span>
              </p>
              </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <br class="table-break" />
            <a id="boost_act.interlocked.interlocked_concepts.interlocked_operation.semantic_type"></a>
            <h6><a id="id455796"></a>
          <a href="interlocked_operation.html#boost_act.interlocked.interlocked_concepts.interlocked_operation.semantic_type">Semantic
          Type</a>
        </h6>
            <p>
          While all <code class="literal">Interlocked Operations</code> specify certain guarantees
          by default, these may often be toggled to make an operation's ordering
          more or less constrained by passing a <code class="literal">Semantic Type</code>
          as an explicit template argument to the corresponding template. Not all
          <code class="literal">Interlocked Operations</code> support all <code class="literal">Semantic
          Types</code>.
        </p>
            <div class="important">
              <div class="box-outer-wrapper">
                <div class="box-top-left"></div>
                <div class="box-top-right"></div>
                <div class="box-top"></div>
                <div class="box-inner-wrapper">
                  <div class="admonition-graphic">
                    <div class="admonition-icon">
                      <div class="important-icon"></div>
                    </div>
                  </div>
                  <div class="admonition-body">
                    <div class="admonition-title">Important</div>
                    <div class="admonition-content">
                      <p>
            </p>
                      <p>
              If you are unsure as to which semantics you should use for a given
              situation, it is generally safest to use the default semantics of the
              corresponding <code class="literal">Interlocked Operation</code>. If efficiency
              is important for your application, you should prefer to use the least-restrictive
              semantics that you can without breaking allowable ordering of visibility
              between threads.
            </p>
                      <p>
          </p>
                    </div>
                  </div>
                </div>
                <div class="box-bottom-left"></div>
                <div class="box-bottom-right"></div>
                <div class="box-bottom"></div>
              </div>
            </div>
            <div class="table">
              <a id="id455862"></a>
              <p class="title">
                <b>Table 3. Semantic Types</b>
              </p>
              <div class="table-contents">
                <table class="table" summary="Semantic Types">
                  <colgroup>
                    <col />
                    <col />
                  </colgroup>
                  <thead>
                    <tr>
                      <th>
              <p>
                Type
              </p>
              </th>
                      <th>
              <p>
                Ordering Guarantee
              </p>
              </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
              <p>
                <code class="computeroutput"><span class="identifier">unordered</span></code>
              </p>
              </td>
                      <td>
              <p>
                No ordering guarantee.
              </p>
              </td>
                    </tr>
                    <tr>
                      <td>
              <p>
                <code class="computeroutput"><span class="identifier">acquire</span></code>
              </p>
              </td>
                      <td>
              <p>
                The operation is made visible before all subsequent instructions.
                <code class="computeroutput"><span class="identifier">acquire</span></code> semantics
                are generally used for read or read-write operations.
              </p>
              </td>
                    </tr>
                    <tr>
                      <td>
              <p>
                <code class="computeroutput"><span class="identifier">release</span></code>
              </p>
              </td>
                      <td>
              <p>
                The operation is made visible after all prior instructions. <code class="computeroutput"><span class="identifier">release</span></code> semantics are generally
                used for write or read-write operations.
              </p>
              </td>
                    </tr>
                    <tr>
                      <td>
              <p>
                <code class="computeroutput"><span class="identifier">acq_rel</span></code>
              </p>
              </td>
                      <td>
              <p>
                Combines the ordering guarantees of both <code class="computeroutput"><span class="identifier">acquire</span></code>
                and <code class="computeroutput"><span class="identifier">release</span></code>. <code class="computeroutput"><span class="identifier">acq_rel</span></code> semantics are generally
                used for read-write operations only.
              </p>
              </td>
                    </tr>
                    <tr>
                      <td>
              <p>
                <code class="computeroutput"><span class="identifier">default_</span></code>
              </p>
              </td>
                      <td>
              <p>
                Uses the default ordering guarantees as specified by the corresponding
                <code class="literal">Interlocked Operation</code>. This <code class="literal">Semantic
                Type</code> must be supported by all <code class="literal">Interlocked Operations</code>.
              </p>
              </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <br class="table-break" />
            <div class="note">
              <div class="box-outer-wrapper">
                <div class="box-top-left"></div>
                <div class="box-top-right"></div>
                <div class="box-top"></div>
                <div class="box-inner-wrapper">
                  <div class="admonition-graphic">
                    <div class="admonition-icon">
                      <div class="note-icon"></div>
                    </div>
                  </div>
                  <div class="admonition-body">
                    <div class="admonition-title">Note</div>
                    <div class="admonition-content">
                      <p>
            </p>
                      <p>
              In a future release, another <code class="literal">Semantic Type</code> may be
              introduced called <code class="computeroutput"><span class="identifier">thread_unsafe</span></code>
              which does not perform the operation atomically at all. This type would
              be a required semantic for all <code class="literal">Interlocked Operations</code>,
              much like <code class="computeroutput"><span class="identifier">default_</span></code>.
            </p>
                      <p>
          </p>
                    </div>
                  </div>
                </div>
                <div class="box-bottom-left"></div>
                <div class="box-bottom-right"></div>
                <div class="box-bottom"></div>
              </div>
            </div>
            <a id="boost_act.interlocked.interlocked_concepts.interlocked_operation.headers"></a>
            <h6><a id="id456185"></a>
          <a href="interlocked_operation.html#boost_act.interlocked.interlocked_concepts.interlocked_operation.headers">Headers</a>
        </h6>
            <p>
          In general, you should not have to include the following files in order
          to use <code class="literal">Interlocked Operations</code>, since including the file
          for the operation implicitly includes the corresponding semantics. However,
          if you wish to create your own <code class="literal">Interlocked Operations</code>,
          you would use the headers notated below to bring in the semantic types
          which are necessary for use with your operation.
        </p>
            <p>
          
</p>
            <div class="programlisting">
              <div class="box-outer-wrapper">
                <div class="box-top-left"></div>
                <div class="box-top-right"></div>
                <div class="box-top"></div>
                <div class="box-inner-wrapper">
                  <div class="style-switcher-box" id="id456230">
      <script type="text/javascript" > <!--
          boostscript.call( boostscript.style_switcher, 'insert_style_selector',
             'id456230',
             '../../../../../doc/style/html/syntax.xml',
             '../../../../../doc/style/html'
          );
      //--></script>
</div>
                  <pre>
<span class="comment">// Brings in all semantic types.
</span><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">interlocked</span><span class="special">/</span><span class="identifier">semantics</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="comment">// Fine-grained semantic headers.
</span><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">interlocked</span><span class="special">/</span><span class="identifier">semantics</span><span class="special">/</span><span class="identifier">unordered</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">interlocked</span><span class="special">/</span><span class="identifier">semantics</span><span class="special">/</span><span class="identifier">acquire</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">interlocked</span><span class="special">/</span><span class="identifier">semantics</span><span class="special">/</span><span class="identifier">release</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">interlocked</span><span class="special">/</span><span class="identifier">semantics</span><span class="special">/</span><span class="identifier">acq_rel</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">interlocked</span><span class="special">/</span><span class="identifier">semantics</span><span class="special">/</span><span class="keyword">default</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
</pre>
                </div>
                <div class="box-bottom-left"></div>
                <div class="box-bottom-right"></div>
                <div class="box-bottom"></div>
              </div>
            </div>
            <p>
        </p>
            <a id="boost_act.interlocked.interlocked_concepts.interlocked_operation.example"></a>
            <h6><a id="id456685"></a>
          <a href="interlocked_operation.html#boost_act.interlocked.interlocked_concepts.interlocked_operation.example">Example</a>
        </h6>
            <p>
          </p>
            <p>
            
</p>
            <div class="programlisting">
              <div class="box-outer-wrapper">
                <div class="box-top-left"></div>
                <div class="box-top-right"></div>
                <div class="box-top"></div>
                <div class="box-inner-wrapper">
                  <div class="style-switcher-box" id="id456710">
      <script type="text/javascript" > <!--
          boostscript.call( boostscript.style_switcher, 'insert_style_selector',
             'id456710',
             '../../../../../doc/style/html/syntax.xml',
             '../../../../../doc/style/html'
          );
      //--></script>
</div>
                  <pre>
<span class="comment">//Bring in the multiply_assign operation (a valid Interlocked Operation).
</span><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">interlocked</span><span class="special">/</span><span class="identifier">multiply_assign</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="comment">// Bring in interlocked integer types.
</span><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">interlocked</span><span class="special">/</span><span class="identifier">integer</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="comment">/* ... */</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span>
<span class="special">{</span>
  <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="special">::</span><span class="identifier">boost</span><span class="special">::</span><span class="identifier">act</span><span class="special">::</span><span class="identifier">interlocked</span><span class="special">;</span>

  <span class="comment">// Create an interlocked integer.
</span>  <span class="identifier">int_fast32_t</span> <span class="identifier">shared_integer</span> <span class="special">=</span> <span class="number">2</span><span class="special">;</span>

  <span class="comment">/* ... (code for thread creation not shown for simplicity) ... */</span>

  <span class="comment">// Atomically multiply shared_integer by 4 and store the result back to
</span>  <span class="comment">// shared_integer. Default semantics are used (in this case, the default is
</span>  <span class="comment">// acq_rel, as noted in the documentation for multiply_assign).
</span>  <span class="identifier">multiply_assign</span><span class="special">(</span> <span class="identifier">shared_integer</span><span class="special">,</span> <span class="number">4</span> <span class="special">);</span>

  <span class="comment">// Perform a multiply_assign operation with unordered semantics.
</span>  <span class="identifier">multiply_assign</span><span class="special">&lt;</span> <span class="identifier">unordered</span> <span class="special">&gt;(</span> <span class="identifier">shared_integer</span><span class="special">,</span> <span class="number">2</span> <span class="special">);</span>

  <span class="comment">// Perform a multiply_assign operation with acquire semantics.
</span>  <span class="identifier">multiply_assign</span><span class="special">&lt;</span> <span class="identifier">acquire</span> <span class="special">&gt;(</span> <span class="identifier">shared_integer</span><span class="special">,</span> <span class="number">3</span> <span class="special">);</span>

  <span class="comment">/* ... */</span>

  <span class="comment">// Perform a multiply_assign operation explicitly with default semantics.
</span>  <span class="identifier">multiply_assign</span><span class="special">&lt;</span> <span class="identifier">default_</span> <span class="special">&gt;(</span> <span class="identifier">shared_integer</span><span class="special">,</span> <span class="number">3</span> <span class="special">);</span>
<span class="special">}</span>
</pre>
                </div>
                <div class="box-bottom-left"></div>
                <div class="box-bottom-right"></div>
                <div class="box-bottom"></div>
              </div>
            </div>
            <p>
          </p>
            <p>
          </p>
            <p>
            </p>
            <div class="calloutlist">
              <dl></dl>
            </div>
            <p>
          </p>
            <p>
        </p>
          </div>
        </div>
        <div class="clear"></div>
      </div>
    </div>
    <div class="spirit-nav">
      <div class="spirit-nav-icon">
        <a accesskey="p" href="../interlocked_concepts.html">
          <div class="prev-icon"></div>
        </a>
      </div>
      <div class="spirit-nav-icon">
        <a accesskey="u" href="../interlocked_concepts.html">
          <div class="up-icon"></div>
        </a>
      </div>
      <div class="spirit-nav-icon">
        <a accesskey="h" href="../../../index.html">
          <div class="home-icon"></div>
        </a>
      </div>
      <div class="spirit-nav-icon">
        <a accesskey="n" href="interlocked_type.html">
          <div class="next-icon"></div>
        </a>
      </div>
    </div>
    <div id="footer">
      <div id="footer-left">
        <div id="copyright">
          <p>Copyright © 2006 , 2007 Matthew Calabrese</p>
        </div>
        <div id="license">
          <p>Distributed under the
                  <a href="/LICENSE_1_0.txt" class="internal">Boost Software License, Version 1.0</a>.
               </p>
        </div>
      </div>
      <div id="footer-right">
        <div id="banners">
          <p id="banner-xhtml">
            <a href="http://validator.w3.org/check?uri=referer" class="external">XHTML 1.0</a>
          </p>
          <p id="banner-css">
            <a href="http://jigsaw.w3.org/css-validator/check/referer" class="external">CSS</a>
          </p>
          <p id="banner-sourceforge">
            <a href="http://sourceforge.net" class="external">SourceForge</a>
          </p>
        </div>
      </div>
      <div class="clear"></div>
    </div>
  </body>
</html>
