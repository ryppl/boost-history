<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Advanced Usage</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.70.1">
<link rel="start" href="../index.html" title="Boost.Act 0.4b">
<link rel="up" href="../index.html" title="Boost.Act 0.4b">
<link rel="prev" href="basic_usage.html" title="Basic Usage">
<link rel="next" href="concepts.html" title="Concepts">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%">
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../boost.png"></td>
<td align="center"><a href="../../../index.htm">Home</a></td>
<td align="center"><a href="../libraries.html">Libraries</a></td>
<td align="center"><a href="../../../people/people.htm">People</a></td>
<td align="center"><a href="../../../more/faq.htm">FAQ</a></td>
<td align="center"><a href="../../../more/index.htm">More</a></td>
</table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="basic_usage.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="concepts.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="act.advanced_usage"></a><a href="advanced_usage.html" title="Advanced Usage">Advanced Usage</a></h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="advanced_usage.html#act.advanced_usage.specifying_algorithm_models_at_the_call_site">Specifying
      Algorithm Models at the Call-Site</a></span></dt>
<dt><span class="section"><a href="advanced_usage.html#act.advanced_usage.passing_model_specific_arguments_to_polymorphic_algorithms">Passing
      Model-Specific Arguments to Polymorphic Algorithms</a></span></dt>
<dt><span class="section"><a href="advanced_usage.html#act.advanced_usage.specifying_act_models_during_action_and_active_type_instantiation">Specifying
      Act Models during Action and Active Type Instantiation</a></span></dt>
<dt><span class="section"><a href="advanced_usage.html#act.advanced_usage.overriding_a_concurrent_active_object_s_main_function">Overriding
      a Concurrent Active Object's Main Function</a></span></dt>
</dl></div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="act.advanced_usage.specifying_algorithm_models_at_the_call_site"></a><a href="advanced_usage.html#act.advanced_usage.specifying_algorithm_models_at_the_call_site" title="Specifying
      Algorithm Models at the Call-Site">Specifying
      Algorithm Models at the Call-Site</a></h3></div></div></div>
<p>
        While changing the default algorithm model allows one to adjust how parallelable
        algorithms run, you may also adjust the execution model explicitly at each
        call-site, overriding the default. This is performed by passing an algorithm
        model instantiation to a call to the index operation of provided parallelable
        algorithms.
      </p>
<pre class="programlisting">
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">algorithm</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">parallel_safe</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">common_algo_models</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">vector</span><span class="special">&gt;</span>

<span class="keyword">struct</span> <span class="identifier">operation</span>
  <span class="special">:</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">act</span><span class="special">::</span><span class="identifier">parallel_safe</span>
<span class="special">{</span>
  <span class="keyword">void</span> <span class="keyword">operator</span> <span class="special">()(</span> <span class="keyword">int</span> <span class="identifier">value</span> <span class="special">)</span> <span class="keyword">const</span>
  <span class="special">{</span>
    <span class="comment">// Implementation here
</span>  <span class="special">}</span>
<span class="special">};</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span>
<span class="special">{</span>
  <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">act</span><span class="special">;</span>
  <span class="keyword">using</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">;</span>
  
  <span class="identifier">vector</span><span class="special">&lt;</span> <span class="keyword">int</span> <span class="special">&gt;</span> <span class="identifier">dummy_data</span><span class="special">(</span> <span class="number">100</span> <span class="special">);</span>
  
  <span class="comment">// Executes in parallel regardless of default algorithm model
</span>  <span class="identifier">for_each</span><span class="special">[</span> <span class="identifier">parallel</span> <span class="special">](</span> <span class="identifier">dummy_data</span><span class="special">.</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">dummy_data</span><span class="special">.</span><span class="identifier">end</span><span class="special">()</span>
                      <span class="special">,</span> <span class="identifier">operation</span><span class="special">()</span>
                      <span class="special">);</span>

  <span class="comment">// Executes serially regardless of default algorithm model
</span>  <span class="identifier">for_each</span><span class="special">[</span> <span class="identifier">serial</span> <span class="special">](</span> <span class="identifier">dummy_data</span><span class="special">.</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">dummy_data</span><span class="special">.</span><span class="identifier">end</span><span class="special">()</span>
                    <span class="special">,</span> <span class="identifier">operation</span><span class="special">()</span>
                    <span class="special">);</span>
<span class="special">}</span>
</pre>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="act.advanced_usage.passing_model_specific_arguments_to_polymorphic_algorithms"></a><a href="advanced_usage.html#act.advanced_usage.passing_model_specific_arguments_to_polymorphic_algorithms" title="Passing
      Model-Specific Arguments to Polymorphic Algorithms">Passing
      Model-Specific Arguments to Polymorphic Algorithms</a></h3></div></div></div>
<p>
        In addition to using an algorithm model as a policy for polymorphic algorithms,
        you may also adjust the implementation of algorithms by passing model-specific
        arguments. Arguments passed in this manner are specified in place of the
        algorithm model, and the algorithm model is then deduced by the type of the
        arguments.
      </p>
<p>
        The most common use of this feature is to pass the number of worker threads
        that the parallel algorithm model should use in its implementation. Without
        specifying this count, the application will automatically determine the number
        of worker threads to use at runtime.
      </p>
<pre class="programlisting">
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">algorithm</span><span class="special">/</span><span class="identifier">copy</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">common_algo_models</span><span class="special">/</span><span class="identifier">parallel_algo_model</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span>
<span class="special">{</span>
  <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">act</span><span class="special">;</span>
  <span class="keyword">using</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">;</span>
  
  <span class="identifier">vector</span><span class="special">&lt;</span> <span class="keyword">int</span> <span class="special">&gt;</span> <span class="identifier">source</span><span class="special">(</span> <span class="number">100</span> <span class="special">),</span>
                <span class="identifier">target</span><span class="special">(</span> <span class="number">100</span> <span class="special">);</span>
  
  <span class="comment">// Executes in parallel regardless of default algorithm model
</span>  <span class="comment">// Specifies that 10 worker threads should be used
</span>  <span class="identifier">copy</span><span class="special">[</span> <span class="identifier">parallel</span><span class="special">,</span> <span class="identifier">worker_count</span> <span class="special">=</span> <span class="number">10</span> <span class="special">](</span> <span class="identifier">source</span><span class="special">.</span><span class="identifier">begin</span><span class="special">()</span>
                                     <span class="special">,</span> <span class="identifier">source</span><span class="special">.</span><span class="identifier">end</span><span class="special">()</span>
                                     <span class="special">,</span> <span class="identifier">target</span><span class="special">.</span><span class="identifier">begin</span><span class="special">()</span>
                                     <span class="special">);</span>
<span class="special">}</span>
</pre>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="act.advanced_usage.specifying_act_models_during_action_and_active_type_instantiation"></a><a href="advanced_usage.html#act.advanced_usage.specifying_act_models_during_action_and_active_type_instantiation" title="Specifying
      Act Models during Action and Active Type Instantiation">Specifying
      Act Models during Action and Active Type Instantiation</a></h3></div></div></div>
<p>
        Specifying act models during the instantiation of active types and actions
        is just as easy. For active types, use BOOST_ACTIVE_M and pass the act model
        as a second argument, encapsulated in parenthesis. For actions, pass the
        act model as a second template argument to the standard action template.
        Keep in mind that if you signal a function on an active object and wish to
        have a handle to the running operation in the form of an action, you must
        instantiate the action template with the same act model type.
      </p>
<pre class="programlisting">
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">active</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">action</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">act</span><span class="special">/</span><span class="identifier">common_act_models</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span>
<span class="special">{</span>
  <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">act</span><span class="special">;</span>
  
  <span class="comment">// Use the concurrent act model regardless of the default
</span>  <span class="identifier">BOOST_ACTIVE_M</span><span class="special">(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">),</span> <span class="special">(</span><span class="identifier">concurrent</span><span class="special">)</span> <span class="special">)</span> <span class="identifier">value</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span>
  
  <span class="comment">// Must use the same act model as above
</span>  <span class="identifier">action</span><span class="special">&lt;</span> <span class="keyword">int</span><span class="special">,</span> <span class="identifier">concurrent</span> <span class="special">&gt;</span> <span class="keyword">const</span> <span class="identifier">other_value</span> <span class="special">=</span> <span class="identifier">value</span> <span class="special">+</span> <span class="number">5</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p class="blurb">
        <span class="inlinemediaobject"><img src="../images/note.png" alt="note"></span> Much like the BOOST_ACTIVE macro, BOOST_ACTIVE_M cannot
        be used if the type being qualified is dependent on a template argument.
        Similarly, if the specified act model is dependent on a template argument,
        BOOST_ACTIVE_M cannot be used. If either of these conditions is true, you
        must use the macro BOOST_ACTIVE_M_T instead.
      </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="act.advanced_usage.overriding_a_concurrent_active_object_s_main_function"></a><a href="advanced_usage.html#act.advanced_usage.overriding_a_concurrent_active_object_s_main_function" title="Overriding
      a Concurrent Active Object's Main Function">Overriding
      a Concurrent Active Object's Main Function</a></h3></div></div></div>
<p>
        Concurrent <code class="literal">active</code> objects execute associated operations
        in their respective thread. By default, the main function of this thread
        waits for a queue of function objects and executes them in first-in, first-out
        order. In certain situations, it may be beneficial to provide an alternative
        form of main which performs other operations in between queued calls, or
        which manages how it deals with its time-slices at a lower level.
      </p>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><small>Copyright © 2006 Matthew Calabrese</small></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="basic_usage.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="concepts.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
