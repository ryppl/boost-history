import os ;
import indirect ;
import modules ;
import feature ;
import python ;

using python ;

libraries = ;

local rule probe ( python-cmd )
{
  local full-cmd =
      $(python-cmd)" -c \"from numpy.distutils import misc_util; print misc_util.get_numpy_include_dirs()" ;

  local output = [ shell-cmd $(full-cmd) ] ;
  return $(output) ;
}



if [ python.configured ]
{

project boost/numpy
  : source-location .
#  : requirements
  ;

lib boost_python ;

lib boost_numpy
  : # sources
    dtype.cpp
    scalars.cpp
    ndarray.cpp
    matrix.cpp
    ufunc.cpp
    numpy.cpp
  : # requirements
    <library>/python//python_for_extensions
    #<library>/boost/python//boost_python
    <library>boost_python
  : # default build
    <link>shared
  ;

libraries += boost_numpy ;  

}
else if ! ( --without-python in [ modules.peek : ARGV ] )
{
    message boost_numpy
        : "warning: No python installation configured and autoconfiguration"
        : "note: failed.  See http://www.boost.org/libs/python/doc/building.html"
        : "note: for configuration instructions or pass --without-python to"
        : "note: suppress this message and silently skip all Boost.NumPy targets"
        ;
}

#boost-install $(libraries) ;
