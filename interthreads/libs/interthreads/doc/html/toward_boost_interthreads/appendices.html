<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Appendices</title>
<link rel="stylesheet" href="../../../../../doc/src/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
<link rel="home" href="../index.html" title="Toward Boost.InterThreads 0.1.3">
<link rel="up" href="../index.html" title="Toward Boost.InterThreads 0.1.3">
<link rel="prev" href="reference.html" title="Reference">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../boost.png"></td>
<td align="center"><a href="../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="reference.html"><img src="../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/src/images/home.png" alt="Home"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="toward_boost_interthreads.appendices"></a><a class="link" href="appendices.html" title="Appendices">Appendices</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes">Appendix
      A: History</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_3__mars_29__2009__extraction_of_the_asynchonous_executor_framework"><span class="bold"><strong>Version 0.1.3, Mars 29, 2009</strong></span> Extraction of the Asynchonous
        Executor framework</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_2__february_8__2009__bug_fixes"><span class="bold"><strong>Version 0.1.2, February 8, 2009</strong></span> Bug fixes</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_1__january_14__2009__bug_fixes_and_test_on_more_toolsets"><span class="bold"><strong>Version 0.1.1, January 14, 2009</strong></span> Bug fixes and test
        on more toolsets</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_0__november_30__2008____announcement_of_interthreads_"><span class="bold"><strong>Version 0.1.0, November 30, 2008</strong></span> <span class="emphasis"><em>Announcement
        of Interthreads</em></span></a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__bugs_"><span class="bold"><strong>Bugs</strong></span></a></span></dt>
</dl></dd>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.rationale">Appendix
      B: Rationale</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.rationale.decorator">Thread
        Decorator</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.rationale.tss">Thread
        Specific Storage</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.rationale.ka">Keep
        Alive</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.rationale.tuple">Thread
        Tuple</a></span></dt>
</dl></dd>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.implementation">Appendix
      C: Implementation Notes</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.implementation.thread_decorator">Thread
        Decorator</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.implementation.thread_specific_storage">Thread
        Specific Storage</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.implementation.keep_alive">Keep
        Alive</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.implementation.thread_tuple">Thread
        Tuple</a></span></dt>
</dl></dd>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.acknowledgements">Appendix
      D: Acknowledgments</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.tests">Appendix
      E: Tests</a></span></dt>
<dd><dl><dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.tests.thread_specific_shared_pointer">thread_specific_shared_pointer</a></span></dt></dl></dd>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.tickets">Appendix
      F: Tickets</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.todo">Appendix G:
      Future plans</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.todo.tasks_to_do_before_review">Tasks
        to do before review</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.todo.for_later_releases">For
        later releases</a></span></dt>
</dl></dd>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="toward_boost_interthreads.appendices.changes"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.changes" title="Appendix A: History">Appendix
      A: History</a>
</h3></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_3__mars_29__2009__extraction_of_the_asynchonous_executor_framework"><span class="bold"><strong>Version 0.1.3, Mars 29, 2009</strong></span> Extraction of the Asynchonous
        Executor framework</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_2__february_8__2009__bug_fixes"><span class="bold"><strong>Version 0.1.2, February 8, 2009</strong></span> Bug fixes</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_1__january_14__2009__bug_fixes_and_test_on_more_toolsets"><span class="bold"><strong>Version 0.1.1, January 14, 2009</strong></span> Bug fixes and test
        on more toolsets</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_0__november_30__2008____announcement_of_interthreads_"><span class="bold"><strong>Version 0.1.0, November 30, 2008</strong></span> <span class="emphasis"><em>Announcement
        of Interthreads</em></span></a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.changes.__bugs_"><span class="bold"><strong>Bugs</strong></span></a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.changes.__version_0_1_3__mars_29__2009__extraction_of_the_asynchonous_executor_framework"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_3__mars_29__2009__extraction_of_the_asynchonous_executor_framework" title="Version 0.1.3, Mars 29, 2009 Extraction of the Asynchonous Executor framework"><span class="bold"><strong>Version 0.1.3, Mars 29, 2009</strong></span> Extraction of the Asynchonous
        Executor framework</a>
</h4></div></div></div>
<p>
          <span class="bold"><strong>New Features:</strong></span>
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
              Extraction of the Asynchonous Executor framework
            </li></ul></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.changes.__version_0_1_2__february_8__2009__bug_fixes"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_2__february_8__2009__bug_fixes" title="Version 0.1.2, February 8, 2009 Bug fixes"><span class="bold"><strong>Version 0.1.2, February 8, 2009</strong></span> Bug fixes</a>
</h4></div></div></div>
<p>
          <span class="bold"><strong>Fixed Bugs:</strong></span>
        </p>
<p>
          <span class="bold"><strong>v0.3.1#1: keep alive mechanism crash when setting
          <code class="computeroutput"><span class="identifier">set_on_dead_thread</span><span class="special">()</span></code>
          before enabling the mechanism.</strong></span> This was due to the fact that
          there were no default data for the backup.
        </p>
<p>
          <span class="bold"><strong>v0.3.1#2: keep alive mechanism do not detect dead
          threads.</strong></span> We need to reset the counters only when the period
          is 0.
        </p>
<p>
          <span class="bold"><strong>v0.3.1#3: The <code class="computeroutput"><span class="identifier">set_on_dead_thread</span><span class="special">()</span></code> setting is not recovered by embeeding
          kep_alive enablers/disablers.</strong></span> The problem is that the <code class="computeroutput"><span class="identifier">on_dead</span><span class="special">()</span></code>
          the function and the thread pointer were stored on the backup. It is enough
          to store them on the <code class="computeroutput"><span class="identifier">thread_keep_alive_ctx</span></code>
          and make the functions thread_safe.
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.changes.__version_0_1_1__january_14__2009__bug_fixes_and_test_on_more_toolsets"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_1__january_14__2009__bug_fixes_and_test_on_more_toolsets" title="Version 0.1.1, January 14, 2009 Bug fixes and test on more toolsets"><span class="bold"><strong>Version 0.1.1, January 14, 2009</strong></span> Bug fixes and test
        on more toolsets</a>
</h4></div></div></div>
<p>
          <span class="bold"><strong>Toolsets:</strong></span>
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
              Tested on Linux gcc 3.4.6.
            </li>
<li class="listitem">
              Tested on Linux gcc 4.1.2.
            </li>
<li class="listitem">
              Modification helping Windows (not tested)
            </li>
</ul></div>
<p>
          <span class="bold"><strong>Fixed Bugs:</strong></span>
        </p>
<p>
          <span class="bold"><strong>v0.1#1: basic_keep_alive example do not link.</strong></span>
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.changes.__version_0_1_0__november_30__2008____announcement_of_interthreads_"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.changes.__version_0_1_0__november_30__2008____announcement_of_interthreads_" title="Version 0.1.0, November 30, 2008 Announcement of Interthreads"><span class="bold"><strong>Version 0.1.0, November 30, 2008</strong></span> <span class="emphasis"><em>Announcement
        of Interthreads</em></span></a>
</h4></div></div></div>
<p>
          <span class="bold"><strong>Features:</strong></span>
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
              <code class="computeroutput"><span class="identifier">thread_decorator</span></code> setup/cleanup
              thread decorator,
            </li>
<li class="listitem">
              thread specific shared pointer,
            </li>
<li class="listitem">
              thread keep alive mechanism,
            </li>
<li class="listitem">
              thread tuples, set_once synchonizer, thread_tuple_once and thread_group_once.
            </li>
</ul></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.changes.__bugs_"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.changes.__bugs_" title="Bugs"><span class="bold"><strong>Bugs</strong></span></a>
</h4></div></div></div>
<a name="toward_boost_interthreads.appendices.changes.__bugs_._emphasis_role__bold__open_bugs___emphasis_"></a><h6>
<a name="id3061844"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.changes.__bugs_._emphasis_role__bold__open_bugs___emphasis_"><span class="bold"><strong>Open Bugs:</strong></span></a>
        </h6>
<a name="toward_boost_interthreads.appendices.changes.__bugs_._emphasis_role__bold__fixed_bugs___emphasis_"></a><h6>
<a name="id3061872"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.changes.__bugs_._emphasis_role__bold__fixed_bugs___emphasis_"><span class="bold"><strong>Fixed Bugs:</strong></span></a>
        </h6>
<p>
          <span class="bold"><strong>v0.1.1#1: keep alive mechanism crash when setting
          set_on_dead_thread before enabling the mechanism.</strong></span> This was due
          to the fact that there were no default data for the backup.
        </p>
<p>
          <span class="bold"><strong>v0.1.1#2: keep alive mechanism do not detect dead
          threads.</strong></span> We need to reste the counters only when the period
          is 0.
        </p>
<p>
          <span class="bold"><strong>v0.1.1#3: The set_on_dead_thread setting is not recovered
          by embeeding enablers/disablers.</strong></span> The problem is that the on_dead
          and th thread pointer were stored on the backup. It is enough to store
          them on the
        </p>
<p>
          <span class="bold"><strong>v0.1#1: basic_keep_alive example do not link.</strong></span>
        </p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="toward_boost_interthreads.appendices.rationale"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.rationale" title="Appendix B: Rationale">Appendix
      B: Rationale</a>
</h3></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.rationale.decorator">Thread
        Decorator</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.rationale.tss">Thread
        Specific Storage</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.rationale.ka">Keep
        Alive</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.rationale.tuple">Thread
        Tuple</a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.rationale.decorator"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.rationale.decorator" title="Thread Decorator">Thread
        Decorator</a>
</h4></div></div></div>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">Function wrapper versus thread refinement</span></dt>
<dd><p>
                The threadalert on which this library was initialy based redefined
                the boost:thread class which called implicitly the wrapper. As the
                single varying features between both threads was this wrapping of
                the thread function it has been isolated in the interthreads library.
              </p></dd>
<dt><span class="term">Static decoration variables</span></dt>
<dd><p>
                Thread decorations construction is not thread safe and must be done
                before other threads have been created and the <code class="computeroutput"><span class="identifier">decorate</span><span class="special">()</span></code> function is called.
              </p></dd>
</dl>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.rationale.tss"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.rationale.tss" title="Thread Specific Storage">Thread
        Specific Storage</a>
</h4></div></div></div>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">Non copiable/Non movable</span></dt>
<dd><p>
                Specific pointers are singletons.
              </p></dd>
<dt><span class="term">External locking</span></dt>
<dd><p>
                In order to ensure thread safety while providing as much functionality
                as possible the class allows to get the map of thread specific contexts
                as soon as the application provides a <code class="computeroutput"><span class="identifier">unique_lock</span></code>.
              </p></dd>
<dt><span class="term">Mimic thread_specific_ptr</span></dt>
<dd>
<p>
                From the point of view of the current thread thread_specific_shared_ptr
                behaves as a thread_specific_ptr. From it we takes:
              </p>
<p>
                
</p>
<pre class="programlisting"><span class="identifier">thread_specific_shared_ptr</span><span class="special">();</span>
<span class="keyword">explicit</span> <span class="identifier">thread_specific_shared_ptr</span><span class="special">(</span><span class="keyword">void</span> <span class="special">(*</span><span class="identifier">cleanup_</span><span class="special">)(</span><span class="identifier">shared_ptr_type</span><span class="special">));</span>
<span class="identifier">T</span><span class="special">*</span> <span class="identifier">get</span><span class="special">()</span> <span class="keyword">const</span><span class="special">;</span>
<span class="identifier">T</span><span class="special">*</span> <span class="keyword">operator</span><span class="special">-&gt;()</span> <span class="keyword">const</span><span class="special">;</span>
<span class="identifier">T</span><span class="special">&amp;</span> <span class="keyword">operator</span><span class="special">*()</span> <span class="keyword">const</span><span class="special">;</span>
<span class="keyword">void</span> <span class="identifier">reset</span><span class="special">();</span>
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">Y</span><span class="special">&gt;</span> <span class="keyword">void</span> <span class="identifier">reset</span><span class="special">(</span><span class="identifier">Y</span> <span class="special">*</span> <span class="identifier">p</span><span class="special">);</span>
</pre>
<p>
              </p>
</dd>
<dt><span class="term">Mimic shared_ptr</span></dt>
<dd>
<p>
                From the point of view of the other threads thread_specific_shared_ptr
                behaves as a shared_ptr lockup. From the point of view of the current
                thread the stored pointer is located in a shared_pointer, so we can
                use the shared_ptr deleter feature From shared_ptr takes:
              </p>
<p>
                
</p>
<pre class="programlisting"><span class="identifier">T</span><span class="special">*</span> <span class="identifier">get</span><span class="special">()</span> <span class="keyword">const</span><span class="special">;</span>
<span class="identifier">T</span><span class="special">*</span> <span class="keyword">operator</span><span class="special">-&gt;()</span> <span class="keyword">const</span><span class="special">;</span>
<span class="identifier">T</span><span class="special">&amp;</span> <span class="keyword">operator</span><span class="special">*()</span> <span class="keyword">const</span><span class="special">;</span>
<span class="keyword">void</span> <span class="identifier">reset</span><span class="special">();</span>
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">Y</span><span class="special">&gt;</span> <span class="keyword">void</span> <span class="identifier">reset</span><span class="special">(</span><span class="identifier">Y</span> <span class="special">*</span> <span class="identifier">p</span><span class="special">);</span>
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">Y</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">D</span><span class="special">&gt;</span> <span class="keyword">void</span> <span class="identifier">reset</span><span class="special">(</span><span class="identifier">Y</span> <span class="special">*</span> <span class="identifier">p</span><span class="special">,</span> <span class="identifier">D</span> <span class="identifier">d</span><span class="special">);</span>
<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">Y</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">D</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">A</span><span class="special">&gt;</span> <span class="keyword">void</span> <span class="identifier">reset</span><span class="special">(</span><span class="identifier">Y</span> <span class="special">*</span> <span class="identifier">p</span><span class="special">,</span> <span class="identifier">D</span> <span class="identifier">d</span><span class="special">,</span> <span class="identifier">A</span> <span class="identifier">a</span><span class="special">);</span>
</pre>
<p>
              </p>
</dd>
<dt><span class="term">Why doesn't thread_specific_shared_ptr provide a release() function?</span></dt>
<dd><p>
                As it store a shared_ptr, it cannot give away ownership unless it's
                unique() because the other copy will still destroy the object.
              </p></dd>
</dl>
</div>
<a name="toward_boost_interthreads.appendices.rationale.tss._hcmp_tss_comparaing_tsss_and_tss"></a><h6>
<a name="id3062782"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.rationale.tss._hcmp_tss_comparaing_tsss_and_tss">:hcmp_tss
          Comparaing TSSS and TSS</a>
        </h6>
<div class="table">
<a name="toward_boost_interthreads.appendices.rationale.tss.tcmp_tss"></a><p class="title"><b>Table&#160;1.&#160;Comparaing TSSS and TSS</b></p>
<div class="table-contents"><table class="table" summary="Comparaing TSSS and TSS">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                  <p>
                    Feature
                  </p>
                </th>
<th>
                  <p>
                    thread_specific_shared_ptr
                  </p>
                </th>
<th>
                  <p>
                    thread_specific_ptr
                  </p>
                </th>
<th>
                  <p>
                    Compatible
                  </p>
                </th>
</tr></thead>
<tbody>
<tr>
<td>
                  <p>
                    ownership
                  </p>
                </td>
<td>
                  <p>
                    shared
                  </p>
                </td>
<td>
                  <p>
                    exclusive
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    default constructor
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    cleanup constructor
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>: can not delete the pointer
                  </p>
                </td>
<td>
                  <p>
                    yes:must delete the pointer
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">get</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="keyword">operator</span><span class="special">-&gt;()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="keyword">operator</span><span class="special">*()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">reset</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">reset</span><span class="special">(</span><span class="identifier">T</span><span class="special">*)</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">reset</span><span class="special">(</span><span class="identifier">Y</span><span class="special">*)</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">reset</span><span class="special">(</span><span class="identifier">Y</span><span class="special">*,</span><span class="identifier">D</span><span class="special">)</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">reset</span><span class="special">(</span><span class="identifier">Y</span><span class="special">*,</span><span class="identifier">D</span><span class="special">,</span><span class="identifier">A</span><span class="special">)</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">release</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">get_mutex</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">get_map</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="keyword">operator</span><span class="special">[]()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">wait_and_get</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break">
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.rationale.ka"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.rationale.ka" title="Keep Alive">Keep
        Alive</a>
</h4></div></div></div>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">Can a thread that has just do a check point be considered as dead
            less than one second after?</span></dt>
<dd><p>
                Whell this depends on the enabling parameters. If the checking parameter
                is greater than one it could be possible that the thread do a check_point
                just before the keep alive manager do the check, seen that there
                are not enough check_points and declaring the thread dead. If you
                want to avoid this situation let the checkin to 1.
              </p></dd>
<dt><span class="term">Nesting enablers and disablers</span></dt>
<dd><p>
                Enablers/disablers use RAII, so they can be nested and the context
                be restored on the destructor.
              </p></dd>
<dt><span class="term">Configurable on dead action</span></dt>
<dd><p>
                The default action is to abort the process because I don't see any
                generic and cleaner way to manage this event. The library provides
                this hook for user wanting to try something specific.
              </p></dd>
<dt><span class="term">Who control the controler?</span></dt>
<dd><p>
                There is no way to control this thread other than adding an external
                process.
              </p></dd>
</dl>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.rationale.tuple"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.rationale.tuple" title="Thread Tuple">Thread
        Tuple</a>
</h4></div></div></div>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">Why must be not copiable?</span></dt>
<dd><p>
                Thread tuples can not be copiable since boost::thread is not copiable.
              </p></dd>
<dt><span class="term">Why should be movable?</span></dt>
<dd><p>
                If we want functions to return Thread tuples it is necessary to make
                them movable.
              </p></dd>
<dt><span class="term">Mimic boost::thread_group</span></dt>
<dd>
<p>
                thread_tuple has in common some function found in thread_group. From
                it we take
              </p>
<p>
                
</p>
<pre class="programlisting"><span class="keyword">void</span> <span class="identifier">join_all</span><span class="special">();</span>
<span class="keyword">void</span> <span class="identifier">interrupt_all</span><span class="special">();</span>
<span class="identifier">std</span><span class="special">::</span><span class="identifier">size_t</span> <span class="identifier">size</span><span class="special">();</span>
</pre>
<p>
              </p>
</dd>
<dt><span class="term">Mimic boost::thread</span></dt>
<dd>
<p>
                We can consider a thread tuple as a compound thread, and so we can
                mimic the thread intyerface. From it we takes
              </p>
<p>
                
</p>
<pre class="programlisting"><span class="keyword">void</span> <span class="identifier">join</span><span class="special">();</span>
<span class="keyword">void</span> <span class="identifier">interrupt</span><span class="special">();</span>
<span class="keyword">void</span> <span class="identifier">detach</span><span class="special">/</span><span class="identifier">detach_all</span><span class="special">();</span>
<span class="keyword">bool</span> <span class="identifier">interruption_requested</span><span class="special">()</span> <span class="keyword">const</span><span class="special">;</span>
<span class="keyword">void</span> <span class="identifier">timed_join</span><span class="special">/</span><span class="identifier">timed_join_all</span><span class="special">();</span>
<span class="keyword">bool</span> <span class="identifier">joinable</span><span class="special">/</span><span class="identifier">all_joinable</span><span class="special">()</span> <span class="keyword">const</span><span class="special">;</span>
</pre>
<p>
              </p>
</dd>
<dt><span class="term">Why the user can not modify directly the embeeded threads?</span></dt>
<dd>
<p>
                The library provides a safe function to get a constant thread reference
              </p>
<p>
                
</p>
<pre class="programlisting"><span class="keyword">const</span> <span class="identifier">thread</span><span class="special">&amp;</span> <span class="keyword">operator</span><span class="special">[](</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">size_t</span> <span class="identifier">i</span><span class="special">)</span> <span class="keyword">const</span><span class="special">;</span></pre>
<p>
              </p>
<p>
                The problem if we provide the non constant variant is that the user
                can detach them.
              </p>
</dd>
<dt><span class="term">Joining the first finishing thread of a thread tuple</span></dt>
<dd><p>
                This functionallity has a price. We need to synchronize all the threads
                transparently, so we need to wrap the user thread functions.
              </p></dd>
</dl>
</div>
<a name="toward_boost_interthreads.appendices.rationale.tuple._hcmp_thread_comparaing_thread__thread_group_and_thread_tuple"></a><h6>
<a name="id3064259"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.rationale.tuple._hcmp_thread_comparaing_thread__thread_group_and_thread_tuple">:hcmp_thread
          Comparaing thread, thread_group and thread_tuple</a>
        </h6>
<div class="table">
<a name="toward_boost_interthreads.appendices.rationale.tuple.tcmp_thread"></a><p class="title"><b>Table&#160;2.&#160;Comparaing thread, thread_group and thread_tuple</b></p>
<div class="table-contents"><table class="table" summary="Comparaing thread, thread_group and thread_tuple">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                  <p>
                    Feature
                  </p>
                </th>
<th>
                  <p>
                    thread
                  </p>
                </th>
<th>
                  <p>
                    thread_group
                  </p>
                </th>
<th>
                  <p>
                    thread_tuple
                  </p>
                </th>
<th>
                  <p>
                    Compatible
                  </p>
                </th>
</tr></thead>
<tbody>
<tr>
<td>
                  <p>
                    default constructor
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    copiable
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    movable
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">joinable</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no*
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">join</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no*
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">timed_join</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no*
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">interruption_requested</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no*
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">join_all</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">timed_join_all</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">interrupt_all</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">size</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no* *
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">join_first_then_interrupt</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no* * *
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">timed_join_first_then_interrupt</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no* * *
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="keyword">operator</span><span class="special">[]()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
</tr>
<tr>
<td>
                  <p>
                    <code class="computeroutput"><span class="identifier">swap</span><span class="special">()</span></code>
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no
                  </p>
                </td>
<td>
                  <p>
                    <span class="bold"><strong>yes</strong></span>
                  </p>
                </td>
<td>
                  <p>
                    no*
                  </p>
                </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">*</span></dt>
<dd><p>
                thread_group could add these synonym functions
              </p></dd>
<dt><span class="term">* *</span></dt>
<dd><p>
                thread could add the size function returning 1
              </p></dd>
<dt><span class="term">* * *</span></dt>
<dd><p>
                thread &amp; thread_group could add these functions
              </p></dd>
</dl>
</div>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="toward_boost_interthreads.appendices.implementation"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.implementation" title="Appendix C: Implementation Notes">Appendix
      C: Implementation Notes</a>
</h3></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.implementation.thread_decorator">Thread
        Decorator</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.implementation.thread_specific_storage">Thread
        Specific Storage</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.implementation.keep_alive">Keep
        Alive</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.implementation.thread_tuple">Thread
        Tuple</a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.implementation.thread_decorator"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.implementation.thread_decorator" title="Thread Decorator">Thread
        Decorator</a>
</h4></div></div></div>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">Thread safe</span></dt>
<dd><p>
                The library is thread safe as far as the thread decorations are declared
                staticaly, because these variables will be initialized sequentially.
              </p></dd>
<dt><span class="term">Chained thread decorations</span></dt>
<dd><p>
                All the thread decorations are chained between them.
              </p></dd>
</dl>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.implementation.thread_specific_storage"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.implementation.thread_specific_storage" title="Thread Specific Storage">Thread
        Specific Storage</a>
</h4></div></div></div>
<p>
          The Thread-Specific Storage pattern can be implemented in various ways
        </p>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">External versus internal thread storage</span></dt>
<dd><p>
                The thread specific data collections can be stored either externally
                to all threads or internally to each thread. The thread_specific_shared_ptr
                use both ensuring efficiency when the context is requested by the
                current thread and allowing threads to access thread specific pointer
                of other threads
              </p></dd>
<dt><span class="term">Fixed- vs. variable-sized thread specific key mapping</span></dt>
<dd><p>
                This library is based on the the Boost.Thread thread_specific_ptr
                implementation which use a variable-size map indexed by the address
                of the object. Future releases will provide fixed and mixed keys.
              </p></dd>
<dt><span class="term">Fixed- vs. variable-sized mapping of thread IDs to thread specific
            pointers</span></dt>
<dd><p>
                It may be impractical to have a fixed-size array with an entry for
                every possible thread ID value. Instead, it is more space efficient
                to have threads use a dynamic data structure to map thread IDs to
                thread specific pointers.
              </p></dd>
<dt><span class="term">One mapping of thread IDs to thread specific pointers or to thread
            specific key mapping</span></dt>
<dd><p>
                This library maps thread IDs to thread specific pointers to avoid
                contention on a single map.
              </p></dd>
<dt><span class="term">Default versus explicit specific context setting</span></dt>
<dd><p>
                This library provides explicit setting. In future release will provide
                explicit/eager and implicit/lazy specific context setting. Note that
                implicit setting will need a factory or a default constructible type.
              </p></dd>
<dt><span class="term">Ordered or unordered map</span></dt>
<dd><p>
                While the thread::id type is ordered, there is no need to use it.
                The current implementation use an ordered map. Future version will
                allow the user to configure this.
              </p></dd>
<dt><span class="term">Intrusive or not maps</span></dt>
<dd><p>
                As the thread specific pointer is stored on only one map the implementation
                could use an intrusive container. This will be provided in future
                releases
              </p></dd>
<dt><span class="term">Shared versus exclusive locking</span></dt>
<dd><p>
                Locating the right TS pointer requires the use of mutex to prevent
                race conditions. The library use a a shared_mutex because most of
                the access to the map will be readings by other threads. The problem
                is that the native conditions can not be used directly with shared
                mutex. Some benchmarks will be needed before decidinf which implementation
                is the best.
              </p></dd>
</dl>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.implementation.keep_alive"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.implementation.keep_alive" title="Keep Alive">Keep
        Alive</a>
</h4></div></div></div>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">Ensuring keep alive manager singleton is initialized and the thread
            specific shared storage is set before use</span></dt>
<dd><p>
                The use of the thread decoration ensures that the decoration are
                called before the user thread function is called. The keep_alive
                decoration use the call_once to ensure that the keep_alive manager
                is correctly initialized.
              </p></dd>
<dt><span class="term">backup/restore context</span></dt>
<dd><p>
                The real thread specific data is stored directly on the stack of
                enablers/disablers avoiding heap memory. On enablers/disablers construction
                they store a backup pointer to the nesting context. This allows a
                quick restore. The keep alive pointer contains just a pointer to
                this data.
              </p></dd>
</dl>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.implementation.thread_tuple"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.implementation.thread_tuple" title="Thread Tuple">Thread
        Tuple</a>
</h4></div></div></div>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">Joining the first finishing thread</span></dt>
<dd><p>
                In order to synchronize the end of all the threads the libarry use
                a internal class which stores the index of the first thread notifying
                that it is finished. As the user function has no idea of this index
                we need to wrap the user thread functions.
              </p></dd>
</dl>
</div>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="toward_boost_interthreads.appendices.acknowledgements"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.acknowledgements" title="Appendix D: Acknowledgments">Appendix
      D: Acknowledgments</a>
</h3></div></div></div>
<p>
        Part of this library (thread_decorator and thread_specific_shared_ptr) are
        based on the original implementation of <a href="http://www.boost-consulting.com/vault/index.php?directory=Concurrent%20Programming" target="_top"><span class="bold"><strong>threadalert</strong></span></a> written by Roland Schwarz (thread::init
        and thread_member_ptr). Many Thanks to Roland that allowed me to adapt his
        implementation.
      </p>
<p>
        Thanks also must go to Jochen Heckl for the ideas given respect to the thread_tuple::wait_first
        implementation.
      </p>
<p>
        You can help me to make this library better! Any feedback is very welcome.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="toward_boost_interthreads.appendices.tests"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.tests" title="Appendix E: Tests">Appendix
      E: Tests</a>
</h3></div></div></div>
<div class="toc"><dl><dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.tests.thread_specific_shared_pointer">thread_specific_shared_pointer</a></span></dt></dl></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.tests.thread_specific_shared_pointer"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.tests.thread_specific_shared_pointer" title="thread_specific_shared_pointer">thread_specific_shared_pointer</a>
</h4></div></div></div>
<div class="informaltable"><table class="table">
<colgroup></colgroup>
<tbody></tbody>
</table></div>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="toward_boost_interthreads.appendices.tickets"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.tickets" title="Appendix F: Tickets">Appendix
      F: Tickets</a>
</h3></div></div></div>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Kind
                </p>
              </th>
<th>
                <p>
                  Identifier
                </p>
              </th>
<th>
                <p>
                  Description
                </p>
              </th>
<th>
                <p>
                  Resolution
                </p>
              </th>
<th>
                <p>
                  State
                </p>
              </th>
<th>
                <p>
                  Tests
                </p>
              </th>
<th>
                <p>
                  Version
                </p>
              </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  bug
                </p>
              </td>
<td>
                <p>
                  v0.1#1
                </p>
              </td>
<td>
                <p>
                  basic_keep_alive example do not link
                </p>
              </td>
<td>
                <p>
                  Add to the link
                </p>
              </td>
<td>
                <p>
                  Closed
                </p>
              </td>
<td>
                <p>
                  See basic_keep_alive.cpp example
                </p>
              </td>
<td>
                <p>
                  v0.2
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  bug
                </p>
              </td>
<td>
                <p>
                  v0.1.1#1
                </p>
              </td>
<td>
                <p>
                  keep alive mechanism crash when setting set_on_dead_thread before
                  enabling the mechanism
                </p>
              </td>
<td>
                <p>
                  This was due to the fact that there were no default data for the
                  backup.
                </p>
              </td>
<td>
                <p>
                  Closed
                </p>
              </td>
<td>
                <p>
                  See basic_keep_alive.cpp example
                </p>
              </td>
<td>
                <p>
                  v0.4
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  bug
                </p>
              </td>
<td>
                <p>
                  v0.1.1#2
                </p>
              </td>
<td>
                <p>
                  keep alive mechanism do not detect dead threads
                </p>
              </td>
<td>
                <p>
                  We need to reset the counters only when the period is 0.
                </p>
              </td>
<td>
                <p>
                  Closed
                </p>
              </td>
<td>
                <p>
                  See basic_keep_alive.cpp example
                </p>
              </td>
<td>
                <p>
                  v0.4
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  bug
                </p>
              </td>
<td>
                <p>
                  v0.1.1#3
                </p>
              </td>
<td>
                <p>
                  The set_on_dead_thread setting is not recovered by embeeding enablers/disablers
                </p>
              </td>
<td>
                <p>
                  The problem is that the on_dead and th thread pointer were stored
                  on the backup. It is enough to store them on the
                </p>
              </td>
<td>
                <p>
                  Closed
                </p>
              </td>
<td>
                <p>
                  See basic_keep_alive.cpp example
                </p>
              </td>
<td>
                <p>
                  v0.4
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  bug
                </p>
              </td>
<td>
                <p>
                  v0.2.0#1
                </p>
              </td>
<td>
                <p>
                  xxx
                </p>
              </td>
<td>
                <p>
                  xx
                </p>
              </td>
<td>
                <p>
                  Open
                </p>
              </td>
<td>
                <p>
                  xxx
                </p>
              </td>
<td>
                <p>
                  v0.4.1
                </p>
              </td>
</tr>
</tbody>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="toward_boost_interthreads.appendices.todo"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo" title="Appendix G: Future plans">Appendix G:
      Future plans</a>
</h3></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.todo.tasks_to_do_before_review">Tasks
        to do before review</a></span></dt>
<dt><span class="section"><a href="appendices.html#toward_boost_interthreads.appendices.todo.for_later_releases">For
        later releases</a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.todo.tasks_to_do_before_review"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.tasks_to_do_before_review" title="Tasks to do before review">Tasks
        to do before review</a>
</h4></div></div></div>
<a name="toward_boost_interthreads.appendices.todo.tasks_to_do_before_review.complete_the_tests"></a><h6>
<a name="id3066297"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.tasks_to_do_before_review.complete_the_tests">Complete
          the tests</a>
        </h6>
<p>
          Even if the current release include some test there is yet a long way before
          been able to review the library.]]
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
              change the test so they take less time using locks; conditions and
              variables.
            </li>
<li class="listitem">
              Add test with functions throwing
            </li>
<li class="listitem">
              Formalize the tests for thread_decoratoor
            </li>
<li class="listitem">
              Formalize the tests for thread_specific_shared_ptr
            </li>
<li class="listitem">
              Add tests for keep alive mechanism
            </li>
</ul></div>
<a name="toward_boost_interthreads.appendices.todo.tasks_to_do_before_review.add_more_examples"></a><h6>
<a name="id3066370"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.tasks_to_do_before_review.add_more_examples">Add
          more examples</a>
        </h6>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
              Complete the STM example.
            </li>
<li class="listitem">
              Change the implementation of the file on the async_ostream.
            </li>
</ul></div>
<a name="toward_boost_interthreads.appendices.todo.tasks_to_do_before_review.change_the_rational_and_implementation_sections"></a><h6>
<a name="id3066414"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.tasks_to_do_before_review.change_the_rational_and_implementation_sections">Change
          the rational and implementation sections</a>
        </h6>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="toward_boost_interthreads.appendices.todo.for_later_releases"></a><a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.for_later_releases" title="For later releases">For
        later releases</a>
</h4></div></div></div>
<a name="toward_boost_interthreads.appendices.todo.for_later_releases.add_c__0x_move_semantics_on_compilers_supporting_it_and_use_the_boost_move_emulation_otherwise"></a><h6>
<a name="id3066456"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.for_later_releases.add_c__0x_move_semantics_on_compilers_supporting_it_and_use_the_boost_move_emulation_otherwise">Add
          C++0x move semantics on compilers supporting it and use the Boost.Move
          emulation otherwise</a>
        </h6>
<a name="toward_boost_interthreads.appendices.todo.for_later_releases.use_c__0x_variadic_templates_on_compilers_supporting_it_and_use_the_preprocesor_otherwise"></a><h6>
<a name="id3066486"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.for_later_releases.use_c__0x_variadic_templates_on_compilers_supporting_it_and_use_the_preprocesor_otherwise">Use
          C++0x variadic templates on compilers supporting it and use the preprocesor
          otherwise</a>
        </h6>
<a name="toward_boost_interthreads.appendices.todo.for_later_releases.use_c__0x_concepts_on_compilers_supporting_them_and_use_the_boost_conceptcheck_or_boost_concepttraits_otherwise"></a><h6>
<a name="id3066516"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.for_later_releases.use_c__0x_concepts_on_compilers_supporting_them_and_use_the_boost_conceptcheck_or_boost_concepttraits_otherwise">Use
          C++0x Concepts on compilers supporting them and use the Boost.ConceptCheck
          or Boost.ConceptTraits otherwise</a>
        </h6>
<a name="toward_boost_interthreads.appendices.todo.for_later_releases.add_a_daemon_controlling_all_the_keep_alive_controller_threads"></a><h6>
<a name="id3066547"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.for_later_releases.add_a_daemon_controlling_all_the_keep_alive_controller_threads">Add
          a daemon controlling all the keep alive controller threads</a>
        </h6>
<p>
          This daemon will send regular keep_alive messages and kill the process
          when dead.
        </p>
<a name="toward_boost_interthreads.appendices.todo.for_later_releases.optimize_the_tsss_maps_using_intrusive_containers"></a><h6>
<a name="id3066584"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.for_later_releases.optimize_the_tsss_maps_using_intrusive_containers">Optimize
          the TSSS maps using intrusive containers</a>
        </h6>
<a name="toward_boost_interthreads.appendices.todo.for_later_releases.generalize_both_specific_pointers_in_a_template_class_basic_thread_specific_ptr"></a><h6>
<a name="id3066606"></a>
          <a class="link" href="appendices.html#toward_boost_interthreads.appendices.todo.for_later_releases.generalize_both_specific_pointers_in_a_template_class_basic_thread_specific_ptr">Generalize
          both specific pointers in a template class basic_thread_specific_ptr</a>
        </h6>
<p>
          <span class="bold"><strong>Domain Features</strong></span>
        </p>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term">ownership: exclusive/shared</span></dt>
<dd><p>
                Specifies if the pointer is exclusive to the thread or shared with
                other threads.
              </p></dd>
<dt><span class="term">key range: fixed/variable/mixed </span></dt>
<dd><p>
                Specifies how the key range is defined. fixed has an integer range
                0..n, variable takes as key the address of the specific_ptr and mixed
                use a variant of fixed or variable key.
              </p></dd>
<dt><span class="term">key creation: eager/lazy</span></dt>
<dd><p>
                Specifies how the key is created, eager at construction time, lazy
                when needed.
              </p></dd>
<dt><span class="term">context setting: eager/lazy</span></dt>
<dd><p>
                Specifies how the pointer is set, eager at thread initialization
                time, lazy when needed.
              </p></dd>
</dl>
</div>
<p>
          The current <code class="computeroutput"><span class="identifier">thread_specific_ptr</span></code>
          is exclusive, has a variable key range and so the key is initialized at
          construction time and explicit context setting by user on the current thread.
        </p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">basic_thread_specific_ptr</span><span class="special">&lt;</span><span class="identifier">exclusive</span><span class="special">,</span> <span class="identifier">variable_key_range</span><span class="special">&lt;&gt;,</span> <span class="identifier">eager_context_setting</span><span class="special">&gt;</span> <span class="identifier">thread_specific_ptr</span><span class="special">;</span>
</pre>
<p>
          The current <code class="computeroutput"><span class="identifier">thread_specific_shared_ptr</span></code>
          is shared, has a variable key range and so the key is initialized at construction
          time and explicit context setting by user on the current thread.
        </p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">basic_thread_specific_ptr</span><span class="special">&lt;</span><span class="identifier">exclusive</span><span class="special">,</span> <span class="identifier">variable_key_range</span><span class="special">&lt;&gt;,</span> <span class="identifier">eager_context_setting</span><span class="special">&gt;</span> <span class="identifier">thread_specific_ptr</span><span class="special">;</span>
</pre>
<p>
          <span class="bold"><strong>Design rationale</strong></span>
        </p>
<p>
          <code class="computeroutput"><span class="identifier">boost</span><span class="special">::</span><span class="identifier">thread_specific_ptr</span></code> uses as key the address
          of the variable. This has as consequence that the mapping from keys to
          the thread specific context pointer is much less efficient that the direct
          access provided by some implementations. In this concern this library would
          try to improve the performance to this mapping providing direct access
          keys. As the number of direct access keys must be know at compile time
          this has a limit on the number of thread specific pointers. A mixed approach
          would be also provided in which the key could be a fixed one or a variable
          one. It is up to the user to give an hint of the key sort. When using fixed
          or mixed keys, there is decision to take related to when the key is created,
          i.e. eager before the threads starts or lazy when we need it.
        </p>
<p>
          Non-portable: The interfaces of POSIX Pthreads, Solaris threads, and Win32
          threads are very similar. However, the semantics of Win32 threads are subtly
          different since they do not provide a reliable means of cleaning up objects
          allocated in thread-specific storage when a thread exits. Moreover, there
          is no API to delete a key in Solaris threads. This makes it hard to write
          portable code among UNIX and Win32 platforms.
        </p>
<p>
          So we need to implement it on top of the underlying OS. The idea is to
          take a native thread specific pointer which will manage with the fixed,
          variable and mixed keys. This exactly the approach of <code class="computeroutput"><span class="identifier">boost</span><span class="special">::</span><span class="identifier">thread_specific_ptr</span></code>
          but only for variable keys.
        </p>
<p>
          Just to finish, we need to decide when the context is set, two possibilities:
          the user sets explicitlly the context when it considers pertinent or the
          context is created lazily the first time we try to get it. The first approach
          has the liability that the user needs to ensure that the context is set
          before get them, but when the context must be set before the function thread
          starts this is a no issue. The second is safe but has as consequence that
          every access include a check. In addition the type must be default constructible.
        </p>
<pre class="programlisting"><span class="identifier">bith</span><span class="special">::</span><span class="identifier">thread_specific_shared_ptr</span><span class="special">&lt;</span><span class="identifier">myclass</span><span class="special">,</span> <span class="identifier">lazy_setting</span><span class="special">&gt;</span> <span class="identifier">ptr</span><span class="special">;</span>
</pre>
<p>
          The pointer will be initilaized when needed as if we had do
        </p>
<pre class="programlisting"><span class="keyword">if</span> <span class="special">(</span><span class="identifier">ptr</span><span class="special">.</span><span class="identifier">get</span><span class="special">()==</span><span class="number">0</span><span class="special">)</span> <span class="special">{</span>
    <span class="identifier">ptr</span><span class="special">.</span><span class="identifier">reset</span><span class="special">(</span> <span class="keyword">new</span> <span class="identifier">myclass</span><span class="special">()</span> <span class="special">);</span>
<span class="special">}</span>
</pre>
<p>
          Between the features:
        </p>
<p>
          Thread_specific key mapping optimization: Replace the Boost.Thread thread_specific_ptr
          thread specific key mapping implementation by a mix of fixed/variable mapping
          which will provide efficient access to the fixed keys and scalability with
          the others keys.
        </p>
<p>
          Configuration the fixed/variable/mixed key range, ordered/unordered map,
          intrusive/extrusive map, shared/exclusive locking.
        </p>
</div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2008 -2009,2011 Vicente J. Botet Escriba<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="reference.html"><img src="../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/src/images/home.png" alt="Home"></a>
</div>
</body>
</html>
