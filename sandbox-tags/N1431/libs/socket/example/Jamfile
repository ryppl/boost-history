# declare the location of this subproject relative to the root

subproject libs/socket/example ;

# bring in the rules for testing
SEARCH on testing.jam = $(BOOST_BUILD_PATH) ;
include testing.jam ;

B_ROOT ?= c:/usr/boost ;
SPIRIT_ROOT ?= c:/usr/spirit ;

rule socket-example ( example-name : sources + )
{
    exe $(example-name) :
      $(sources)
	<lib>../build/boost_socket
	:
	<include>$(B_ROOT)
	<include>$(BOOST_ROOT)
	<include>$(SPIRIT_ROOT)
	<runtime-link>static
	<threading>single
	<bcc56><*><cxxflags>-Q
	<bcc56><*><cxxflags>-w-stl
	<bcc56><*><find-library>Ws2_32
	<msvc><*><find-library>Ws2_32
	<vc7><*><find-library>Ws2_32
	<gcc><*><find-library>Ws2_32
	;
}

rule socket-test-example ( example-name : sources + )
{
    exe $(example-name) :
      $(sources)
	<lib>../build/boost_socket
	:
	<include>$(B_ROOT)
	<include>$(BOOST_ROOT)
	<library-path>$(B_ROOT)/libs/test/build/bin/libboost_unit_test_framework.lib/$(TOOLS)/debug/runtime-link-static/threading-single
	<gcc><*><find-library>boost_unit_test_framework
	<borland><*><find-library>libboost_unit_test_framework
	<bcc56><*><find-library>libboost_unit_test_framework
	<vc7><*><find-library>libboost_unit_test_framework
	<msvc><*><find-library>libboost_unit_test_framework
	<bcc56><*><cxxflags>-Q
	<bcc56><*><cxxflags>-w-stl
	<runtime-link>static
	<threading>single
	<msvc><*><find-library>Ws2_32
	<vc7><*><find-library>Ws2_32
	<gcc><*><find-library>Ws2_32
	;
}

rule asynch-socket-test-example ( example-name : sources + )
{
    exe $(example-name) :
      $(sources)
	<lib>../build/boost_socket 
	:
	<include>$(B_ROOT)
	<include>$(BOOST_ROOT)
	<library-path>$(B_ROOT)/libs/test/build/bin/libboost_unit_test_framework.lib/$(TOOLS)/debug/runtime-link-static/threading-multi
    <library-path>$(B_ROOT)/libs/thread/build/bin/boost_thread.dll/$(TOOLS)/release/runtime-link-static/threading-multi	
    <library-path>$(B_ROOT)/libs/date_time/build/bin/libboost_date_time.lib/$(TOOLS)/debug/runtime-link-dynamic

	<gcc><*><find-library>boost_unit_test_framework
	<borland><*><find-library>libboost_unit_test_framework
	<bcc56><*><find-library>libboost_unit_test_framework
	<vc7><*><find-library>libboost_unit_test_framework
	<msvc><*><find-library>libboost_unit_test_framework

    <gcc><*><find-library>boost_date_time	
	<borland><*><find-library>libboost_date_time
	<bcc56><*><find-library>libboost_date_time
	<vc7><*><find-library>libboost_date_time
	<msvc><*><find-library>libboost_date_time
	
	<gcc><*><find-library>boost_thread
	<borland><*><find-library>boost_thread
	<bcc56><*><find-library>boost_thread
	<vc7><*><find-library>boost_thread
	<msvc><*><find-library>boost_thread

	<bcc56><*><cxxflags>-Q
	<bcc56><*><cxxflags>-w-stl
	<runtime-link>static
	<threading>multi

	<msvc><*><find-library>Ws2_32
	<vc7><*><find-library>Ws2_32
	<gcc><*><find-library>Ws2_32

	<msvc><*><find-library>mswsock
	<vc7><*><find-library>mswsock
	<gcc><*><find-library>mswsock
	;
}


socket-test-example simple_client : client_test.cpp ;
socket-test-example simple_server : server_test.cpp ;
asynch-socket-test-example asynch_accept : asynch_accept.cpp ;

socket-example iface_list : iface_list.cpp ;
socket-example http_get : http_get.cpp ;
#socket-example async_server : async_server.cpp 

#socket-example named_pipe_server : named_pipe_server.cpp ;
#socket-example named_pipe_client : named_pipe_client.cpp ;